     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 20.3 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to root@region-11.autodl.com                         │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 100.80.192.179:0.0                           │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-90-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Sat Apr  9 22:37:05 2022 from 127.0.0.1
+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：17% 3.4G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
root@container-855111b90c-e179f175:~# cd ./BERT4Rec
root@container-855111b90c-e179f175:~/BERT4Rec# hmod u+x run_beaty.sh
-bash: hmod: command not found
root@container-855111b90c-e179f175:~/BERT4Rec# chmod u+x run_beaty.sh
chmod: cannot access 'run_beaty.sh': No such file or directory
root@container-855111b90c-e179f175:~/BERT4Rec# chmod u+x ./run_beaty.sh
chmod: cannot access './run_beaty.sh': No such file or directory
root@container-855111b90c-e179f175:~/BERT4Rec# chmod u+x ./run_beauty.sh
root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 6.80
max:291, min:3
len_train:40226, len_valid:40226, len_test:40226, usernum:40226, itemnum:54542
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33            , 34, 35, 36, 37, 38, 39, 40]
[41]
[42]
[43, 3, 44, 45]
[46]
[47]
[48, 49, 50, 51, 52, 53]
[54]
[55]
[56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 8            6, 87, 49, 88, 89, 90, 91, 92, 93]
[94]
[95]
[96, 97, 98, 99]
[100]
[101]
[102, 103, 104]
[99]
[105]
[106, 107, 108, 109]
[110]
[111]
[112, 113, 114, 115, 116]
[117]
[118]
[119, 113, 120]
[121]
[122]
[123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133]
[134]
[135]
begin to generate train
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 488, in gen_samples
    pool_size, force_last)
  File "gen_data_fin.py", line 255, in create_training_instances
    beg_idx.append(0)
AttributeError: 'range' object has no attribute 'append'
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:602: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:497: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0410 22:31:19.701954 139656295876416 deprecation_wrapper.py:119] From run.py:497: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:497: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0410 22:31:19.702142 139656295876416 deprecation_wrapper.py:119] From run.py:497: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0410 22:31:19.702392 139656295876416 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:508: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0410 22:31:19.703235 139656295876416 deprecation_wrapper.py:119] From run.py:508: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:512: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0410 22:31:19.703590 139656295876416 deprecation_wrapper.py:119] From run.py:512: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:521: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0410 22:31:19.704279 139656295876416 deprecation_wrapper.py:119] From run.py:521: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0410 22:31:19.704436 139656295876416 run.py:521] *** train Input Files ***
INFO:tensorflow:*** test Input Files ***
I0410 22:31:19.704528 139656295876416 run.py:525] *** test Input Files ***
Traceback (most recent call last):
  File "run.py", line 602, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 537, in main
    with open(FLAGS.vocab_filename, 'rb') as input_file:
FileNotFoundError: [Errno 2] No such file or directory: './data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab'
root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 6.80
max:291, min:3
len_train:40226, len_valid:40226, len_test:40226, usernum:40226, itemnum:54542
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33            , 34, 35, 36, 37, 38, 39, 40]
[41]
[42]
[43, 3, 44, 45]
[46]
[47]
[48, 49, 50, 51, 52, 53]
[54]
[55]
[56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 8            6, 87, 49, 88, 89, 90, 91, 92, 93]
[94]
[95]
[96, 97, 98, 99]
[100]
[101]
[102, 103, 104]
[99]
[105]
[106, 107, 108, 109]
[110]
[111]
[112, 113, 114, 115, 116]
[117]
[118]
[119, 113, 120]
[121]
[122]
[123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133]
[134]
[135]
begin to generate train
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 488, in gen_samples
    pool_size, force_last)
  File "gen_data_fin.py", line 255, in create_training_instances
    beg_idx.append(0)
AttributeError: 'range' object has no attribute 'append'
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:602: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:497: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0410 22:45:22.071374 140098373732160 deprecation_wrapper.py:119] From run.py:497: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:497: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0410 22:45:22.071596 140098373732160 deprecation_wrapper.py:119] From run.py:497: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0410 22:45:22.071864 140098373732160 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:508: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0410 22:45:22.072645 140098373732160 deprecation_wrapper.py:119] From run.py:508: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:512: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0410 22:45:22.072961 140098373732160 deprecation_wrapper.py:119] From run.py:512: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:521: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0410 22:45:22.074460 140098373732160 deprecation_wrapper.py:119] From run.py:521: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0410 22:45:22.074598 140098373732160 run.py:521] *** train Input Files ***
INFO:tensorflow:*** test Input Files ***
I0410 22:45:22.074703 140098373732160 run.py:525] *** test Input Files ***
Traceback (most recent call last):
  File "run.py", line 602, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 537, in main
    with open(FLAGS.vocab_filename, 'rb') as input_file:
FileNotFoundError: [Errno 2] No such file or directory: './data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab'
root@container-855111b90c-e179f175:~/BERT4Rec# conda create -n bert python=2.7
Collecting package metadata (current_repodata.json): done
Solving environment: failed with repodata from current_repodata.json, will retry with next repodata source.
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /root/miniconda3/envs/bert

  added / updated specs:
    - python=2.7


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    _libgcc_mutex-0.1          |             main           3 KB  defaults
    _openmp_mutex-4.5          |            1_gnu          22 KB  defaults
    ca-certificates-2022.3.29  |       h06a4308_0         117 KB  defaults
    certifi-2020.6.20          |     pyhd3eb1b0_3         155 KB  defaults
    libffi-3.3                 |       he6710b0_2          50 KB  defaults
    libgcc-ng-9.3.0            |      h5101ec6_17         4.8 MB  defaults
    libgomp-9.3.0              |      h5101ec6_17         311 KB  defaults
    libstdcxx-ng-9.3.0         |      hd4cf53a_17         3.1 MB  defaults
    ncurses-6.3                |       h7f8727e_2         782 KB  defaults
    pip-19.3.1                 |           py27_0         1.7 MB  defaults
    python-2.7.18              |       ha1903f6_2         9.8 MB  defaults
    readline-8.1.2             |       h7f8727e_1         354 KB  defaults
    setuptools-44.0.0          |           py27_0         512 KB  defaults
    sqlite-3.38.2              |       hc218d9a_0         1.0 MB  defaults
    tk-8.6.11                  |       h1ccaba5_0         3.0 MB  defaults
    wheel-0.37.1               |     pyhd3eb1b0_0          33 KB  defaults
    zlib-1.2.11                |       h7f8727e_4         108 KB  defaults
    ------------------------------------------------------------
                                           Total:        25.8 MB

The following NEW packages will be INSTALLED:

  _libgcc_mutex      anaconda/pkgs/main/linux-64::_libgcc_mutex-0.1-main
  _openmp_mutex      anaconda/pkgs/main/linux-64::_openmp_mutex-4.5-1_gnu
  ca-certificates    anaconda/pkgs/main/linux-64::ca-certificates-2022.3.29-h06a4308_0
  certifi            anaconda/pkgs/main/noarch::certifi-2020.6.20-pyhd3eb1b0_3
  libffi             anaconda/pkgs/main/linux-64::libffi-3.3-he6710b0_2
  libgcc-ng          anaconda/pkgs/main/linux-64::libgcc-ng-9.3.0-h5101ec6_17
  libgomp            anaconda/pkgs/main/linux-64::libgomp-9.3.0-h5101ec6_17
  libstdcxx-ng       anaconda/pkgs/main/linux-64::libstdcxx-ng-9.3.0-hd4cf53a_17
  ncurses            anaconda/pkgs/main/linux-64::ncurses-6.3-h7f8727e_2
  pip                anaconda/pkgs/main/linux-64::pip-19.3.1-py27_0
  python             anaconda/pkgs/main/linux-64::python-2.7.18-ha1903f6_2
  readline           anaconda/pkgs/main/linux-64::readline-8.1.2-h7f8727e_1
  setuptools         anaconda/pkgs/main/linux-64::setuptools-44.0.0-py27_0
  sqlite             anaconda/pkgs/main/linux-64::sqlite-3.38.2-hc218d9a_0
  tk                 anaconda/pkgs/main/linux-64::tk-8.6.11-h1ccaba5_0
  wheel              anaconda/pkgs/main/noarch::wheel-0.37.1-pyhd3eb1b0_0
  zlib               anaconda/pkgs/main/linux-64::zlib-1.2.11-h7f8727e_4


Proceed ([y]/n)? y


Downloading and Extracting Packages
libgomp-9.3.0        | 311 KB    | ############################################################################### | 100%
libstdcxx-ng-9.3.0   | 3.1 MB    | ############################################################################### | 100%
libffi-3.3           | 50 KB     | ############################################################################### | 100%
ncurses-6.3          | 782 KB    | ############################################################################### | 100%
readline-8.1.2       | 354 KB    | ############################################################################### | 100%
certifi-2020.6.20    | 155 KB    | ############################################################################### | 100%
_libgcc_mutex-0.1    | 3 KB      | ############################################################################### | 100%
ca-certificates-2022 | 117 KB    | ############################################################################### | 100%
setuptools-44.0.0    | 512 KB    | ############################################################################### | 100%
sqlite-3.38.2        | 1.0 MB    | ############################################################################### | 100%
pip-19.3.1           | 1.7 MB    | ############################################################################### | 100%
_openmp_mutex-4.5    | 22 KB     | ############################################################################### | 100%
tk-8.6.11            | 3.0 MB    | ############################################################################### | 100%
python-2.7.18        | 9.8 MB    | ############################################################################### | 100%
wheel-0.37.1         | 33 KB     | ############################################################################### | 100%
zlib-1.2.11          | 108 KB    | ############################################################################### | 100%
libgcc-ng-9.3.0      | 4.8 MB    | ############################################################################### | 100%
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate bert
#
# To deactivate an active environment, use
#
#     $ conda deactivate

root@container-855111b90c-e179f175:~/BERT4Rec# pip install tensorflow-gpu==1.13.1
Looking in indexes: http://mirrors.aliyun.com/pypi/simple
Collecting tensorflow-gpu==1.13.1
  Downloading http://mirrors.aliyun.com/pypi/packages/2c/65/8dc8fc4a263a24f7ad935b72ad35e72ba381cb9e175b6a5fe086c85f17a7/t            ensorflow_gpu-1.13.1-cp37-cp37m-manylinux1_x86_64.whl (345.0 MB)
     |████████████████████████████████| 345.0 MB 23.2 MB/s
Requirement already satisfied: wheel>=0.26 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1) (            0.35.1)
Requirement already satisfied: protobuf>=3.6.1 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.            1) (3.19.4)
Requirement already satisfied: six>=1.10.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1) (            1.15.0)
Collecting tensorflow-estimator<1.14.0rc0,>=1.13.0
  Downloading http://mirrors.aliyun.com/pypi/packages/bb/48/13f49fc3fa0fdf916aa1419013bb8f2ad09674c275b4046d5ee669a46873/t            ensorflow_estimator-1.13.0-py2.py3-none-any.whl (367 kB)
     |████████████████████████████████| 367 kB 31.8 MB/s
Requirement already satisfied: keras-preprocessing>=1.0.5 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow            -gpu==1.13.1) (1.1.2)
Requirement already satisfied: astor>=0.6.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1)             (0.8.1)
Requirement already satisfied: grpcio>=1.8.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1)             (1.43.0)
Requirement already satisfied: gast>=0.2.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1) (            0.5.3)
Requirement already satisfied: numpy>=1.13.3 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1)             (1.21.5)
Collecting tensorboard<1.14.0,>=1.13.0
  Downloading http://mirrors.aliyun.com/pypi/packages/0f/39/bdd75b08a6fba41f098b6cb091b9e8c7a80e1b4d679a581a0ccd17b10373/t            ensorboard-1.13.1-py3-none-any.whl (3.2 MB)
     |████████████████████████████████| 3.2 MB 2.8 MB/s
Requirement already satisfied: absl-py>=0.1.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13.1            ) (1.0.0)
Requirement already satisfied: keras-applications>=1.0.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-            gpu==1.13.1) (1.0.8)
Requirement already satisfied: termcolor>=1.1.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.13            .1) (1.1.0)
Requirement already satisfied: mock>=2.0.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-estimator<1.14            .0rc0,>=1.13.0->tensorflow-gpu==1.13.1) (4.0.3)
Requirement already satisfied: markdown>=2.6.8 in /root/miniconda3/lib/python3.7/site-packages (from tensorboard<1.14.0,>=            1.13.0->tensorflow-gpu==1.13.1) (3.3.6)
Requirement already satisfied: werkzeug>=0.11.15 in /root/miniconda3/lib/python3.7/site-packages (from tensorboard<1.14.0,            >=1.13.0->tensorflow-gpu==1.13.1) (2.0.2)
Requirement already satisfied: h5py in /root/miniconda3/lib/python3.7/site-packages (from keras-applications>=1.0.6->tenso            rflow-gpu==1.13.1) (3.6.0)
Requirement already satisfied: importlib-metadata>=4.4; python_version < "3.10" in /root/miniconda3/lib/python3.7/site-pac            kages (from markdown>=2.6.8->tensorboard<1.14.0,>=1.13.0->tensorflow-gpu==1.13.1) (4.10.1)
Requirement already satisfied: cached-property; python_version < "3.8" in /root/miniconda3/lib/python3.7/site-packages (fr            om h5py->keras-applications>=1.0.6->tensorflow-gpu==1.13.1) (1.5.2)
Requirement already satisfied: zipp>=0.5 in /root/miniconda3/lib/python3.7/site-packages (from importlib-metadata>=4.4; py            thon_version < "3.10"->markdown>=2.6.8->tensorboard<1.14.0,>=1.13.0->tensorflow-gpu==1.13.1) (3.7.0)
Requirement already satisfied: typing-extensions>=3.6.4; python_version < "3.8" in /root/miniconda3/lib/python3.7/site-pac            kages (from importlib-metadata>=4.4; python_version < "3.10"->markdown>=2.6.8->tensorboard<1.14.0,>=1.13.0->tensorflow-gpu            ==1.13.1) (4.0.1)
Installing collected packages: tensorflow-estimator, tensorboard, tensorflow-gpu
  Attempting uninstall: tensorflow-estimator
    Found existing installation: tensorflow-estimator 1.14.0
    Uninstalling tensorflow-estimator-1.14.0:
      Successfully uninstalled tensorflow-estimator-1.14.0
  Attempting uninstall: tensorboard
    Found existing installation: tensorboard 1.14.0
    Uninstalling tensorboard-1.14.0:
      Successfully uninstalled tensorboard-1.14.0
  Attempting uninstall: tensorflow-gpu
    Found existing installation: tensorflow-gpu 1.14.0
    Uninstalling tensorflow-gpu-1.14.0:
      Successfully uninstalled tensorflow-gpu-1.14.0
Successfully installed tensorboard-1.13.1 tensorflow-estimator-1.13.0 tensorflow-gpu-1.13.1
root@container-855111b90c-e179f175:~/BERT4Rec# pip install tensorflow-gpu==1.14.0
Looking in indexes: http://mirrors.aliyun.com/pypi/simple
Collecting tensorflow-gpu==1.14.0
  Downloading http://mirrors.aliyun.com/pypi/packages/32/67/559ca8408431c37ad3a17e859c8c291ea82f092354074baef482b98ffb7b/t            ensorflow_gpu-1.14.0-cp37-cp37m-manylinux1_x86_64.whl (377.1 MB)
     |████████████████████████████████| 377.1 MB 5.6 MB/s
Requirement already satisfied: astor>=0.6.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0)             (0.8.1)
Requirement already satisfied: termcolor>=1.1.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14            .0) (1.1.0)
Requirement already satisfied: keras-preprocessing>=1.0.5 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow            -gpu==1.14.0) (1.1.2)
Requirement already satisfied: absl-py>=0.7.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0            ) (1.0.0)
Requirement already satisfied: six>=1.10.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0) (            1.15.0)
Requirement already satisfied: protobuf>=3.6.1 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.            0) (3.19.4)
Requirement already satisfied: google-pasta>=0.1.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1            .14.0) (0.2.0)
Requirement already satisfied: keras-applications>=1.0.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-            gpu==1.14.0) (1.0.8)
Requirement already satisfied: numpy<2.0,>=1.14.5 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.            14.0) (1.21.5)
Collecting tensorboard<1.15.0,>=1.14.0
  Downloading http://mirrors.aliyun.com/pypi/packages/91/2d/2ed263449a078cd9c8a9ba50ebd50123adf1f8cfbea1492f9084169b89d9/t            ensorboard-1.14.0-py3-none-any.whl (3.1 MB)
     |████████████████████████████████| 3.1 MB 40.3 MB/s
Collecting tensorflow-estimator<1.15.0rc0,>=1.14.0rc0
  Downloading http://mirrors.aliyun.com/pypi/packages/3c/d5/21860a5b11caf0678fbc8319341b0ae21a07156911132e0e71bffed0510d/t            ensorflow_estimator-1.14.0-py2.py3-none-any.whl (488 kB)
     |████████████████████████████████| 488 kB 34.3 MB/s
Requirement already satisfied: wrapt>=1.11.1 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0)             (1.14.0)
Requirement already satisfied: grpcio>=1.8.6 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0)             (1.43.0)
Requirement already satisfied: wheel>=0.26 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0) (            0.35.1)
Requirement already satisfied: gast>=0.2.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorflow-gpu==1.14.0) (            0.5.3)
Requirement already satisfied: h5py in /root/miniconda3/lib/python3.7/site-packages (from keras-applications>=1.0.6->tenso            rflow-gpu==1.14.0) (3.6.0)
Requirement already satisfied: werkzeug>=0.11.15 in /root/miniconda3/lib/python3.7/site-packages (from tensorboard<1.15.0,            >=1.14.0->tensorflow-gpu==1.14.0) (2.0.2)
Requirement already satisfied: markdown>=2.6.8 in /root/miniconda3/lib/python3.7/site-packages (from tensorboard<1.15.0,>=            1.14.0->tensorflow-gpu==1.14.0) (3.3.6)
Requirement already satisfied: setuptools>=41.0.0 in /root/miniconda3/lib/python3.7/site-packages (from tensorboard<1.15.0            ,>=1.14.0->tensorflow-gpu==1.14.0) (50.3.1.post20201107)
Requirement already satisfied: cached-property; python_version < "3.8" in /root/miniconda3/lib/python3.7/site-packages (fr            om h5py->keras-applications>=1.0.6->tensorflow-gpu==1.14.0) (1.5.2)
Requirement already satisfied: importlib-metadata>=4.4; python_version < "3.10" in /root/miniconda3/lib/python3.7/site-pac            kages (from markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14.0) (4.10.1)
Requirement already satisfied: zipp>=0.5 in /root/miniconda3/lib/python3.7/site-packages (from importlib-metadata>=4.4; py            thon_version < "3.10"->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu==1.14.0) (3.7.0)
Requirement already satisfied: typing-extensions>=3.6.4; python_version < "3.8" in /root/miniconda3/lib/python3.7/site-pac            kages (from importlib-metadata>=4.4; python_version < "3.10"->markdown>=2.6.8->tensorboard<1.15.0,>=1.14.0->tensorflow-gpu            ==1.14.0) (4.0.1)
Installing collected packages: tensorboard, tensorflow-estimator, tensorflow-gpu
  Attempting uninstall: tensorboard
    Found existing installation: tensorboard 1.13.1
    Uninstalling tensorboard-1.13.1:
      Successfully uninstalled tensorboard-1.13.1
  Attempting uninstall: tensorflow-estimator
    Found existing installation: tensorflow-estimator 1.13.0
    Uninstalling tensorflow-estimator-1.13.0:
      Successfully uninstalled tensorflow-estimator-1.13.0
  Attempting uninstall: tensorflow-gpu
    Found existing installation: tensorflow-gpu 1.13.1
    Uninstalling tensorflow-gpu-1.13.1:
      Successfully uninstalled tensorflow-gpu-1.13.1
Successfully installed tensorboard-1.14.0 tensorflow-estimator-1.14.0 tensorflow-gpu-1.14.0
root@container-855111b90c-e179f175:~/BERT4Rec#  conda init bash && source /root/.bashrc
no change     /root/miniconda3/condabin/conda
no change     /root/miniconda3/bin/conda
no change     /root/miniconda3/bin/conda-env
no change     /root/miniconda3/bin/activate
no change     /root/miniconda3/bin/deactivate
no change     /root/miniconda3/etc/profile.d/conda.sh
no change     /root/miniconda3/etc/fish/conf.d/conda.fish
no change     /root/miniconda3/shell/condabin/Conda.psm1
no change     /root/miniconda3/shell/condabin/conda-hook.ps1
no change     /root/miniconda3/lib/python3.7/site-packages/xontrib/conda.xsh
no change     /root/miniconda3/etc/profile.d/conda.csh
modified      /root/.bashrc

==> For changes to take effect, close and re-open your current shell. <==

+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：19% 3.7G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
(base) root@container-855111b90c-e179f175:~/BERT4Rec# conda activate bert
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# pip install tensorflow-gpu==1.13.1
Configuration file could not be loaded.
File contains no section headers.
file: /etc/pip.conf, line: 1
' [global]\n'
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# conda install tensorflow-gpu==1.13.1
Collecting package metadata (current_repodata.json): done
Solving environment: failed with initial frozen solve. Retrying with flexible solve.
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /root/miniconda3/envs/bert

  added / updated specs:
    - tensorflow-gpu==1.13.1


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    _tflow_select-2.1.0        |              gpu           2 KB  defaults
    absl-py-0.15.0             |     pyhd3eb1b0_0         103 KB  defaults
    astor-0.8.0                |           py27_0          46 KB  defaults
    backports-1.1              |     pyhd3eb1b0_0           4 KB  defaults
    backports.weakref-1.0.post1|             py_1           8 KB  defaults
    blas-1.0                   |              mkl           6 KB  defaults
    c-ares-1.18.1              |       h7f8727e_0         114 KB  defaults
    cudatoolkit-10.0.130       |                0       261.2 MB  defaults
    cudnn-7.6.5                |       cuda10.0_0       165.0 MB  defaults
    cupti-10.0.130             |                0         1.5 MB  defaults
    enum34-1.1.6               |           py27_1          58 KB  defaults
    funcsigs-1.0.2             |           py27_0          22 KB  defaults
    futures-3.3.0              |           py27_0          29 KB  defaults
    gast-0.5.3                 |     pyhd3eb1b0_0          21 KB  defaults
    grpcio-1.27.2              |   py27hf8bcb03_0         1.2 MB  defaults
    h5py-2.9.0                 |   py27h7918eee_0         961 KB  defaults
    hdf5-1.10.4                |       hb1b8bf9_0         3.9 MB  defaults
    intel-openmp-2022.0.1      |    h06a4308_3633         4.2 MB  defaults
    keras-applications-1.0.8   |             py_1          29 KB  defaults
    keras-preprocessing-1.1.0  |             py_1          37 KB  defaults
    libgfortran-ng-7.5.0       |      ha8ba4b0_17          22 KB  defaults
    libgfortran4-7.5.0         |      ha8ba4b0_17         995 KB  defaults
    libprotobuf-3.11.2         |       hd408876_0         2.9 MB  defaults
    linecache2-1.0.0           |             py_1          14 KB  defaults
    markdown-3.1.1             |           py27_0         117 KB  defaults
    mkl-2020.2                 |              256       138.3 MB  defaults
    mkl-service-2.3.0          |   py27he904b0f_0         217 KB  defaults
    mkl_fft-1.0.15             |   py27ha843d7b_0         146 KB  defaults
    mkl_random-1.1.0           |   py27hd6b4f25_0         297 KB  defaults
    mock-3.0.5                 |           py27_0          49 KB  defaults
    numpy-1.16.6               |   py27hbc911f0_0          48 KB  defaults
    numpy-base-1.16.6          |   py27hde5b4d6_0         3.5 MB  defaults
    openssl-1.1.1n             |       h7f8727e_0         2.5 MB  defaults
    protobuf-3.11.2            |   py27he6710b0_0         638 KB  defaults
    scipy-1.2.1                |   py27h7c811a0_0        13.7 MB  defaults
    six-1.16.0                 |     pyhd3eb1b0_1          18 KB  defaults
    tensorboard-1.13.1         |   py27hf484d3e_0         3.1 MB  defaults
    tensorflow-1.13.1          |gpu_py27hcb41dfa_0           4 KB  defaults
    tensorflow-base-1.13.1     |gpu_py27h8d69cac_0       131.2 MB  defaults
    tensorflow-estimator-1.13.0|             py_0         181 KB  defaults
    tensorflow-gpu-1.13.1      |       h0d30ee6_0           3 KB  defaults
    termcolor-1.1.0            |           py27_1           8 KB  defaults
    traceback2-1.4.0           |           py27_0          31 KB  defaults
    unittest2-1.1.0            |           py27_0         149 KB  defaults
    werkzeug-1.0.1             |     pyhd3eb1b0_0         239 KB  defaults
    ------------------------------------------------------------
                                           Total:       736.9 MB

The following NEW packages will be INSTALLED:

  _tflow_select      anaconda/pkgs/main/linux-64::_tflow_select-2.1.0-gpu
  absl-py            anaconda/pkgs/main/noarch::absl-py-0.15.0-pyhd3eb1b0_0
  astor              anaconda/pkgs/main/linux-64::astor-0.8.0-py27_0
  backports          anaconda/pkgs/main/noarch::backports-1.1-pyhd3eb1b0_0
  backports.weakref  anaconda/pkgs/main/noarch::backports.weakref-1.0.post1-py_1
  blas               anaconda/pkgs/main/linux-64::blas-1.0-mkl
  c-ares             anaconda/pkgs/main/linux-64::c-ares-1.18.1-h7f8727e_0
  cudatoolkit        anaconda/pkgs/main/linux-64::cudatoolkit-10.0.130-0
  cudnn              anaconda/pkgs/main/linux-64::cudnn-7.6.5-cuda10.0_0
  cupti              anaconda/pkgs/main/linux-64::cupti-10.0.130-0
  enum34             anaconda/pkgs/main/linux-64::enum34-1.1.6-py27_1
  funcsigs           anaconda/pkgs/main/linux-64::funcsigs-1.0.2-py27_0
  futures            anaconda/pkgs/main/linux-64::futures-3.3.0-py27_0
  gast               anaconda/pkgs/main/noarch::gast-0.5.3-pyhd3eb1b0_0
  grpcio             anaconda/pkgs/main/linux-64::grpcio-1.27.2-py27hf8bcb03_0
  h5py               anaconda/pkgs/main/linux-64::h5py-2.9.0-py27h7918eee_0
  hdf5               anaconda/pkgs/main/linux-64::hdf5-1.10.4-hb1b8bf9_0
  intel-openmp       anaconda/pkgs/main/linux-64::intel-openmp-2022.0.1-h06a4308_3633
  keras-applications anaconda/pkgs/main/noarch::keras-applications-1.0.8-py_1
  keras-preprocessi~ anaconda/pkgs/main/noarch::keras-preprocessing-1.1.0-py_1
  libgfortran-ng     anaconda/pkgs/main/linux-64::libgfortran-ng-7.5.0-ha8ba4b0_17
  libgfortran4       anaconda/pkgs/main/linux-64::libgfortran4-7.5.0-ha8ba4b0_17
  libprotobuf        anaconda/pkgs/main/linux-64::libprotobuf-3.11.2-hd408876_0
  linecache2         anaconda/pkgs/main/noarch::linecache2-1.0.0-py_1
  markdown           anaconda/pkgs/main/linux-64::markdown-3.1.1-py27_0
  mkl                anaconda/pkgs/main/linux-64::mkl-2020.2-256
  mkl-service        anaconda/pkgs/main/linux-64::mkl-service-2.3.0-py27he904b0f_0
  mkl_fft            anaconda/pkgs/main/linux-64::mkl_fft-1.0.15-py27ha843d7b_0
  mkl_random         anaconda/pkgs/main/linux-64::mkl_random-1.1.0-py27hd6b4f25_0
  mock               anaconda/pkgs/main/linux-64::mock-3.0.5-py27_0
  numpy              anaconda/pkgs/main/linux-64::numpy-1.16.6-py27hbc911f0_0
  numpy-base         anaconda/pkgs/main/linux-64::numpy-base-1.16.6-py27hde5b4d6_0
  openssl            anaconda/pkgs/main/linux-64::openssl-1.1.1n-h7f8727e_0
  protobuf           anaconda/pkgs/main/linux-64::protobuf-3.11.2-py27he6710b0_0
  scipy              anaconda/pkgs/main/linux-64::scipy-1.2.1-py27h7c811a0_0
  six                anaconda/pkgs/main/noarch::six-1.16.0-pyhd3eb1b0_1
  tensorboard        anaconda/pkgs/main/linux-64::tensorboard-1.13.1-py27hf484d3e_0
  tensorflow         anaconda/pkgs/main/linux-64::tensorflow-1.13.1-gpu_py27hcb41dfa_0
  tensorflow-base    anaconda/pkgs/main/linux-64::tensorflow-base-1.13.1-gpu_py27h8d69cac_0
  tensorflow-estima~ anaconda/pkgs/main/noarch::tensorflow-estimator-1.13.0-py_0
  tensorflow-gpu     anaconda/pkgs/main/linux-64::tensorflow-gpu-1.13.1-h0d30ee6_0
  termcolor          anaconda/pkgs/main/linux-64::termcolor-1.1.0-py27_1
  traceback2         anaconda/pkgs/main/linux-64::traceback2-1.4.0-py27_0
  unittest2          anaconda/pkgs/main/linux-64::unittest2-1.1.0-py27_0
  werkzeug           anaconda/pkgs/main/noarch::werkzeug-1.0.1-pyhd3eb1b0_0


Proceed ([y]/n)? y


Downloading and Extracting Packages
cudnn-7.6.5          | 165.0 MB  | ############################################################################### | 100%
cudatoolkit-10.0.130 | 261.2 MB  | ############################################################################### | 100%
tensorflow-base-1.13 | 131.2 MB  | ############################################################################### | 100%
termcolor-1.1.0      | 8 KB      | ############################################################################### | 100%
numpy-1.16.6         | 48 KB     | ############################################################################### | 100%
h5py-2.9.0           | 961 KB    | ############################################################################### | 100%
keras-applications-1 | 29 KB     | ############################################################################### | 100%
linecache2-1.0.0     | 14 KB     | ############################################################################### | 100%
keras-preprocessing- | 37 KB     | ############################################################################### | 100%
grpcio-1.27.2        | 1.2 MB    | ############################################################################### | 100%
openssl-1.1.1n       | 2.5 MB    | ############################################################################### | 100%
scipy-1.2.1          | 13.7 MB   | ############################################################################### | 100%
traceback2-1.4.0     | 31 KB     | ############################################################################### | 100%
libprotobuf-3.11.2   | 2.9 MB    | ############################################################################### | 100%
astor-0.8.0          | 46 KB     | ############################################################################### | 100%
mkl-2020.2           | 138.3 MB  | ############################################################################### | 100%
_tflow_select-2.1.0  | 2 KB      | ############################################################################### | 100%
mkl-service-2.3.0    | 217 KB    | ############################################################################### | 100%
gast-0.5.3           | 21 KB     | ############################################################################### | 100%
numpy-base-1.16.6    | 3.5 MB    | ############################################################################### | 100%
tensorflow-gpu-1.13. | 3 KB      | ############################################################################### | 100%
absl-py-0.15.0       | 103 KB    | ############################################################################### | 100%
funcsigs-1.0.2       | 22 KB     | ############################################################################### | 100%
futures-3.3.0        | 29 KB     | ############################################################################### | 100%
six-1.16.0           | 18 KB     | ############################################################################### | 100%
werkzeug-1.0.1       | 239 KB    | ############################################################################### | 100%
backports-1.1        | 4 KB      | ############################################################################### | 100%
mkl_fft-1.0.15       | 146 KB    | ############################################################################### | 100%
tensorflow-1.13.1    | 4 KB      | ############################################################################### | 100%
markdown-3.1.1       | 117 KB    | ############################################################################### | 100%
tensorflow-estimator | 181 KB    | ############################################################################### | 100%
protobuf-3.11.2      | 638 KB    | ############################################################################### | 100%
libgfortran-ng-7.5.0 | 22 KB     | ############################################################################### | 100%
cupti-10.0.130       | 1.5 MB    | ############################################################################### | 100%
backports.weakref-1. | 8 KB      | ############################################################################### | 100%
enum34-1.1.6         | 58 KB     | ############################################################################### | 100%
unittest2-1.1.0      | 149 KB    | ############################################################################### | 100%
blas-1.0             | 6 KB      | ############################################################################### | 100%
libgfortran4-7.5.0   | 995 KB    | ############################################################################### | 100%
intel-openmp-2022.0. | 4.2 MB    | ############################################################################### | 100%
c-ares-1.18.1        | 114 KB    | ############################################################################### | 100%
hdf5-1.10.4          | 3.9 MB    | ############################################################################### | 100%
tensorboard-1.13.1   | 3.1 MB    | ############################################################################### | 100%
mock-3.0.5           | 49 KB     | ############################################################################### | 100%
mkl_random-1.1.0     | 297 KB    | ############################################################################### | 100%
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 6.80
max:291, min:3
len_train:40226, len_valid:40226, len_test:40226, usernum:40226, itemnum:54542
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33            , 34, 35, 36, 37, 38, 39, 40]
[41]
[42]
[43, 3, 44, 45]
[46]
[47]
[48, 49, 50, 51, 52, 53]
[54]
[55]
[56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 8            6, 87, 49, 88, 89, 90, 91, 92, 93]
[94]
[95]
[96, 97, 98, 99]
[100]
[101]
[102, 103, 104]
[99]
[105]
[106, 107, 108, 109]
[110]
[111]
[112, 113, 114, 115, 116]
[117]
[118]
[119, 113, 120]
[121]
[122]
[123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133]
[134]
[135]
begin to generate train
document num: 40226
step: 0, name: PoolWorker-1, step: 1000, time: 6.074016
step: 1, name: PoolWorker-2, step: 1000, time: 6.661358
step: 2, name: PoolWorker-3, step: 1000, time: 6.621752
step: 3, name: PoolWorker-4, step: 1000, time: 7.699147
step: 4, name: PoolWorker-5, step: 1000, time: 8.029173
step: 5, name: PoolWorker-6, step: 1000, time: 8.037983
step: 6, name: PoolWorker-7, step: 1000, time: 8.903206
step: 8, name: PoolWorker-9, step: 1000, time: 8.269673
step: 7, name: PoolWorker-8, step: 1000, time: 9.049193
step: 9, name: PoolWorker-10, step: 1000, time: 8.63953
step: 0, name: PoolWorker-1, step: 2000, time: 10.320451
step: 2, name: PoolWorker-3, step: 2000, time: 9.70035
step: 1, name: PoolWorker-2, step: 2000, time: 10.306928
step: 3, name: PoolWorker-4, step: 2000, time: 11.252702
step: 4, name: PoolWorker-5, step: 2000, time: 10.771247
step: 5, name: PoolWorker-6, step: 2000, time: 9.779565
step: 6, name: PoolWorker-7, step: 2000, time: 10.677174
step: 8, name: PoolWorker-9, step: 2000, time: 10.152615
step: 7, name: PoolWorker-8, step: 2000, time: 10.471873
step: 9, name: PoolWorker-10, step: 2000, time: 10.717965
step: 0, name: PoolWorker-1, step: 3000, time: 11.773011
step: 1, name: PoolWorker-2, step: 3000, time: 11.802122
step: 2, name: PoolWorker-3, step: 3000, time: 12.581599
step: 5, name: PoolWorker-6, step: 3000, time: 9.862896
step: 4, name: PoolWorker-5, step: 3000, time: 10.642123
step: 3, name: PoolWorker-4, step: 3000, time: 11.840358
step: 6, name: PoolWorker-7, step: 3000, time: 11.473169
step: 8, name: PoolWorker-9, step: 3000, time: 11.426132
step: 7, name: PoolWorker-8, step: 3000, time: 11.863286
step: 0, name: PoolWorker-1, step: 4000, time: 10.004287
step: 9, name: PoolWorker-10, step: 3000, time: 11.596251
step: 1, name: PoolWorker-2, step: 4000, time: 10.219797
step: 2, name: PoolWorker-3, step: 4000, time: 9.741949
step: 4, name: PoolWorker-5, step: 4000, time: 9.21409
step: 3, name: PoolWorker-4, step: 4000, time: 8.298517
step: 5, name: PoolWorker-6, step: 4000, time: 10.204861
step: 6, name: PoolWorker-7, step: 4000, time: 9.691193
step: 0, name: PoolWorker-1, step: 5000, time: 8.557462
step: 8, name: PoolWorker-9, step: 4000, time: 9.872201
step: 7, name: PoolWorker-8, step: 4000, time: 9.654051
step: 9, name: PoolWorker-10, step: 4000, time: 9.703146
step: 4, name: PoolWorker-5, step: 5000, time: 8.426674
step: 1, name: PoolWorker-2, step: 5000, time: 9.63493
step: 2, name: PoolWorker-3, step: 5000, time: 9.737213
step: 3, name: PoolWorker-4, step: 5000, time: 9.053951
step: 5, name: PoolWorker-6, step: 5000, time: 9.759045
step: 0, name: PoolWorker-1, step: 6000, time: 7.498629
step: 6, name: PoolWorker-7, step: 5000, time: 9.632284
step: 8, name: PoolWorker-9, step: 5000, time: 8.977962
step: 7, name: PoolWorker-8, step: 5000, time: 9.08788
step: 4, name: PoolWorker-5, step: 6000, time: 7.589605
step: 9, name: PoolWorker-10, step: 5000, time: 9.357534
step: 1, name: PoolWorker-2, step: 6000, time: 8.434014
step: 2, name: PoolWorker-3, step: 6000, time: 8.270067
step: 3, name: PoolWorker-4, step: 6000, time: 8.806808
step: 5, name: PoolWorker-6, step: 6000, time: 8.224316
step: 0, name: PoolWorker-1, step: 7000, time: 8.181273
step: 7, name: PoolWorker-8, step: 6000, time: 7.660035
step: 6, name: PoolWorker-7, step: 6000, time: 8.263218
step: 8, name: PoolWorker-9, step: 6000, time: 8.590547
step: 4, name: PoolWorker-5, step: 7000, time: 8.329284
step: 9, name: PoolWorker-10, step: 6000, time: 8.000751
step: 1, name: PoolWorker-2, step: 7000, time: 9.040657
step: 2, name: PoolWorker-3, step: 7000, time: 8.731596
step: 3, name: PoolWorker-4, step: 7000, time: 9.192003
step: 5, name: PoolWorker-6, step: 7000, time: 8.785806
step: 0, name: PoolWorker-1, step: 8000, time: 10.370126
step: 8, name: PoolWorker-9, step: 7000, time: 8.171447
step: 6, name: PoolWorker-7, step: 7000, time: 8.769289
step: 7, name: PoolWorker-8, step: 7000, time: 9.294092
step: 9, name: PoolWorker-10, step: 7000, time: 8.86103
step: 4, name: PoolWorker-5, step: 8000, time: 11.582794
step: 0, name: PoolWorker-1, step: 9000, time: 7.213158
step: 1, name: PoolWorker-2, step: 8000, time: 11.905902
step: 2, name: PoolWorker-3, step: 8000, time: 12.079038
step: 3, name: PoolWorker-4, step: 8000, time: 11.744332
step: 5, name: PoolWorker-6, step: 8000, time: 11.716953
step: 6, name: PoolWorker-7, step: 8000, time: 11.949665
step: 8, name: PoolWorker-9, step: 8000, time: 12.785369
step: 9, name: PoolWorker-10, step: 8000, time: 10.72239
step: 4, name: PoolWorker-5, step: 9000, time: 8.79966
step: 7, name: PoolWorker-8, step: 8000, time: 12.208925
step: 0, name: PoolWorker-1, step: 10000, time: 8.836425
step: 1, name: PoolWorker-2, step: 9000, time: 8.840436
step: 2, name: PoolWorker-3, step: 9000, time: 8.688408
step: 5, name: PoolWorker-6, step: 9000, time: 8.278762
step: 3, name: PoolWorker-4, step: 9000, time: 8.675514
step: 9, name: PoolWorker-10, step: 9000, time: 7.517656
step: 6, name: PoolWorker-7, step: 9000, time: 8.586556
step: 8, name: PoolWorker-9, step: 9000, time: 8.448446
step: 7, name: PoolWorker-8, step: 9000, time: 8.359374
step: 0, name: PoolWorker-1, step: 11000, time: 8.210148
step: 4, name: PoolWorker-5, step: 10000, time: 10.554964
step: 5, name: PoolWorker-6, step: 10000, time: 9.137246
step: 1, name: PoolWorker-2, step: 10000, time: 9.629712
step: 2, name: PoolWorker-3, step: 10000, time: 9.595189
step: 3, name: PoolWorker-4, step: 10000, time: 9.556832
step: 9, name: PoolWorker-10, step: 10000, time: 8.22888
step: 6, name: PoolWorker-7, step: 10000, time: 9.387983
step: 8, name: PoolWorker-9, step: 10000, time: 9.618771
step: 7, name: PoolWorker-8, step: 10000, time: 9.335373
step: 0, name: PoolWorker-1, step: 12000, time: 7.84099
step: 4, name: PoolWorker-5, step: 11000, time: 8.588521
step: 5, name: PoolWorker-6, step: 11000, time: 8.391729
step: 1, name: PoolWorker-2, step: 11000, time: 8.637951
step: 2, name: PoolWorker-3, step: 11000, time: 8.579302
step: 3, name: PoolWorker-4, step: 11000, time: 8.570781
step: 9, name: PoolWorker-10, step: 11000, time: 7.058761
step: 0, name: PoolWorker-1, step: 13000, time: 8.597398
step: 8, name: PoolWorker-9, step: 11000, time: 8.968903
step: 6, name: PoolWorker-7, step: 11000, time: 9.131298
step: 7, name: PoolWorker-8, step: 11000, time: 9.076898
step: 4, name: PoolWorker-5, step: 12000, time: 8.2378
step: 5, name: PoolWorker-6, step: 12000, time: 7.62247
step: 1, name: PoolWorker-2, step: 12000, time: 8.40814
step: 2, name: PoolWorker-3, step: 12000, time: 8.723768
step: 3, name: PoolWorker-4, step: 12000, time: 9.079015
step: 9, name: PoolWorker-10, step: 12000, time: 8.469684
step: 8, name: PoolWorker-9, step: 12000, time: 8.128617
step: 6, name: PoolWorker-7, step: 12000, time: 8.279135
step: 7, name: PoolWorker-8, step: 12000, time: 8.310859
step: 0, name: PoolWorker-1, step: 14000, time: 9.420075
step: 5, name: PoolWorker-6, step: 13000, time: 8.40741
step: 4, name: PoolWorker-5, step: 13000, time: 9.367638
step: 2, name: PoolWorker-3, step: 13000, time: 8.432642
step: 1, name: PoolWorker-2, step: 13000, time: 9.379771
step: 3, name: PoolWorker-4, step: 13000, time: 9.949644
step: 9, name: PoolWorker-10, step: 13000, time: 10.328487
step: 0, name: PoolWorker-1, step: 15000, time: 7.024329
step: 8, name: PoolWorker-9, step: 13000, time: 9.804916
step: 6, name: PoolWorker-7, step: 13000, time: 9.468926
step: 7, name: PoolWorker-8, step: 13000, time: 9.530519
step: 5, name: PoolWorker-6, step: 14000, time: 9.288621
step: 4, name: PoolWorker-5, step: 14000, time: 10.47595
step: 2, name: PoolWorker-3, step: 14000, time: 10.056847
step: 1, name: PoolWorker-2, step: 14000, time: 10.721598
step: 5, name: PoolWorker-6, step: 15000, time: 6.989525
step: 0, name: PoolWorker-1, step: 16000, time: 9.942917
step: 3, name: PoolWorker-4, step: 14000, time: 11.55875
step: 9, name: PoolWorker-10, step: 14000, time: 11.319734
step: 8, name: PoolWorker-9, step: 14000, time: 11.101282
step: 7, name: PoolWorker-8, step: 14000, time: 11.325544
step: 6, name: PoolWorker-7, step: 14000, time: 11.397825
step: 4, name: PoolWorker-5, step: 15000, time: 8.61045
step: 2, name: PoolWorker-3, step: 15000, time: 9.329069
step: 1, name: PoolWorker-2, step: 15000, time: 8.35416
step: 0, name: PoolWorker-1, step: 17000, time: 7.612782
step: 5, name: PoolWorker-6, step: 16000, time: 9.861527
step: 3, name: PoolWorker-4, step: 15000, time: 8.449023
step: 9, name: PoolWorker-10, step: 15000, time: 8.34464
step: 8, name: PoolWorker-9, step: 15000, time: 8.913544
step: 6, name: PoolWorker-7, step: 15000, time: 8.668623
step: 7, name: PoolWorker-8, step: 15000, time: 8.745252
step: 0, name: PoolWorker-1, step: 18000, time: 8.429736
step: 4, name: PoolWorker-5, step: 16000, time: 12.019359
step: 5, name: PoolWorker-6, step: 17000, time: 7.661265
step: 2, name: PoolWorker-3, step: 16000, time: 12.290912
step: 1, name: PoolWorker-2, step: 16000, time: 12.348189
step: 9, name: PoolWorker-10, step: 16000, time: 11.851791
step: 3, name: PoolWorker-4, step: 16000, time: 12.266023
step: 5, name: PoolWorker-6, step: 18000, time: 8.413648
step: 0, name: PoolWorker-1, step: 19000, time: 9.766089
step: 7, name: PoolWorker-8, step: 16000, time: 12.232257
step: 8, name: PoolWorker-9, step: 16000, time: 12.677473
step: 6, name: PoolWorker-7, step: 16000, time: 12.661893
step: 4, name: PoolWorker-5, step: 17000, time: 9.546025
step: 2, name: PoolWorker-3, step: 17000, time: 9.559662
step: 1, name: PoolWorker-2, step: 17000, time: 10.247651
step: 9, name: PoolWorker-10, step: 17000, time: 9.303815
step: 3, name: PoolWorker-4, step: 17000, time: 10.820838
step: 0, name: PoolWorker-1, step: 20000, time: 10.112993
step: 5, name: PoolWorker-6, step: 19000, time: 10.663196
step: 6, name: PoolWorker-7, step: 17000, time: 9.748209
step: 8, name: PoolWorker-9, step: 17000, time: 9.928023
step: 7, name: PoolWorker-8, step: 17000, time: 11.102078
step: 4, name: PoolWorker-5, step: 18000, time: 11.860811
step: 2, name: PoolWorker-3, step: 18000, time: 11.665537
step: 1, name: PoolWorker-2, step: 18000, time: 11.699548
step: 9, name: PoolWorker-10, step: 18000, time: 12.575319
step: 0, name: PoolWorker-1, step: 21000, time: 9.407551
step: 3, name: PoolWorker-4, step: 18000, time: 12.403518
step: 6, name: PoolWorker-7, step: 18000, time: 10.695085
step: 5, name: PoolWorker-6, step: 20000, time: 11.773975
step: 8, name: PoolWorker-9, step: 18000, time: 12.444562
step: 7, name: PoolWorker-8, step: 18000, time: 12.290368
step: 4, name: PoolWorker-5, step: 19000, time: 13.357068
step: 0, name: PoolWorker-1, step: 22000, time: 9.438421
step: 2, name: PoolWorker-3, step: 19000, time: 13.872908
step: 5, name: PoolWorker-6, step: 21000, time: 9.711887
step: 1, name: PoolWorker-2, step: 19000, time: 14.28948
step: 9, name: PoolWorker-10, step: 19000, time: 13.469155
step: 6, name: PoolWorker-7, step: 19000, time: 12.57881
step: 3, name: PoolWorker-4, step: 19000, time: 14.565159
step: 0, name: PoolWorker-1, step: 23000, time: 10.662267
step: 8, name: PoolWorker-9, step: 19000, time: 15.253516
step: 7, name: PoolWorker-8, step: 19000, time: 15.098423
step: 5, name: PoolWorker-6, step: 22000, time: 9.930919
step: 4, name: PoolWorker-5, step: 20000, time: 13.873722
step: 2, name: PoolWorker-3, step: 20000, time: 13.519652
step: 6, name: PoolWorker-7, step: 20000, time: 12.03754
step: 1, name: PoolWorker-2, step: 20000, time: 14.525719
step: 9, name: PoolWorker-10, step: 20000, time: 13.634331
step: 0, name: PoolWorker-1, step: 24000, time: 8.736443
step: 3, name: PoolWorker-4, step: 20000, time: 13.703746
step: 5, name: PoolWorker-6, step: 23000, time: 10.895752
step: 4, name: PoolWorker-5, step: 21000, time: 11.310656
step: 6, name: PoolWorker-7, step: 21000, time: 9.11176
step: 8, name: PoolWorker-9, step: 20000, time: 14.2797
step: 7, name: PoolWorker-8, step: 20000, time: 14.06362
step: 2, name: PoolWorker-3, step: 21000, time: 11.13696
step: 0, name: PoolWorker-1, step: 25000, time: 8.530914
step: 9, name: PoolWorker-10, step: 21000, time: 9.660415
step: 1, name: PoolWorker-2, step: 21000, time: 10.643855
step: 5, name: PoolWorker-6, step: 24000, time: 7.096079
step: 3, name: PoolWorker-4, step: 21000, time: 9.716846
step: 6, name: PoolWorker-7, step: 22000, time: 8.091395
step: 4, name: PoolWorker-5, step: 22000, time: 8.949222
step: 0, name: PoolWorker-1, step: 26000, time: 6.841059
step: 8, name: PoolWorker-9, step: 21000, time: 9.124079
step: 2, name: PoolWorker-3, step: 22000, time: 8.874818
step: 7, name: PoolWorker-8, step: 21000, time: 9.217549
step: 9, name: PoolWorker-10, step: 22000, time: 9.150805
step: 5, name: PoolWorker-6, step: 25000, time: 8.040414
step: 1, name: PoolWorker-2, step: 22000, time: 9.267199
step: 3, name: PoolWorker-4, step: 22000, time: 9.027984
step: 6, name: PoolWorker-7, step: 23000, time: 8.728029
step: 0, name: PoolWorker-1, step: 27000, time: 9.125728
step: 8, name: PoolWorker-9, step: 22000, time: 8.710601
step: 4, name: PoolWorker-5, step: 23000, time: 10.20647
step: 7, name: PoolWorker-8, step: 22000, time: 8.92079
step: 2, name: PoolWorker-3, step: 23000, time: 9.610756
step: 5, name: PoolWorker-6, step: 26000, time: 7.370181
step: 9, name: PoolWorker-10, step: 23000, time: 9.306874
step: 1, name: PoolWorker-2, step: 23000, time: 9.5203
step: 6, name: PoolWorker-7, step: 24000, time: 7.498068
step: 3, name: PoolWorker-4, step: 23000, time: 9.703236
step: 4, name: PoolWorker-5, step: 24000, time: 7.717726
step: 2, name: PoolWorker-3, step: 24000, time: 7.510546
step: 8, name: PoolWorker-9, step: 23000, time: 9.435285
step: 0, name: PoolWorker-1, step: 28000, time: 11.202931
step: 7, name: PoolWorker-8, step: 23000, time: 9.387949
step: 9, name: PoolWorker-10, step: 24000, time: 7.30246
step: 5, name: PoolWorker-6, step: 27000, time: 9.371343
step: 1, name: PoolWorker-2, step: 24000, time: 7.491347
step: 6, name: PoolWorker-7, step: 25000, time: 8.326512
step: 3, name: PoolWorker-4, step: 24000, time: 7.557012
step: 4, name: PoolWorker-5, step: 25000, time: 8.300272
step: 8, name: PoolWorker-9, step: 24000, time: 7.581149
step: 2, name: PoolWorker-3, step: 25000, time: 8.492583
step: 9, name: PoolWorker-10, step: 25000, time: 7.380834
step: 7, name: PoolWorker-8, step: 24000, time: 7.503588
step: 0, name: PoolWorker-1, step: 29000, time: 8.432451
step: 1, name: PoolWorker-2, step: 25000, time: 8.424294
step: 6, name: PoolWorker-7, step: 26000, time: 7.259272
step: 5, name: PoolWorker-6, step: 28000, time: 11.477393
step: 3, name: PoolWorker-4, step: 25000, time: 8.556
step: 4, name: PoolWorker-5, step: 26000, time: 7.591876
step: 2, name: PoolWorker-3, step: 26000, time: 7.870978
step: 9, name: PoolWorker-10, step: 26000, time: 7.749488
step: 8, name: PoolWorker-9, step: 25000, time: 8.757402
step: 0, name: PoolWorker-1, step: 30000, time: 8.000351
step: 7, name: PoolWorker-8, step: 25000, time: 9.622393
step: 1, name: PoolWorker-2, step: 26000, time: 8.514024
step: 6, name: PoolWorker-7, step: 27000, time: 10.204488
step: 5, name: PoolWorker-6, step: 29000, time: 9.292468
step: 3, name: PoolWorker-4, step: 26000, time: 8.671099
step: 4, name: PoolWorker-5, step: 27000, time: 10.248821
step: 8, name: PoolWorker-9, step: 26000, time: 8.168116
step: 0, name: PoolWorker-1, step: 31000, time: 8.365859
step: 7, name: PoolWorker-8, step: 26000, time: 8.192468
step: 9, name: PoolWorker-10, step: 27000, time: 10.151303
step: 2, name: PoolWorker-3, step: 27000, time: 10.363035
step: 1, name: PoolWorker-2, step: 27000, time: 10.442786
step: 5, name: PoolWorker-6, step: 30000, time: 8.144476
step: 3, name: PoolWorker-4, step: 27000, time: 10.116332
step: 0, name: PoolWorker-1, step: 32000, time: 8.143464
step: 6, name: PoolWorker-7, step: 28000, time: 12.325442
step: 8, name: PoolWorker-9, step: 27000, time: 10.427481
step: 4, name: PoolWorker-5, step: 28000, time: 11.526302
step: 7, name: PoolWorker-8, step: 27000, time: 10.505304
step: 5, name: PoolWorker-6, step: 31000, time: 8.405787
step: 9, name: PoolWorker-10, step: 28000, time: 12.466403
step: 2, name: PoolWorker-3, step: 28000, time: 12.83754
step: 1, name: PoolWorker-2, step: 28000, time: 12.802202
step: 6, name: PoolWorker-7, step: 29000, time: 9.365975
step: 0, name: PoolWorker-1, step: 33000, time: 10.190375
step: 3, name: PoolWorker-4, step: 28000, time: 12.802158
step: 4, name: PoolWorker-5, step: 29000, time: 9.466727
step: 5, name: PoolWorker-6, step: 32000, time: 8.341319
step: 9, name: PoolWorker-10, step: 29000, time: 8.584146
step: 8, name: PoolWorker-9, step: 28000, time: 12.358561
step: 2, name: PoolWorker-3, step: 29000, time: 8.90903
step: 7, name: PoolWorker-8, step: 28000, time: 12.193066
step: 1, name: PoolWorker-2, step: 29000, time: 8.559865
step: 6, name: PoolWorker-7, step: 30000, time: 8.334368
step: 3, name: PoolWorker-4, step: 29000, time: 8.678505
step: 4, name: PoolWorker-5, step: 30000, time: 8.379331
step: 0, name: PoolWorker-1, step: 34000, time: 11.33817
step: 9, name: PoolWorker-10, step: 30000, time: 8.398551
step: 2, name: PoolWorker-3, step: 30000, time: 8.176306
step: 5, name: PoolWorker-6, step: 33000, time: 9.214053
step: 8, name: PoolWorker-9, step: 29000, time: 8.614723
step: 7, name: PoolWorker-8, step: 29000, time: 8.676373
step: 1, name: PoolWorker-2, step: 30000, time: 7.689315
step: 6, name: PoolWorker-7, step: 31000, time: 8.05747
step: 3, name: PoolWorker-4, step: 30000, time: 7.87227
step: 4, name: PoolWorker-5, step: 31000, time: 8.67919
step: 9, name: PoolWorker-10, step: 31000, time: 8.551726
step: 2, name: PoolWorker-3, step: 31000, time: 8.598481
step: 8, name: PoolWorker-9, step: 30000, time: 8.941533
step: 0, name: PoolWorker-1, step: 35000, time: 9.752012
step: 7, name: PoolWorker-8, step: 30000, time: 8.89181
step: 1, name: PoolWorker-2, step: 31000, time: 8.372503
step: 5, name: PoolWorker-6, step: 34000, time: 12.021011
step: 6, name: PoolWorker-7, step: 32000, time: 8.436866
step: 3, name: PoolWorker-4, step: 31000, time: 8.050759
step: 4, name: PoolWorker-5, step: 32000, time: 7.56242
step: 9, name: PoolWorker-10, step: 32000, time: 7.690841
step: 2, name: PoolWorker-3, step: 32000, time: 7.850641
step: 8, name: PoolWorker-9, step: 31000, time: 8.009755
step: 7, name: PoolWorker-8, step: 31000, time: 7.988892
step: 0, name: PoolWorker-1, step: 36000, time: 9.044252
step: 1, name: PoolWorker-2, step: 32000, time: 7.740904
step: 5, name: PoolWorker-6, step: 35000, time: 8.962857
step: 3, name: PoolWorker-4, step: 32000, time: 7.581347
step: 6, name: PoolWorker-7, step: 33000, time: 9.067556
step: 4, name: PoolWorker-5, step: 33000, time: 8.931693
step: 8, name: PoolWorker-9, step: 32000, time: 7.491886
step: 9, name: PoolWorker-10, step: 33000, time: 9.07342
step: 2, name: PoolWorker-3, step: 33000, time: 8.918829
step: 7, name: PoolWorker-8, step: 32000, time: 7.819135
step: 0, name: PoolWorker-1, step: 37000, time: 7.863319
step: 1, name: PoolWorker-2, step: 33000, time: 9.137179
step: 5, name: PoolWorker-6, step: 36000, time: 8.93668
step: 3, name: PoolWorker-4, step: 33000, time: 8.964003
step: 6, name: PoolWorker-7, step: 34000, time: 10.854518
step: 8, name: PoolWorker-9, step: 33000, time: 8.787282
step: 4, name: PoolWorker-5, step: 34000, time: 10.900097
step: 7, name: PoolWorker-8, step: 33000, time: 8.996906
step: 2, name: PoolWorker-3, step: 34000, time: 10.148804
step: 9, name: PoolWorker-10, step: 34000, time: 10.753216
step: 0, name: PoolWorker-1, step: 38000, time: 9.883199
step: 5, name: PoolWorker-6, step: 37000, time: 8.387217
step: 1, name: PoolWorker-2, step: 34000, time: 10.710679
step: 3, name: PoolWorker-4, step: 34000, time: 10.486701
step: 6, name: PoolWorker-7, step: 35000, time: 8.913865
step: 4, name: PoolWorker-5, step: 35000, time: 8.722059
step: 2, name: PoolWorker-3, step: 35000, time: 8.700732
step: 9, name: PoolWorker-10, step: 35000, time: 8.97799
step: 8, name: PoolWorker-9, step: 34000, time: 10.907994
step: 7, name: PoolWorker-8, step: 34000, time: 10.897921
step: 0, name: PoolWorker-1, step: 39000, time: 10.339528
step: 1, name: PoolWorker-2, step: 35000, time: 8.655167
step: 5, name: PoolWorker-6, step: 38000, time: 10.273449
step: 3, name: PoolWorker-4, step: 35000, time: 8.080827
step: 6, name: PoolWorker-7, step: 36000, time: 9.158751
step: 4, name: PoolWorker-5, step: 36000, time: 9.163063
step: 2, name: PoolWorker-3, step: 36000, time: 8.66208
step: 9, name: PoolWorker-10, step: 36000, time: 9.221997
step: 8, name: PoolWorker-9, step: 35000, time: 9.359409
step: 7, name: PoolWorker-8, step: 35000, time: 8.644253
step: 0, name: PoolWorker-1, step: 40000, time: 9.358295
step: 1, name: PoolWorker-2, step: 36000, time: 8.78783
step: 3, name: PoolWorker-4, step: 36000, time: 8.852835
step: 6, name: PoolWorker-7, step: 37000, time: 8.474345
step: 5, name: PoolWorker-6, step: 39000, time: 10.352943
callback function result type: <type 'list'>, size: 41738
step: 4, name: PoolWorker-5, step: 37000, time: 8.581384
step: 2, name: PoolWorker-3, step: 37000, time: 8.593604
step: 9, name: PoolWorker-10, step: 37000, time: 8.370995
step: 7, name: PoolWorker-8, step: 36000, time: 8.639526
step: 8, name: PoolWorker-9, step: 36000, time: 9.424286
step: 1, name: PoolWorker-2, step: 37000, time: 8.036008
step: 3, name: PoolWorker-4, step: 37000, time: 8.412673
step: 5, name: PoolWorker-6, step: 40000, time: 8.287412
step: 6, name: PoolWorker-7, step: 38000, time: 8.81137
step: 4, name: PoolWorker-5, step: 38000, time: 8.564333
step: 9, name: PoolWorker-10, step: 38000, time: 8.397183
callback function result type: <type 'list'>, size: 41738
step: 2, name: PoolWorker-3, step: 38000, time: 9.242741
step: 7, name: PoolWorker-8, step: 37000, time: 8.130421
step: 8, name: PoolWorker-9, step: 37000, time: 8.48443
step: 1, name: PoolWorker-2, step: 38000, time: 9.017097
step: 3, name: PoolWorker-4, step: 38000, time: 8.674343
step: 6, name: PoolWorker-7, step: 39000, time: 8.434187
step: 4, name: PoolWorker-5, step: 39000, time: 7.758689
step: 9, name: PoolWorker-10, step: 39000, time: 7.841653
step: 2, name: PoolWorker-3, step: 39000, time: 7.937254
step: 7, name: PoolWorker-8, step: 38000, time: 8.016388
step: 8, name: PoolWorker-9, step: 38000, time: 8.174961
step: 1, name: PoolWorker-2, step: 39000, time: 7.977175
step: 3, name: PoolWorker-4, step: 39000, time: 8.046949
step: 6, name: PoolWorker-7, step: 40000, time: 7.425265
step: 4, name: PoolWorker-5, step: 40000, time: 7.32285
step: 9, name: PoolWorker-10, step: 40000, time: 7.298197
step: 2, name: PoolWorker-3, step: 40000, time: 7.491077
callback function result type: <type 'list'>, size: 41738
step: 7, name: PoolWorker-8, step: 39000, time: 8.34625
callback function result type: <type 'list'>, size: 41738
step: 8, name: PoolWorker-9, step: 39000, time: 7.967549
step: 1, name: PoolWorker-2, step: 40000, time: 7.453736
callback function result type: <type 'list'>, size: 41738
step: 3, name: PoolWorker-4, step: 40000, time: 7.298827
callback function result type: <type 'list'>, size: 41738
callback function result type: <type 'list'>, size: 41738
callback function result type: <type 'list'>, size: 41738
step: 7, name: PoolWorker-8, step: 40000, time: 6.738364
step: 8, name: PoolWorker-9, step: 40000, time: 6.860671
callback function result type: <type 'list'>, size: 41738
callback function result type: <type 'list'>, size: 41738
num of instance:459118; time:73.357042
INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_51596 item_4363 [MASK] [MASK] [MASK]
INFO:tensorflow:info: 30509
INFO:tensorflow:input_ids: 54543 53704 861 54543 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 626 274 207 1178 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_362 item_1324 [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 5169
INFO:tensorflow:input_ids: 56 863 54543 54543 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1360 14480 882 4561 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3155 item_3630 [MASK] [MASK]
INFO:tensorflow:info: 28349
INFO:tensorflow:input_ids: 63 1213 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5907 1170 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_47863 [MASK] item_11647
INFO:tensorflow:info: 23293
INFO:tensorflow:input_ids: 54543 43812 54543 7278 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5222 6293 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_45899 [MASK] [MASK] item_1857 [MASK] [MASK]
INFO:tensorflow:info: 23931
INFO:tensorflow:input_ids: 26899 54543 54543 1174 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5402 34076 5978 25783 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3919 [MASK] item_11613 [MASK] [MASK]
INFO:tensorflow:info: 3089
INFO:tensorflow:input_ids: 1117 54543 4561 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 8256 10822 10544 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1737 [MASK] item_5619 [MASK] [MASK] [MASK] item_20755 [MASK] item_42596 [MASK] [MASK] item_88            12
INFO:tensorflow:info: 16555
INFO:tensorflow:input_ids: 1719 54543 6310 54543 54543 54543 8286 54543 49279 54543 54543 512 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 5 7 9 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1897 23530 22351 703 2881 2214 49282 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_50017 [MASK] [MASK] item_11488
INFO:tensorflow:info: 36530
INFO:tensorflow:input_ids: 31521 54543 54543 5988 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 11552 5711 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_5991 [MASK] item_11293 [MASK]
INFO:tensorflow:info: 4609
INFO:tensorflow:input_ids: 54543 2235 54543 6711 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 20364 19087 160 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_22416 item_12527 item_32179 item_5498 item_5041 item_2 item_24105 item_46285 item_255 item_99            21 [MASK]
INFO:tensorflow:info: 31216
INFO:tensorflow:input_ids: 35957 1224 5385 1973 2643 97 11383 36279 129 1639 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1468 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_10451 [MASK] [MASK] item_22007
INFO:tensorflow:info: 4280
INFO:tensorflow:input_ids: 54543 13680 54543 54543 21268 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 8637 6 12934 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_52749 [MASK] [MASK] item_4238 [MASK] item_14759 [MASK] [MASK] [MASK] item_3903 [MASK] item_11            63 [MASK] item_2387 [MASK] [MASK] [MASK] item_11585 [MASK] [MASK] item_8151 [MASK] item_7329 [MASK] [MASK] item_4248
INFO:tensorflow:info: 33518
INFO:tensorflow:input_ids: 53667 54543 54543 239 54543 719 54543 54543 54543 188 54543 190 54543 260 54543 54543 54543 878             54543 54543 5513 54543 3293 54543 54543 2696 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 4 6 7 8 10 12 14 15 16 18 19 21 23 24 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 439 24 330 43 55 320 110 237 44 503 640 1692 742 3294 5514 4921 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_4792 item_7695 item_31480 item_9801 item_34689 item_17757 item_31353 [MASK]
INFO:tensorflow:info: 17847
INFO:tensorflow:input_ids: 573 17137 4591 12472 8861 30688 17839 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 18135 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_21683 item_50061 item_30870 [MASK]
INFO:tensorflow:info: 27150
INFO:tensorflow:input_ids: 5785 41011 11940 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 2897 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_14046 item_14047 item_5485 [MASK] item_9282 [MASK] item_1705 [MASK] [MASK] [MASK] [MAS            K] item_6910 item_6203 [MASK] [MASK] [MASK]
INFO:tensorflow:info: 1850
INFO:tensorflow:input_ids: 54543 4610 4008 1075 54543 855 54543 2792 54543 54543 54543 54543 2632 1114 54543 54543 54543 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 4 6 8 9 10 11 14 15 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1013 5111 9589 4993 12015 7814 3806 118 12 93 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11812 [MASK] [MASK] [MASK] [MASK] item_7953
INFO:tensorflow:info: 18941
INFO:tensorflow:input_ids: 10217 54543 54543 54543 54543 2950 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1021 892 8626 3365 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_4679 item_18961 [MASK] item_1414 [MASK] [MASK] [MASK] item_4954
INFO:tensorflow:info: 23589
INFO:tensorflow:input_ids: 54543 54543 4743 2880 54543 1124 54543 54543 54543 20213 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 4 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 2667 40794 12584 22170 1155 6625 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_489 item_547 item_53280 item_4551 item_35637 [MASK]
INFO:tensorflow:info: 40022
INFO:tensorflow:input_ids: 2801 382 32562 5556 23926 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 17041 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_5209 item_4909 item_4899 [MASK]
INFO:tensorflow:info: 430
INFO:tensorflow:input_ids: 12604 2945 69 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 180 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_5342 [MASK] item_10215 [MASK] [MASK]
INFO:tensorflow:info: 13212
INFO:tensorflow:input_ids: 3463 54543 2008 54543 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6985 36583 66 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 459118 total instances
train:./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
begin to generate test
num of instance:40226
INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_24089 item_1633 item_20862 item_33507 [MASK]
INFO:tensorflow:info: 10807
INFO:tensorflow:input_ids: 17778 23 8057 13906 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 48146 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_45201 item_21109 item_25529 item_12176 item_21111 item_9190 [MASK]
INFO:tensorflow:info: 31394
INFO:tensorflow:input_ids: 29020 7121 18561 4937 38359 3701 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 26593 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_21246 item_9426 item_915 item_21918 item_684 [MASK]
INFO:tensorflow:info: 25829
INFO:tensorflow:input_ids: 15429 3478 1787 1720 3981 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 65 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_26010 item_25328 item_7160 item_3388 item_3389 [MASK]
INFO:tensorflow:info: 15459
INFO:tensorflow:input_ids: 2515 21181 5021 2285 2159 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 50203 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_15797 item_1095 item_24550 item_2420 item_24551 [MASK]
INFO:tensorflow:info: 11636
INFO:tensorflow:input_ids: 6685 9994 6244 21401 10335 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5932 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_21356 item_2372 item_51178 item_20186 item_1599 item_9083 [MASK]
INFO:tensorflow:info: 29603
INFO:tensorflow:input_ids: 8746 225 52352 974 882 3870 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6114 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_4495 item_788 item_13724 item_16691 item_30036 item_19077 item_6590 item_6823 item_1031 item_            30037 item_8010 item_22473 item_1648 item_1859 item_2873 item_5214 item_27988 item_4384 item_15167 item_5668 item_20637 [M            ASK]
INFO:tensorflow:info: 7656
INFO:tensorflow:input_ids: 14535 7254 17099 5052 27315 14324 11551 1736 716 34755 679 18126 5022 5832 4113 5042 9791 200 1            2803 2028 14727 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 21 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 7443 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_12396 item_17294 item_517 item_34468 item_594 [MASK]
INFO:tensorflow:info: 25120
INFO:tensorflow:input_ids: 2092 7586 1519 26842 1 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 11660 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_4536 item_3206 item_949 item_4537 item_3857 item_4538 item_4539 item_3562 item_4540 item_4541             item_4542 item_4543 item_4544 item_4545 item_4546 item_1241 item_3740 item_4547 item_3896 item_575 item_747 item_4548 ite            m_431 item_3572 item_4024 item_4549 item_3875 item_4550 item_4551 item_4552 item_4553 item_4554 item_4555 item_2407 item_2            408 item_4556 item_4557 item_3973 item_4558 item_4559 item_4560 item_4561 item_4562 item_4563 item_1884 item_4564 item_456            5 item_4566 item_491 [MASK]
INFO:tensorflow:info: 369
INFO:tensorflow:input_ids: 11743 1805 363 17089 899 21838 7788 228 33712 19105 2558 8176 2065 2066 4519 223 144 33711 397             655 1178 8177 361 728 766 9261 2422 808 5556 27592 27591 20800 37767 527 535 1859 1704 8604 7602 6781 5640 4788 652 22929             4521 16889 22927 30874 768 54543
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 49 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 2137 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_36270 item_4515 item_4955 item_23018 item_1437 [MASK]
INFO:tensorflow:info: 18366
INFO:tensorflow:input_ids: 11558 1173 1696 5827 9191 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6008 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_5920 item_1436 item_29691 item_3837 item_25818 item_9293 item_3093 [MASK]
INFO:tensorflow:info: 32957
INFO:tensorflow:input_ids: 8334 18814 35935 4052 37303 6927 1088 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1902 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2838 item_2877 item_5255 item_9992 item_3602 item_5103 [MASK]
INFO:tensorflow:info: 26690
INFO:tensorflow:input_ids: 277 2382 457 965 627 3280 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1258 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_38127 item_10954 item_16765 item_29963 item_1636 item_29468 item_5528 item_12113 item_48263 [            MASK]
INFO:tensorflow:info: 23917
INFO:tensorflow:input_ids: 29788 1356 10210 14242 2 17050 124 5294 49957 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 518 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2209 item_2195 item_2180 item_2205 item_1744 [MASK]
INFO:tensorflow:info: 38710
INFO:tensorflow:input_ids: 3 20 4 10 11 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 306 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_24691 item_1886 item_21220 item_153 item_1116 item_23667 item_13028 [MASK]
INFO:tensorflow:info: 17389
INFO:tensorflow:input_ids: 9111 15 14744 1536 16 5264 3049 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 21226 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_26272 item_600 item_252 item_31711 item_12882 item_24752 item_31712 [MASK]
INFO:tensorflow:info: 8521
INFO:tensorflow:input_ids: 21669 1765 65 52724 6734 4891 21174 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2451 item_27258 item_19920 item_3404 item_33849 item_5714 item_4658 item_30662 item_1653 [MAS            K]
INFO:tensorflow:info: 11948
INFO:tensorflow:input_ids: 86 6004 4848 1550 17016 5703 1442 39657 297 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 899 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_16517 item_22346 item_11227 item_14172 item_8893 item_17595 item_1243 [MASK]
INFO:tensorflow:info: 19783
INFO:tensorflow:input_ids: 5361 18546 6476 845 2539 5210 380 54543 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 14497 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11654 item_4544 item_4363 item_6018 item_860 item_8010 item_5029 item_3737 item_11655 item_11            656 item_1903 item_2304 item_9848 [MASK]
INFO:tensorflow:info: 1387
INFO:tensorflow:input_ids: 31038 2065 861 1737 76 679 5299 2861 23049 10074 1101 1164 3792 54543 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 17164 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_20273 item_19383 item_1746 item_11543 item_51769 item_12032 item_26695 item_3218 item_8774 it            em_12307 item_10856 item_40514 item_37487 item_20693 item_28208 [MASK]
INFO:tensorflow:info: 36974
INFO:tensorflow:input_ids: 7395 2368 741 217 23966 491 10770 26 1252 307 16834 28462 8312 1033 15767 54543 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 26441 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 40226 total instances
test:./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
vocab_size:54546, user_size:40226, item_size:54542, item_with_other_size:54545
vocab pickle file: ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
test data pickle file: ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
done.
checkpointDir: ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
INFO:tensorflow:*** train Input Files ***
INFO:tensorflow:  ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
INFO:tensorflow:  ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tenso            rflow.python.training.server_lib.ClusterSpec object at 0x7f9362dc52d0>, '_model_dir': './data/beauty-mp1.0-sw0.1-mlp0.6-df            10-mpps30-msl50-64', '_protocol': None, '_save_checkpoints_steps': 1000, '_keep_checkpoint_every_n_hours': 10000, '_servic            e': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_experimental_d            istribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '', '_eval            _distribute': None, '_global_id_in_cluster': 0, '_master': ''}
INFO:tensorflow:***** Running training *****
INFO:tensorflow:  Batch size = 256
WARNING:tensorflow:From /root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.            py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From run.py:490: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use tf.cast instead.
INFO:tensorflow:Calling model_fn.
INFO:tensorflow:*** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
INFO:tensorflow:**** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/learning_rate_de            cay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py:110: UserWarning: Convertin            g sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
2022-04-10 23:08:35.510111: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2022-04-10 23:08:35.519030: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-10 23:08:35.520858: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5627b86f7f20 executing computa            tions on platform Host. Devices:
2022-04-10 23:08:35.520894: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-10 23:08:35.789927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:83:00.0
totalMemory: 11.91GiB freeMemory: 11.76GiB
2022-04-10 23:08:35.789961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-04-10 23:08:35.790521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor wit            h strength 1 edge matrix:
2022-04-10 23:08:35.790534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0
2022-04-10 23:08:35.790542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N
2022-04-10 23:08:35.790633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:local            host/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bu            s id: 0000:83:00.0, compute capability: 6.1)
2022-04-10 23:08:35.792609: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5627b415c840 executing computa            tions on platform CUDA. Devices:
2022-04-10 23:08:35.792628: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): NVIDIA TITAN X             (Pascal), Compute Capability 6.1
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
2022-04-10 23:08:40.702645: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.            10.0 locally
INFO:tensorflow:loss = 10.9160595, step = 0
INFO:tensorflow:global_step/sec: 4.73725
INFO:tensorflow:loss = 10.433187, step = 100 (21.110 sec)
INFO:tensorflow:global_step/sec: 5.49917
INFO:tensorflow:loss = 10.11334, step = 200 (18.184 sec)
INFO:tensorflow:global_step/sec: 5.50309
INFO:tensorflow:loss = 9.995496, step = 300 (18.171 sec)
INFO:tensorflow:global_step/sec: 5.4977
INFO:tensorflow:loss = 10.07718, step = 400 (18.189 sec)
INFO:tensorflow:global_step/sec: 5.49155
INFO:tensorflow:loss = 10.076309, step = 500 (18.210 sec)
INFO:tensorflow:global_step/sec: 5.50311
INFO:tensorflow:loss = 9.796901, step = 600 (18.171 sec)
INFO:tensorflow:global_step/sec: 5.49604
INFO:tensorflow:loss = 9.958874, step = 700 (18.195 sec)
INFO:tensorflow:global_step/sec: 5.49584
INFO:tensorflow:loss = 9.91931, step = 800 (18.195 sec)
INFO:tensorflow:global_step/sec: 5.49311
INFO:tensorflow:loss = 9.973503, step = 900 (18.204 sec)
INFO:tensorflow:Saving checkpoints for 1000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.39742
INFO:tensorflow:loss = 9.594984, step = 1000 (18.527 sec)
INFO:tensorflow:global_step/sec: 5.48858
INFO:tensorflow:loss = 9.718484, step = 1100 (18.221 sec)
INFO:tensorflow:global_step/sec: 5.48127
INFO:tensorflow:loss = 9.55674, step = 1200 (18.243 sec)
INFO:tensorflow:global_step/sec: 5.49387
INFO:tensorflow:loss = 9.599588, step = 1300 (18.202 sec)
INFO:tensorflow:global_step/sec: 5.48914
INFO:tensorflow:loss = 9.378554, step = 1400 (18.218 sec)
INFO:tensorflow:global_step/sec: 5.49015
INFO:tensorflow:loss = 9.718179, step = 1500 (18.214 sec)
INFO:tensorflow:global_step/sec: 5.50166
INFO:tensorflow:loss = 9.6918745, step = 1600 (18.177 sec)
INFO:tensorflow:global_step/sec: 5.4822
INFO:tensorflow:loss = 9.354709, step = 1700 (18.241 sec)
INFO:tensorflow:global_step/sec: 5.49483
INFO:tensorflow:loss = 9.7515135, step = 1800 (18.199 sec)
INFO:tensorflow:global_step/sec: 5.49346
INFO:tensorflow:loss = 9.492493, step = 1900 (18.204 sec)
INFO:tensorflow:Saving checkpoints for 2000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.37402
INFO:tensorflow:loss = 9.24179, step = 2000 (18.608 sec)
INFO:tensorflow:global_step/sec: 5.4856
INFO:tensorflow:loss = 9.482101, step = 2100 (18.229 sec)
INFO:tensorflow:global_step/sec: 5.48839
INFO:tensorflow:loss = 9.708034, step = 2200 (18.220 sec)
INFO:tensorflow:global_step/sec: 5.48362
INFO:tensorflow:loss = 9.438939, step = 2300 (18.236 sec)
INFO:tensorflow:global_step/sec: 5.49645
INFO:tensorflow:loss = 9.535039, step = 2400 (18.193 sec)
INFO:tensorflow:global_step/sec: 5.49638
INFO:tensorflow:loss = 9.516562, step = 2500 (18.194 sec)
INFO:tensorflow:global_step/sec: 5.49406
INFO:tensorflow:loss = 9.537036, step = 2600 (18.201 sec)
INFO:tensorflow:global_step/sec: 5.4876
INFO:tensorflow:loss = 9.127068, step = 2700 (18.223 sec)
INFO:tensorflow:global_step/sec: 5.5021
INFO:tensorflow:loss = 9.250259, step = 2800 (18.175 sec)
INFO:tensorflow:global_step/sec: 5.48351
INFO:tensorflow:loss = 9.373876, step = 2900 (18.237 sec)
INFO:tensorflow:Saving checkpoints for 3000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38809
INFO:tensorflow:loss = 9.341958, step = 3000 (18.559 sec)
INFO:tensorflow:global_step/sec: 5.50464
INFO:tensorflow:loss = 9.300616, step = 3100 (18.167 sec)
INFO:tensorflow:global_step/sec: 5.49546
INFO:tensorflow:loss = 9.412787, step = 3200 (18.196 sec)
INFO:tensorflow:global_step/sec: 5.4982
INFO:tensorflow:loss = 9.45578, step = 3300 (18.188 sec)
INFO:tensorflow:global_step/sec: 5.50184
INFO:tensorflow:loss = 9.387003, step = 3400 (18.176 sec)
INFO:tensorflow:global_step/sec: 5.47743
INFO:tensorflow:loss = 9.595723, step = 3500 (18.256 sec)
INFO:tensorflow:global_step/sec: 5.47538
INFO:tensorflow:loss = 9.405688, step = 3600 (18.264 sec)
INFO:tensorflow:global_step/sec: 5.48242
INFO:tensorflow:loss = 9.307868, step = 3700 (18.240 sec)
INFO:tensorflow:global_step/sec: 5.47543
INFO:tensorflow:loss = 9.343355, step = 3800 (18.264 sec)
INFO:tensorflow:global_step/sec: 5.48314
INFO:tensorflow:loss = 9.471991, step = 3900 (18.237 sec)
INFO:tensorflow:Saving checkpoints for 4000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.40399
INFO:tensorflow:loss = 9.600885, step = 4000 (18.504 sec)
INFO:tensorflow:global_step/sec: 5.50488
INFO:tensorflow:loss = 9.0280905, step = 4100 (18.166 sec)
INFO:tensorflow:global_step/sec: 5.52263
INFO:tensorflow:loss = 9.245659, step = 4200 (18.107 sec)
INFO:tensorflow:global_step/sec: 5.52286
INFO:tensorflow:loss = 9.453482, step = 4300 (18.106 sec)
INFO:tensorflow:global_step/sec: 5.50436
INFO:tensorflow:loss = 9.150982, step = 4400 (18.167 sec)
INFO:tensorflow:global_step/sec: 5.49316
INFO:tensorflow:loss = 9.508611, step = 4500 (18.205 sec)
INFO:tensorflow:global_step/sec: 5.49115
INFO:tensorflow:loss = 9.126742, step = 4600 (18.211 sec)
INFO:tensorflow:global_step/sec: 5.50273
INFO:tensorflow:loss = 9.256689, step = 4700 (18.173 sec)
INFO:tensorflow:global_step/sec: 5.50019
INFO:tensorflow:loss = 8.991266, step = 4800 (18.181 sec)
INFO:tensorflow:global_step/sec: 5.50374
INFO:tensorflow:loss = 9.086554, step = 4900 (18.169 sec)
INFO:tensorflow:Saving checkpoints for 5000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
WARNING:tensorflow:From /root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/saver.py:966: re            move_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future vers            ion.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
INFO:tensorflow:global_step/sec: 5.38968
INFO:tensorflow:loss = 9.256868, step = 5000 (18.554 sec)
INFO:tensorflow:global_step/sec: 5.49955
INFO:tensorflow:loss = 9.264312, step = 5100 (18.183 sec)
INFO:tensorflow:global_step/sec: 5.49249
INFO:tensorflow:loss = 9.319922, step = 5200 (18.206 sec)
INFO:tensorflow:global_step/sec: 5.49528
INFO:tensorflow:loss = 9.07085, step = 5300 (18.198 sec)
INFO:tensorflow:global_step/sec: 5.49178
INFO:tensorflow:loss = 9.07513, step = 5400 (18.209 sec)
INFO:tensorflow:global_step/sec: 5.48931
INFO:tensorflow:loss = 9.122987, step = 5500 (18.218 sec)
INFO:tensorflow:global_step/sec: 5.49172
INFO:tensorflow:loss = 8.936112, step = 5600 (18.209 sec)
INFO:tensorflow:global_step/sec: 5.50416
INFO:tensorflow:loss = 9.253502, step = 5700 (18.168 sec)
INFO:tensorflow:global_step/sec: 5.4974
INFO:tensorflow:loss = 9.04394, step = 5800 (18.191 sec)
INFO:tensorflow:global_step/sec: 5.49723
INFO:tensorflow:loss = 8.855822, step = 5900 (18.190 sec)
INFO:tensorflow:Saving checkpoints for 6000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38112
INFO:tensorflow:loss = 9.106619, step = 6000 (18.584 sec)
INFO:tensorflow:global_step/sec: 5.50341
INFO:tensorflow:loss = 8.893541, step = 6100 (18.171 sec)
INFO:tensorflow:global_step/sec: 5.49042
INFO:tensorflow:loss = 9.20512, step = 6200 (18.213 sec)
INFO:tensorflow:global_step/sec: 5.5003
INFO:tensorflow:loss = 8.88215, step = 6300 (18.182 sec)
INFO:tensorflow:global_step/sec: 5.48084
INFO:tensorflow:loss = 8.900604, step = 6400 (18.245 sec)
INFO:tensorflow:global_step/sec: 5.49857
INFO:tensorflow:loss = 9.110071, step = 6500 (18.187 sec)
INFO:tensorflow:global_step/sec: 5.49416
INFO:tensorflow:loss = 9.053225, step = 6600 (18.201 sec)
INFO:tensorflow:global_step/sec: 5.50935
INFO:tensorflow:loss = 9.094695, step = 6700 (18.151 sec)
INFO:tensorflow:global_step/sec: 5.49976
INFO:tensorflow:loss = 8.9065, step = 6800 (18.183 sec)
INFO:tensorflow:global_step/sec: 5.50171
INFO:tensorflow:loss = 8.902705, step = 6900 (18.176 sec)
INFO:tensorflow:Saving checkpoints for 7000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.39018
INFO:tensorflow:loss = 8.695758, step = 7000 (18.552 sec)
INFO:tensorflow:global_step/sec: 5.50571
INFO:tensorflow:loss = 8.996413, step = 7100 (18.163 sec)
INFO:tensorflow:global_step/sec: 5.48896
INFO:tensorflow:loss = 9.0328665, step = 7200 (18.218 sec)
INFO:tensorflow:global_step/sec: 5.498
INFO:tensorflow:loss = 9.153401, step = 7300 (18.189 sec)
INFO:tensorflow:global_step/sec: 5.49888
INFO:tensorflow:loss = 8.8911085, step = 7400 (18.185 sec)
INFO:tensorflow:global_step/sec: 5.50205
INFO:tensorflow:loss = 9.154168, step = 7500 (18.175 sec)
INFO:tensorflow:global_step/sec: 5.49968
INFO:tensorflow:loss = 8.58431, step = 7600 (18.183 sec)
INFO:tensorflow:global_step/sec: 5.49338
INFO:tensorflow:loss = 8.751149, step = 7700 (18.204 sec)
INFO:tensorflow:global_step/sec: 5.51012
INFO:tensorflow:loss = 8.728035, step = 7800 (18.148 sec)
INFO:tensorflow:global_step/sec: 5.49671
INFO:tensorflow:loss = 8.642312, step = 7900 (18.192 sec)
INFO:tensorflow:Saving checkpoints for 8000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.39043
INFO:tensorflow:loss = 8.92079, step = 8000 (18.552 sec)
INFO:tensorflow:global_step/sec: 5.49399
INFO:tensorflow:loss = 8.878347, step = 8100 (18.202 sec)
INFO:tensorflow:global_step/sec: 5.49561
INFO:tensorflow:loss = 8.99552, step = 8200 (18.196 sec)
INFO:tensorflow:global_step/sec: 5.49013
INFO:tensorflow:loss = 9.058608, step = 8300 (18.216 sec)
INFO:tensorflow:global_step/sec: 5.49238
INFO:tensorflow:loss = 8.857353, step = 8400 (18.206 sec)
INFO:tensorflow:global_step/sec: 5.50656
INFO:tensorflow:loss = 8.850148, step = 8500 (18.160 sec)
INFO:tensorflow:global_step/sec: 5.50785
INFO:tensorflow:loss = 8.580443, step = 8600 (18.157 sec)
INFO:tensorflow:global_step/sec: 5.49839
INFO:tensorflow:loss = 8.62967, step = 8700 (18.187 sec)
INFO:tensorflow:global_step/sec: 5.50025
INFO:tensorflow:loss = 8.8156395, step = 8800 (18.181 sec)
INFO:tensorflow:global_step/sec: 5.49125
INFO:tensorflow:loss = 8.685194, step = 8900 (18.211 sec)
INFO:tensorflow:Saving checkpoints for 9000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38633
INFO:tensorflow:loss = 8.574752, step = 9000 (18.565 sec)
INFO:tensorflow:global_step/sec: 5.48285
INFO:tensorflow:loss = 8.869326, step = 9100 (18.239 sec)
INFO:tensorflow:global_step/sec: 5.49475
INFO:tensorflow:loss = 8.105978, step = 9200 (18.199 sec)
INFO:tensorflow:global_step/sec: 5.49634
INFO:tensorflow:loss = 8.733323, step = 9300 (18.195 sec)
INFO:tensorflow:global_step/sec: 5.52249
INFO:tensorflow:loss = 8.430829, step = 9400 (18.107 sec)
INFO:tensorflow:global_step/sec: 5.52018
INFO:tensorflow:loss = 8.642766, step = 9500 (18.116 sec)
INFO:tensorflow:global_step/sec: 5.51375
INFO:tensorflow:loss = 8.372924, step = 9600 (18.136 sec)
INFO:tensorflow:global_step/sec: 5.50877
INFO:tensorflow:loss = 8.618784, step = 9700 (18.153 sec)
INFO:tensorflow:global_step/sec: 5.48918
INFO:tensorflow:loss = 8.843027, step = 9800 (18.219 sec)
INFO:tensorflow:global_step/sec: 5.49513
INFO:tensorflow:loss = 8.566269, step = 9900 (18.198 sec)
INFO:tensorflow:Saving checkpoints for 10000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38248
INFO:tensorflow:loss = 8.464379, step = 10000 (18.577 sec)
INFO:tensorflow:global_step/sec: 5.49144
INFO:tensorflow:loss = 8.45724, step = 10100 (18.210 sec)
INFO:tensorflow:global_step/sec: 5.49858
INFO:tensorflow:loss = 8.638842, step = 10200 (18.187 sec)
INFO:tensorflow:global_step/sec: 5.48982
INFO:tensorflow:loss = 8.704276, step = 10300 (18.215 sec)
INFO:tensorflow:global_step/sec: 5.491
INFO:tensorflow:loss = 8.646617, step = 10400 (18.212 sec)
INFO:tensorflow:global_step/sec: 5.50036
INFO:tensorflow:loss = 8.622026, step = 10500 (18.181 sec)
INFO:tensorflow:global_step/sec: 5.49675
INFO:tensorflow:loss = 8.52488, step = 10600 (18.192 sec)
INFO:tensorflow:global_step/sec: 5.50585
INFO:tensorflow:loss = 8.626741, step = 10700 (18.163 sec)
INFO:tensorflow:global_step/sec: 5.49973
INFO:tensorflow:loss = 8.280359, step = 10800 (18.182 sec)
INFO:tensorflow:global_step/sec: 5.49205
INFO:tensorflow:loss = 8.672684, step = 10900 (18.208 sec)
INFO:tensorflow:Saving checkpoints for 11000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38714
INFO:tensorflow:loss = 8.795859, step = 11000 (18.563 sec)
INFO:tensorflow:global_step/sec: 5.50473
INFO:tensorflow:loss = 8.497148, step = 11100 (18.166 sec)
INFO:tensorflow:global_step/sec: 5.48835
INFO:tensorflow:loss = 8.534442, step = 11200 (18.221 sec)
INFO:tensorflow:global_step/sec: 5.50841
INFO:tensorflow:loss = 8.796642, step = 11300 (18.154 sec)
INFO:tensorflow:global_step/sec: 5.49638
INFO:tensorflow:loss = 8.617315, step = 11400 (18.194 sec)
INFO:tensorflow:global_step/sec: 5.49652
INFO:tensorflow:loss = 8.644417, step = 11500 (18.193 sec)
INFO:tensorflow:global_step/sec: 5.4938
INFO:tensorflow:loss = 8.448664, step = 11600 (18.202 sec)
INFO:tensorflow:global_step/sec: 5.50342
INFO:tensorflow:loss = 8.275427, step = 11700 (18.171 sec)
INFO:tensorflow:global_step/sec: 5.49137
INFO:tensorflow:loss = 8.392693, step = 11800 (18.210 sec)
INFO:tensorflow:global_step/sec: 5.49519
INFO:tensorflow:loss = 8.442825, step = 11900 (18.198 sec)
INFO:tensorflow:Saving checkpoints for 12000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.3994
INFO:tensorflow:loss = 8.803602, step = 12000 (18.521 sec)
INFO:tensorflow:global_step/sec: 5.49425
INFO:tensorflow:loss = 8.486689, step = 12100 (18.201 sec)
INFO:tensorflow:global_step/sec: 5.50375
INFO:tensorflow:loss = 8.7239685, step = 12200 (18.169 sec)
INFO:tensorflow:global_step/sec: 5.49234
INFO:tensorflow:loss = 8.246479, step = 12300 (18.208 sec)
INFO:tensorflow:global_step/sec: 5.49759
INFO:tensorflow:loss = 8.199584, step = 12400 (18.189 sec)
INFO:tensorflow:global_step/sec: 5.49398
INFO:tensorflow:loss = 8.388776, step = 12500 (18.202 sec)
INFO:tensorflow:global_step/sec: 5.49254
INFO:tensorflow:loss = 8.514552, step = 12600 (18.206 sec)
INFO:tensorflow:global_step/sec: 5.506
INFO:tensorflow:loss = 8.667518, step = 12700 (18.162 sec)
INFO:tensorflow:global_step/sec: 5.49919
INFO:tensorflow:loss = 8.655082, step = 12800 (18.185 sec)
INFO:tensorflow:global_step/sec: 5.49471
INFO:tensorflow:loss = 8.203627, step = 12900 (18.198 sec)
INFO:tensorflow:Saving checkpoints for 13000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.3841
INFO:tensorflow:loss = 8.262481, step = 13000 (18.573 sec)
INFO:tensorflow:global_step/sec: 5.50022
INFO:tensorflow:loss = 8.463679, step = 13100 (18.182 sec)
INFO:tensorflow:global_step/sec: 5.49176
INFO:tensorflow:loss = 8.751322, step = 13200 (18.209 sec)
INFO:tensorflow:global_step/sec: 5.49306
INFO:tensorflow:loss = 8.270389, step = 13300 (18.204 sec)
INFO:tensorflow:global_step/sec: 5.50461
INFO:tensorflow:loss = 8.613689, step = 13400 (18.167 sec)
INFO:tensorflow:global_step/sec: 5.49302
INFO:tensorflow:loss = 8.270876, step = 13500 (18.204 sec)
INFO:tensorflow:global_step/sec: 5.49966
INFO:tensorflow:loss = 8.314171, step = 13600 (18.183 sec)
INFO:tensorflow:global_step/sec: 5.50127
INFO:tensorflow:loss = 8.158585, step = 13700 (18.178 sec)
INFO:tensorflow:global_step/sec: 5.50088
INFO:tensorflow:loss = 8.39209, step = 13800 (18.179 sec)
INFO:tensorflow:global_step/sec: 5.50173
INFO:tensorflow:loss = 8.403664, step = 13900 (18.176 sec)
INFO:tensorflow:Saving checkpoints for 14000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38847
INFO:tensorflow:loss = 8.340196, step = 14000 (18.558 sec)
INFO:tensorflow:global_step/sec: 5.48388
INFO:tensorflow:loss = 8.18512, step = 14100 (18.236 sec)
INFO:tensorflow:global_step/sec: 5.49802
INFO:tensorflow:loss = 8.321825, step = 14200 (18.188 sec)
INFO:tensorflow:global_step/sec: 5.4954
INFO:tensorflow:loss = 8.567659, step = 14300 (18.198 sec)
INFO:tensorflow:global_step/sec: 5.49604
INFO:tensorflow:loss = 8.4966135, step = 14400 (18.194 sec)
INFO:tensorflow:global_step/sec: 5.49496
INFO:tensorflow:loss = 8.466291, step = 14500 (18.199 sec)
INFO:tensorflow:global_step/sec: 5.49071
INFO:tensorflow:loss = 8.097903, step = 14600 (18.212 sec)
INFO:tensorflow:global_step/sec: 5.49197
INFO:tensorflow:loss = 8.528652, step = 14700 (18.209 sec)
INFO:tensorflow:global_step/sec: 5.49453
INFO:tensorflow:loss = 8.424143, step = 14800 (18.200 sec)
INFO:tensorflow:global_step/sec: 5.4889
INFO:tensorflow:loss = 8.214088, step = 14900 (18.218 sec)
INFO:tensorflow:Saving checkpoints for 15000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.3966
INFO:tensorflow:loss = 8.338266, step = 15000 (18.530 sec)
INFO:tensorflow:global_step/sec: 5.48952
INFO:tensorflow:loss = 8.2941065, step = 15100 (18.216 sec)
INFO:tensorflow:global_step/sec: 5.4975
INFO:tensorflow:loss = 8.052094, step = 15200 (18.190 sec)
INFO:tensorflow:global_step/sec: 5.49421
INFO:tensorflow:loss = 8.436498, step = 15300 (18.202 sec)
INFO:tensorflow:global_step/sec: 5.48903
INFO:tensorflow:loss = 8.32066, step = 15400 (18.218 sec)
INFO:tensorflow:global_step/sec: 5.48798
INFO:tensorflow:loss = 8.256911, step = 15500 (18.221 sec)
INFO:tensorflow:global_step/sec: 5.48954
INFO:tensorflow:loss = 8.214179, step = 15600 (18.216 sec)
INFO:tensorflow:global_step/sec: 5.49326
INFO:tensorflow:loss = 8.057564, step = 15700 (18.205 sec)
INFO:tensorflow:global_step/sec: 5.50061
INFO:tensorflow:loss = 8.238005, step = 15800 (18.179 sec)
INFO:tensorflow:global_step/sec: 5.49113
INFO:tensorflow:loss = 8.144582, step = 15900 (18.212 sec)
INFO:tensorflow:Saving checkpoints for 16000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.38211
INFO:tensorflow:loss = 8.504193, step = 16000 (18.579 sec)
INFO:tensorflow:global_step/sec: 5.49833
INFO:tensorflow:loss = 8.3586035, step = 16100 (18.187 sec)
INFO:tensorflow:global_step/sec: 5.49609
INFO:tensorflow:loss = 8.262217, step = 16200 (18.195 sec)
INFO:tensorflow:global_step/sec: 5.4945
INFO:tensorflow:loss = 8.220776, step = 16300 (18.200 sec)
INFO:tensorflow:global_step/sec: 5.49589
INFO:tensorflow:loss = 8.103865, step = 16400 (18.195 sec)
INFO:tensorflow:global_step/sec: 5.50206
INFO:tensorflow:loss = 8.033046, step = 16500 (18.176 sec)
INFO:tensorflow:global_step/sec: 5.49873
INFO:tensorflow:loss = 8.498009, step = 16600 (18.185 sec)
INFO:tensorflow:global_step/sec: 5.50265
INFO:tensorflow:loss = 8.596341, step = 16700 (18.173 sec)
INFO:tensorflow:global_step/sec: 5.49788
INFO:tensorflow:loss = 8.251557, step = 16800 (18.189 sec)
INFO:tensorflow:global_step/sec: 5.49499
INFO:tensorflow:loss = 8.373228, step = 16900 (18.198 sec)
INFO:tensorflow:Saving checkpoints for 17000 into ./data/beauty-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 4.41649
INFO:tensorflow:loss = 8.196045, step = 17000 (22.642 sec)
INFO:tensorflow:global_step/sec: 5.51193
INFO:tensorflow:loss = 8.2763605, step = 17100 (18.143 sec)
INFO:tensorflow:global_step/sec: 5.50737
INFO:tensorflow:loss = 8.286903, step = 17200 (18.157 sec)
INFO:tensorflow:global_step/sec: 5.49156
INFO:tensorflow:loss = 8.042718, step = 17300 (18.209 sec)
INFO:tensorflow:global_step/sec: 5.48724
INFO:tensorflow:loss = 8.254189, step = 17400 (18.225 sec)
INFO:tensorflow:global_step/sec: 5.4865
INFO:tensorflow:loss = 7.864581, step = 17500 (18.226 sec)
INFO:tensorflow:global_step/sec: 5.49061
INFO:tensorflow:loss = 8.283974, step = 17600 (18.212 sec)
INFO:tensorflow:global_step/sec: 5.49492
INFO:tensorflow:loss = 8.076025, step = 17700 (18.199 sec)
INFO:tensorflow:global_step/sec: 5.50007
INFO:tensorflow:loss = 7.892127, step = 17800 (18.181 sec)
^CTraceback (most recent call last):
  File "run.py", line 602, in <module>
    tf.app.run()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "run.py", line 569, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 3            58, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            124, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            158, in _train_model_default
    saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            407, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 676,             in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1171            , in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1255            , in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1327            , in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1091            , in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1334, in _do_cal            l
    return fn(*args)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1407, in _call_t            f_sessionrun
    run_metadata)
KeyboardInterrupt
(bert) root@container-855111b90c-e179f175:~/BERT4Rec#
Remote side unexpectedly closed network connection

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Session stopped
    - Press <return> to exit tab
    - Press R to restart session
    - Press S to save terminal output to file
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 20.3 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to root@region-11.autodl.com                         │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 100.80.192.179:0.0                           │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-90-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Sun Apr 10 22:14:22 2022 from 127.0.0.1
+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：41% 8.1G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
(base) root@container-855111b90c-e179f175:~# conda activate bert
(bert) root@container-855111b90c-e179f175:~# cd ./BERT4Rec
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 18.58
max:759, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9]
[9]
[10]
[11, 12, 13, 14, 15, 16, 17, 18, 19]
[20]
[21]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44]
[45]
[46]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116]
[117]
[118]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169]
[170]
[171]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218]
[218]
[219]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237]
[238]
[239]
begin to generate train
document num: 34306
step: 0, name: PoolWorker-1, step: 1000, time: 24.189964
step: 1, name: PoolWorker-2, step: 1000, time: 24.569483
step: 2, name: PoolWorker-3, step: 1000, time: 25.227233
step: 3, name: PoolWorker-4, step: 1000, time: 24.036387
step: 4, name: PoolWorker-5, step: 1000, time: 25.463189
step: 5, name: PoolWorker-6, step: 1000, time: 25.91102
step: 6, name: PoolWorker-7, step: 1000, time: 25.868717
step: 7, name: PoolWorker-8, step: 1000, time: 26.781983
step: 8, name: PoolWorker-9, step: 1000, time: 26.253339
step: 9, name: PoolWorker-10, step: 1000, time: 26.65625
step: 0, name: PoolWorker-1, step: 2000, time: 23.302896
step: 1, name: PoolWorker-2, step: 2000, time: 23.350481
step: 3, name: PoolWorker-4, step: 2000, time: 23.022277
step: 2, name: PoolWorker-3, step: 2000, time: 23.203177
step: 4, name: PoolWorker-5, step: 2000, time: 23.127093
step: 5, name: PoolWorker-6, step: 2000, time: 23.21358
step: 6, name: PoolWorker-7, step: 2000, time: 23.227255
step: 7, name: PoolWorker-8, step: 2000, time: 23.155549
step: 8, name: PoolWorker-9, step: 2000, time: 23.14703
step: 9, name: PoolWorker-10, step: 2000, time: 23.175183
step: 0, name: PoolWorker-1, step: 3000, time: 20.88644
step: 1, name: PoolWorker-2, step: 3000, time: 20.969252
step: 3, name: PoolWorker-4, step: 3000, time: 20.791715
step: 2, name: PoolWorker-3, step: 3000, time: 20.875408
step: 4, name: PoolWorker-5, step: 3000, time: 20.753809
step: 5, name: PoolWorker-6, step: 3000, time: 20.834592
step: 6, name: PoolWorker-7, step: 3000, time: 20.834809
step: 7, name: PoolWorker-8, step: 3000, time: 20.888018
step: 8, name: PoolWorker-9, step: 3000, time: 20.710714
step: 9, name: PoolWorker-10, step: 3000, time: 20.866158
step: 0, name: PoolWorker-1, step: 4000, time: 22.534711
step: 1, name: PoolWorker-2, step: 4000, time: 22.731309
step: 2, name: PoolWorker-3, step: 4000, time: 22.389877
step: 3, name: PoolWorker-4, step: 4000, time: 22.475394
step: 4, name: PoolWorker-5, step: 4000, time: 22.47048
step: 5, name: PoolWorker-6, step: 4000, time: 22.464796
step: 6, name: PoolWorker-7, step: 4000, time: 22.45941
step: 7, name: PoolWorker-8, step: 4000, time: 22.634526
step: 8, name: PoolWorker-9, step: 4000, time: 22.685342
step: 9, name: PoolWorker-10, step: 4000, time: 22.630545
step: 0, name: PoolWorker-1, step: 5000, time: 24.167261
step: 2, name: PoolWorker-3, step: 5000, time: 23.442631
step: 3, name: PoolWorker-4, step: 5000, time: 24.059994
step: 1, name: PoolWorker-2, step: 5000, time: 24.467302
step: 4, name: PoolWorker-5, step: 5000, time: 24.240792
step: 5, name: PoolWorker-6, step: 5000, time: 24.185512
step: 6, name: PoolWorker-7, step: 5000, time: 24.121293
step: 7, name: PoolWorker-8, step: 5000, time: 23.883025
step: 8, name: PoolWorker-9, step: 5000, time: 23.818384
step: 9, name: PoolWorker-10, step: 5000, time: 24.091344
step: 0, name: PoolWorker-1, step: 6000, time: 25.976688
step: 2, name: PoolWorker-3, step: 6000, time: 25.617289
step: 3, name: PoolWorker-4, step: 6000, time: 25.639896
step: 1, name: PoolWorker-2, step: 6000, time: 25.942165
step: 4, name: PoolWorker-5, step: 6000, time: 25.592538
step: 5, name: PoolWorker-6, step: 6000, time: 25.64758
step: 6, name: PoolWorker-7, step: 6000, time: 25.696074
step: 7, name: PoolWorker-8, step: 6000, time: 25.715884
step: 8, name: PoolWorker-9, step: 6000, time: 25.484744
step: 9, name: PoolWorker-10, step: 6000, time: 25.689042
step: 0, name: PoolWorker-1, step: 7000, time: 22.758115
step: 2, name: PoolWorker-3, step: 7000, time: 22.384133
step: 3, name: PoolWorker-4, step: 7000, time: 22.500907
step: 1, name: PoolWorker-2, step: 7000, time: 22.710849
step: 4, name: PoolWorker-5, step: 7000, time: 22.852468
step: 5, name: PoolWorker-6, step: 7000, time: 22.580016
step: 6, name: PoolWorker-7, step: 7000, time: 22.765767
step: 8, name: PoolWorker-9, step: 7000, time: 22.565026
step: 7, name: PoolWorker-8, step: 7000, time: 23.085887
step: 9, name: PoolWorker-10, step: 7000, time: 22.618798
step: 2, name: PoolWorker-3, step: 8000, time: 23.965357
step: 0, name: PoolWorker-1, step: 8000, time: 24.285153
step: 3, name: PoolWorker-4, step: 8000, time: 24.127023
step: 1, name: PoolWorker-2, step: 8000, time: 24.430803
step: 4, name: PoolWorker-5, step: 8000, time: 24.312851
step: 5, name: PoolWorker-6, step: 8000, time: 24.166001
step: 6, name: PoolWorker-7, step: 8000, time: 24.307811
step: 8, name: PoolWorker-9, step: 8000, time: 24.118018
step: 7, name: PoolWorker-8, step: 8000, time: 24.243812
step: 9, name: PoolWorker-10, step: 8000, time: 24.316493
step: 2, name: PoolWorker-3, step: 9000, time: 22.908921
step: 0, name: PoolWorker-1, step: 9000, time: 22.865683
step: 3, name: PoolWorker-4, step: 9000, time: 22.701254
step: 1, name: PoolWorker-2, step: 9000, time: 22.869879
step: 4, name: PoolWorker-5, step: 9000, time: 22.866256
step: 5, name: PoolWorker-6, step: 9000, time: 22.705661
step: 6, name: PoolWorker-7, step: 9000, time: 22.869734
step: 8, name: PoolWorker-9, step: 9000, time: 22.673256
step: 7, name: PoolWorker-8, step: 9000, time: 22.694787
step: 9, name: PoolWorker-10, step: 9000, time: 23.006263
step: 2, name: PoolWorker-3, step: 10000, time: 31.075221
step: 3, name: PoolWorker-4, step: 10000, time: 31.288532
step: 0, name: PoolWorker-1, step: 10000, time: 31.52241
step: 1, name: PoolWorker-2, step: 10000, time: 31.352208
step: 4, name: PoolWorker-5, step: 10000, time: 31.215701
step: 5, name: PoolWorker-6, step: 10000, time: 31.21081
step: 6, name: PoolWorker-7, step: 10000, time: 31.016326
step: 7, name: PoolWorker-8, step: 10000, time: 31.099452
step: 8, name: PoolWorker-9, step: 10000, time: 31.366445
step: 9, name: PoolWorker-10, step: 10000, time: 31.3172
step: 2, name: PoolWorker-3, step: 11000, time: 26.644482
step: 3, name: PoolWorker-4, step: 11000, time: 26.743205
step: 0, name: PoolWorker-1, step: 11000, time: 26.907016
step: 1, name: PoolWorker-2, step: 11000, time: 26.814896
step: 4, name: PoolWorker-5, step: 11000, time: 26.786808
step: 5, name: PoolWorker-6, step: 11000, time: 26.763352
step: 6, name: PoolWorker-7, step: 11000, time: 26.576613
step: 7, name: PoolWorker-8, step: 11000, time: 26.504093
step: 8, name: PoolWorker-9, step: 11000, time: 26.646162
step: 9, name: PoolWorker-10, step: 11000, time: 26.705766
step: 2, name: PoolWorker-3, step: 12000, time: 22.424728
step: 3, name: PoolWorker-4, step: 12000, time: 22.471214
step: 0, name: PoolWorker-1, step: 12000, time: 22.616588
step: 1, name: PoolWorker-2, step: 12000, time: 22.4391
step: 4, name: PoolWorker-5, step: 12000, time: 22.593228
step: 5, name: PoolWorker-6, step: 12000, time: 22.478994
step: 6, name: PoolWorker-7, step: 12000, time: 22.38509
step: 7, name: PoolWorker-8, step: 12000, time: 22.499185
step: 8, name: PoolWorker-9, step: 12000, time: 22.44785
step: 9, name: PoolWorker-10, step: 12000, time: 22.566166
step: 2, name: PoolWorker-3, step: 13000, time: 25.640438
step: 3, name: PoolWorker-4, step: 13000, time: 25.576409
step: 0, name: PoolWorker-1, step: 13000, time: 26.23369
step: 4, name: PoolWorker-5, step: 13000, time: 25.49698
step: 1, name: PoolWorker-2, step: 13000, time: 26.262599
step: 6, name: PoolWorker-7, step: 13000, time: 26.168648
step: 8, name: PoolWorker-9, step: 13000, time: 25.601187
step: 5, name: PoolWorker-6, step: 13000, time: 26.562832
step: 7, name: PoolWorker-8, step: 13000, time: 26.435156
step: 9, name: PoolWorker-10, step: 13000, time: 25.924542
step: 2, name: PoolWorker-3, step: 14000, time: 27.34162
step: 3, name: PoolWorker-4, step: 14000, time: 27.312824
step: 4, name: PoolWorker-5, step: 14000, time: 27.245521
step: 0, name: PoolWorker-1, step: 14000, time: 27.893148
step: 1, name: PoolWorker-2, step: 14000, time: 27.537093
step: 8, name: PoolWorker-9, step: 14000, time: 27.44906
step: 6, name: PoolWorker-7, step: 14000, time: 27.727591
step: 5, name: PoolWorker-6, step: 14000, time: 27.591459
step: 7, name: PoolWorker-8, step: 14000, time: 27.840975
step: 9, name: PoolWorker-10, step: 14000, time: 27.527823
step: 2, name: PoolWorker-3, step: 15000, time: 26.527138
step: 3, name: PoolWorker-4, step: 15000, time: 26.77914
step: 4, name: PoolWorker-5, step: 15000, time: 26.53879
step: 0, name: PoolWorker-1, step: 15000, time: 26.845972
step: 1, name: PoolWorker-2, step: 15000, time: 26.641475
step: 8, name: PoolWorker-9, step: 15000, time: 26.623876
step: 6, name: PoolWorker-7, step: 15000, time: 26.602925
step: 5, name: PoolWorker-6, step: 15000, time: 26.506965
step: 7, name: PoolWorker-8, step: 15000, time: 26.673278
step: 9, name: PoolWorker-10, step: 15000, time: 26.249783
step: 2, name: PoolWorker-3, step: 16000, time: 26.990773
step: 3, name: PoolWorker-4, step: 16000, time: 26.967428
step: 4, name: PoolWorker-5, step: 16000, time: 27.265921
step: 0, name: PoolWorker-1, step: 16000, time: 27.19826
step: 1, name: PoolWorker-2, step: 16000, time: 27.15004
step: 8, name: PoolWorker-9, step: 16000, time: 26.909778
step: 6, name: PoolWorker-7, step: 16000, time: 27.13843
step: 5, name: PoolWorker-6, step: 16000, time: 27.195643
step: 7, name: PoolWorker-8, step: 16000, time: 26.969119
step: 9, name: PoolWorker-10, step: 16000, time: 27.110135
step: 2, name: PoolWorker-3, step: 17000, time: 28.684053
step: 3, name: PoolWorker-4, step: 17000, time: 28.54068
step: 4, name: PoolWorker-5, step: 17000, time: 28.427274
step: 0, name: PoolWorker-1, step: 17000, time: 28.851793
step: 1, name: PoolWorker-2, step: 17000, time: 28.712197
step: 8, name: PoolWorker-9, step: 17000, time: 28.41637
step: 6, name: PoolWorker-7, step: 17000, time: 28.685605
step: 5, name: PoolWorker-6, step: 17000, time: 28.778781
step: 7, name: PoolWorker-8, step: 17000, time: 28.486875
step: 9, name: PoolWorker-10, step: 17000, time: 28.764964
step: 2, name: PoolWorker-3, step: 18000, time: 27.014533
step: 3, name: PoolWorker-4, step: 18000, time: 27.311067
step: 4, name: PoolWorker-5, step: 18000, time: 26.713538
step: 0, name: PoolWorker-1, step: 18000, time: 26.975012
step: 1, name: PoolWorker-2, step: 18000, time: 26.992172
step: 8, name: PoolWorker-9, step: 18000, time: 26.977386
step: 6, name: PoolWorker-7, step: 18000, time: 26.996872
step: 5, name: PoolWorker-6, step: 18000, time: 27.064065
step: 7, name: PoolWorker-8, step: 18000, time: 27.214686
step: 9, name: PoolWorker-10, step: 18000, time: 27.155978
step: 2, name: PoolWorker-3, step: 19000, time: 25.760253
step: 3, name: PoolWorker-4, step: 19000, time: 25.416361
step: 4, name: PoolWorker-5, step: 19000, time: 25.464894
step: 0, name: PoolWorker-1, step: 19000, time: 25.710294
step: 1, name: PoolWorker-2, step: 19000, time: 25.605061
step: 8, name: PoolWorker-9, step: 19000, time: 25.420376
step: 6, name: PoolWorker-7, step: 19000, time: 25.426183
step: 7, name: PoolWorker-8, step: 19000, time: 25.461372
step: 5, name: PoolWorker-6, step: 19000, time: 25.397582
step: 9, name: PoolWorker-10, step: 19000, time: 25.236728
step: 2, name: PoolWorker-3, step: 20000, time: 29.542758
step: 3, name: PoolWorker-4, step: 20000, time: 29.510241
step: 4, name: PoolWorker-5, step: 20000, time: 29.74677
step: 1, name: PoolWorker-2, step: 20000, time: 29.585609
step: 0, name: PoolWorker-1, step: 20000, time: 29.742369
step: 8, name: PoolWorker-9, step: 20000, time: 29.64081
step: 6, name: PoolWorker-7, step: 20000, time: 29.681306
step: 7, name: PoolWorker-8, step: 20000, time: 29.612804
step: 5, name: PoolWorker-6, step: 20000, time: 29.585159
step: 9, name: PoolWorker-10, step: 20000, time: 29.649641
step: 2, name: PoolWorker-3, step: 21000, time: 23.295804
step: 3, name: PoolWorker-4, step: 21000, time: 23.315386
step: 4, name: PoolWorker-5, step: 21000, time: 23.531477
step: 0, name: PoolWorker-1, step: 21000, time: 23.212296
step: 1, name: PoolWorker-2, step: 21000, time: 23.527435
step: 8, name: PoolWorker-9, step: 21000, time: 23.422623
step: 6, name: PoolWorker-7, step: 21000, time: 23.289569
step: 7, name: PoolWorker-8, step: 21000, time: 23.359656
step: 5, name: PoolWorker-6, step: 21000, time: 23.371588
step: 9, name: PoolWorker-10, step: 21000, time: 23.499033
step: 2, name: PoolWorker-3, step: 22000, time: 25.355204
step: 3, name: PoolWorker-4, step: 22000, time: 25.576667
step: 4, name: PoolWorker-5, step: 22000, time: 25.423843
step: 0, name: PoolWorker-1, step: 22000, time: 25.180464
step: 1, name: PoolWorker-2, step: 22000, time: 25.332556
step: 8, name: PoolWorker-9, step: 22000, time: 25.765278
step: 6, name: PoolWorker-7, step: 22000, time: 25.50449
step: 5, name: PoolWorker-6, step: 22000, time: 25.401367
step: 7, name: PoolWorker-8, step: 22000, time: 25.449913
step: 9, name: PoolWorker-10, step: 22000, time: 25.92346
step: 2, name: PoolWorker-3, step: 23000, time: 27.907498
step: 3, name: PoolWorker-4, step: 23000, time: 27.78013
step: 4, name: PoolWorker-5, step: 23000, time: 27.89147
step: 0, name: PoolWorker-1, step: 23000, time: 27.935016
step: 1, name: PoolWorker-2, step: 23000, time: 27.479389
step: 8, name: PoolWorker-9, step: 23000, time: 27.694136
step: 6, name: PoolWorker-7, step: 23000, time: 27.85501
step: 7, name: PoolWorker-8, step: 23000, time: 27.723402
step: 5, name: PoolWorker-6, step: 23000, time: 27.741143
step: 9, name: PoolWorker-10, step: 23000, time: 27.661528
step: 2, name: PoolWorker-3, step: 24000, time: 26.860082
step: 3, name: PoolWorker-4, step: 24000, time: 26.743888
step: 4, name: PoolWorker-5, step: 24000, time: 27.058252
step: 0, name: PoolWorker-1, step: 24000, time: 26.818587
step: 1, name: PoolWorker-2, step: 24000, time: 27.129331
step: 8, name: PoolWorker-9, step: 24000, time: 27.179968
step: 6, name: PoolWorker-7, step: 24000, time: 26.742926
step: 7, name: PoolWorker-8, step: 24000, time: 26.909675
step: 5, name: PoolWorker-6, step: 24000, time: 26.763085
step: 9, name: PoolWorker-10, step: 24000, time: 26.924628
step: 2, name: PoolWorker-3, step: 25000, time: 30.970833
step: 3, name: PoolWorker-4, step: 25000, time: 30.99288
step: 4, name: PoolWorker-5, step: 25000, time: 30.881837
step: 0, name: PoolWorker-1, step: 25000, time: 30.982931
step: 1, name: PoolWorker-2, step: 25000, time: 30.917941
step: 8, name: PoolWorker-9, step: 25000, time: 31.064956
step: 6, name: PoolWorker-7, step: 25000, time: 30.908473
step: 7, name: PoolWorker-8, step: 25000, time: 30.94849
step: 5, name: PoolWorker-6, step: 25000, time: 30.83905
step: 9, name: PoolWorker-10, step: 25000, time: 30.340898
step: 2, name: PoolWorker-3, step: 26000, time: 23.744559
step: 3, name: PoolWorker-4, step: 26000, time: 23.819318
step: 4, name: PoolWorker-5, step: 26000, time: 23.832841
step: 0, name: PoolWorker-1, step: 26000, time: 24.029038
step: 1, name: PoolWorker-2, step: 26000, time: 23.943069
step: 6, name: PoolWorker-7, step: 26000, time: 23.972336
step: 8, name: PoolWorker-9, step: 26000, time: 23.825711
step: 7, name: PoolWorker-8, step: 26000, time: 23.81126
step: 5, name: PoolWorker-6, step: 26000, time: 23.81477
step: 9, name: PoolWorker-10, step: 26000, time: 24.032047
step: 2, name: PoolWorker-3, step: 27000, time: 25.270424
step: 3, name: PoolWorker-4, step: 27000, time: 25.078545
step: 4, name: PoolWorker-5, step: 27000, time: 25.234235
step: 0, name: PoolWorker-1, step: 27000, time: 25.210278
step: 1, name: PoolWorker-2, step: 27000, time: 25.384583
step: 8, name: PoolWorker-9, step: 27000, time: 25.242069
step: 6, name: PoolWorker-7, step: 27000, time: 25.383748
step: 7, name: PoolWorker-8, step: 27000, time: 25.300319
step: 5, name: PoolWorker-6, step: 27000, time: 25.154061
step: 9, name: PoolWorker-10, step: 27000, time: 25.270901
step: 2, name: PoolWorker-3, step: 28000, time: 28.976131
step: 3, name: PoolWorker-4, step: 28000, time: 28.94843
step: 4, name: PoolWorker-5, step: 28000, time: 29.036481
step: 0, name: PoolWorker-1, step: 28000, time: 28.845882
step: 1, name: PoolWorker-2, step: 28000, time: 28.85711
step: 8, name: PoolWorker-9, step: 28000, time: 28.827611
step: 6, name: PoolWorker-7, step: 28000, time: 29.022024
step: 7, name: PoolWorker-8, step: 28000, time: 29.107073
step: 5, name: PoolWorker-6, step: 28000, time: 29.043094
step: 9, name: PoolWorker-10, step: 28000, time: 28.978783
step: 3, name: PoolWorker-4, step: 29000, time: 28.309603
step: 2, name: PoolWorker-3, step: 29000, time: 28.459427
step: 4, name: PoolWorker-5, step: 29000, time: 28.419445
step: 0, name: PoolWorker-1, step: 29000, time: 28.321002
step: 1, name: PoolWorker-2, step: 29000, time: 28.278249
step: 6, name: PoolWorker-7, step: 29000, time: 27.982521
step: 8, name: PoolWorker-9, step: 29000, time: 28.294692
step: 7, name: PoolWorker-8, step: 29000, time: 28.327668
step: 5, name: PoolWorker-6, step: 29000, time: 28.134743
step: 9, name: PoolWorker-10, step: 29000, time: 28.245566
step: 3, name: PoolWorker-4, step: 30000, time: 21.152844
step: 2, name: PoolWorker-3, step: 30000, time: 21.066651
step: 4, name: PoolWorker-5, step: 30000, time: 20.981822
step: 0, name: PoolWorker-1, step: 30000, time: 20.897702
step: 1, name: PoolWorker-2, step: 30000, time: 21.745651
step: 6, name: PoolWorker-7, step: 30000, time: 21.105538
step: 8, name: PoolWorker-9, step: 30000, time: 21.129772
step: 7, name: PoolWorker-8, step: 30000, time: 21.262454
step: 5, name: PoolWorker-6, step: 30000, time: 21.05391
step: 9, name: PoolWorker-10, step: 30000, time: 21.194211
step: 3, name: PoolWorker-4, step: 31000, time: 24.718705
step: 2, name: PoolWorker-3, step: 31000, time: 24.824688
step: 4, name: PoolWorker-5, step: 31000, time: 24.847884
step: 0, name: PoolWorker-1, step: 31000, time: 24.698712
step: 1, name: PoolWorker-2, step: 31000, time: 24.799574
step: 6, name: PoolWorker-7, step: 31000, time: 24.56358
step: 8, name: PoolWorker-9, step: 31000, time: 24.780876
step: 7, name: PoolWorker-8, step: 31000, time: 24.788372
step: 5, name: PoolWorker-6, step: 31000, time: 24.416828
step: 9, name: PoolWorker-10, step: 31000, time: 24.739925
step: 3, name: PoolWorker-4, step: 32000, time: 29.305355
step: 2, name: PoolWorker-3, step: 32000, time: 29.357344
step: 4, name: PoolWorker-5, step: 32000, time: 29.34704
step: 0, name: PoolWorker-1, step: 32000, time: 28.904279
step: 1, name: PoolWorker-2, step: 32000, time: 28.904807
step: 6, name: PoolWorker-7, step: 32000, time: 28.848103
step: 8, name: PoolWorker-9, step: 32000, time: 29.168892
step: 5, name: PoolWorker-6, step: 32000, time: 28.717078
step: 7, name: PoolWorker-8, step: 32000, time: 29.170187
step: 9, name: PoolWorker-10, step: 32000, time: 29.497712
step: 3, name: PoolWorker-4, step: 33000, time: 26.761408
step: 2, name: PoolWorker-3, step: 33000, time: 27.341076
step: 4, name: PoolWorker-5, step: 33000, time: 27.378145
step: 0, name: PoolWorker-1, step: 33000, time: 27.214692
step: 1, name: PoolWorker-2, step: 33000, time: 27.086136
step: 6, name: PoolWorker-7, step: 33000, time: 27.022634
step: 8, name: PoolWorker-9, step: 33000, time: 27.503612
step: 5, name: PoolWorker-6, step: 33000, time: 27.112632
step: 7, name: PoolWorker-8, step: 33000, time: 27.379738
step: 9, name: PoolWorker-10, step: 33000, time: 26.986404
step: 3, name: PoolWorker-4, step: 34000, time: 24.916185
step: 2, name: PoolWorker-3, step: 34000, time: 24.674634
step: 4, name: PoolWorker-5, step: 34000, time: 24.910701
step: 0, name: PoolWorker-1, step: 34000, time: 24.82442
step: 1, name: PoolWorker-2, step: 34000, time: 24.750299
step: 6, name: PoolWorker-7, step: 34000, time: 24.590191
step: 8, name: PoolWorker-9, step: 34000, time: 24.735116
step: 5, name: PoolWorker-6, step: 34000, time: 24.740722
callback function result type: <type 'list'>, size: 48663
step: 7, name: PoolWorker-8, step: 34000, time: 24.912794
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
step: 9, name: PoolWorker-10, step: 34000, time: 23.927446
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
callback function result type: <type 'list'>, size: 48663
num of instance:535293; time:77.512829
INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_21024 [MASK] [MASK] [MASK] [MASK] item_20863 item_9209
INFO:tensorflow:info: 27201
INFO:tensorflow:input_ids: 46070 3431 46070 46070 46070 46070 9667 2198 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 4015 1927 168 114 38 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1212 [MASK] item_369 [MASK] [MASK] [MASK] item_261 [MASK]
INFO:tensorflow:info: 9352
INFO:tensorflow:input_ids: 157 46070 22056 46070 46070 46070 4221 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 5 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1427 282 429 766 3102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_17339 item_17340 item_766 [MASK] [MASK] [MASK] item_17341 [MASK] [MASK] item_12577 [MA            SK] [MASK] item_17057 item_14893 [MASK] [MASK] item_2217 [MASK] [MASK] [MASK] item_17345 [MASK] [MASK] item_17346 [MASK] [            MASK] [MASK] [MASK] [MASK] item_17350 [MASK] item_11811 item_944 [MASK] [MASK] item_1844 item_17351 [MASK] item_17352 [MAS            K] item_11439 [MASK] item_17353 [MASK] [MASK] [MASK] item_17354 [MASK] item_17231
INFO:tensorflow:info: 907
INFO:tensorflow:input_ids: 46070 26812 6304 4383 46070 46070 46070 1540 46070 46070 10855 46070 46070 10489 5728 46070 460            70 3344 46070 46070 46070 7668 46070 46070 7669 46070 46070 46070 46070 46070 15459 46070 5309 421 46070 46070 3505 3698 4            6070 6686 46070 1319 46070 24678 46070 46070 46070 5131 46070 1431
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 0 4 5 6 8 9 11 12 15 16 18 19 20 22 23 25 26 27 28 29 31 34 35 38 40 42 44 45 46 48
INFO:tensorflow:masked_lm_ids: 3203 3207 3207 5823 6106 736 1568 885 5485 5485 1858 32904 8963 1255 1255 1404 35934 2503 3            0315 6927 1534 421 3505 5784 6686 1319 1177 146 3525 5378
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2157 [MASK] [MASK] item_9005 [MASK] [MASK] [MASK] item_2174 [MASK] [MASK] item_29446 [MASK] [            MASK] [MASK] [MASK] [MASK] item_24805 item_1820 item_26654 [MASK] item_15193 item_19465 [MASK] item_32523 [MASK] item_2019            1 [MASK] item_2979 [MASK] [MASK] item_20386 item_37071 [MASK] [MASK] item_27797 item_17512 item_14815 [MASK] [MASK] [MASK]             [MASK] item_2222 [MASK] [MASK] [MASK] [MASK] item_11721 item_9009 [MASK] [MASK]
INFO:tensorflow:info: 12540
INFO:tensorflow:input_ids: 4012 46070 46070 971 46070 46070 46070 2840 46070 46070 15359 46070 46070 46070 46070 46070 654            2 5454 2770 46070 16355 9711 46070 31459 46070 6429 46070 2489 46070 46070 13431 34401 46070 46070 10861 878 8844 46070 46            070 46070 46070 3438 46070 46070 46070 46070 3388 16487 46070 46070
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 1 2 4 5 6 8 9 11 12 13 14 15 19 22 24 26 28 29 32 33 37 38 39 40 42 43 44 45 48 49
INFO:tensorflow:masked_lm_ids: 10236 9162 2293 4703 631 1139 15359 7141 4569 3973 1336 2042 788 845 7668 10150 29226 5247             32195 10243 15407 2882 38215 19855 10125 915 11975 171 3633 2867
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_9664 item_7706 item_27966 item_21793 [MASK] item_27967 item_27696 item_24729 [MASK] [MASK] [M            ASK] [MASK] [MASK] item_27968 [MASK] [MASK] [MASK] item_4617 [MASK] item_18171 [MASK] [MASK] item_9713 [MASK] [MASK] [MASK            ] [MASK] [MASK] [MASK] item_8079 [MASK] [MASK] item_9671 item_27971 item_23834 [MASK] [MASK] item_7369 item_1303 [MASK] [M            ASK] [MASK] [MASK] [MASK] [MASK] item_27972 [MASK] [MASK] item_17482 item_27974
INFO:tensorflow:info: 2430
INFO:tensorflow:input_ids: 13674 2111 24026 4315 46070 14034 8629 16697 46070 46070 46070 46070 46070 26743 46070 46070 46            070 135 46070 7225 46070 46070 11412 46070 46070 46070 46070 46070 46070 274 46070 46070 4328 32091 14388 46070 46070 2661             7984 46070 46070 46070 46070 46070 46070 35653 46070 46070 22377 15940
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 4 8 9 10 11 12 14 15 16 18 20 21 23 24 25 26 27 28 30 31 35 36 39 40 41 42 43 44 46 4            7
INFO:tensorflow:masked_lm_ids: 10212 24887 28012 3639 4295 6544 27293 5807 4660 4378 9044 26744 8690 10899 14140 12861 211            59 907 20863 6701 18531 19538 3084 15525 21937 709 14227 21984 39 5226
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] item_12387 [MASK] item_3499 [MASK] item_22637 item_8366 item_234 item_37545 [            MASK] [MASK] item_6808 item_17896 [MASK] [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 26954
INFO:tensorflow:input_ids: 46070 46070 46070 19601 46070 4126 46070 9952 898 35 31054 46070 46070 3570 8706 46070 46070 46            070 46070 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 2 4 6 11 12 15 16 17 18 19 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 53 1041 153 30 420 21401 36580 8 18 392 897 27710 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_9909 [MASK] item_13899 [MASK] [MASK] [MASK] [MASK] item_9429 [MASK] item_24500 item_909 item_            1064 [MASK] [MASK]
INFO:tensorflow:info: 18954
INFO:tensorflow:input_ids: 5807 46070 5698 46070 46070 46070 46070 18834 46070 12216 7881 222 46070 46070 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 5 6 8 12 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1157 8009 633 8590 19004 30824 38911 11590 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_7963 [MASK] item_16009 item_2915 [MASK] [MASK] item_12987 [MASK] [MASK] [MASK] [MASK] item_81             item_28826 item_84 [MASK] [MASK] item_10801 item_14863 [MASK] item_36144 [MASK] item_260 [MASK] item_96 [MASK] item_8541             [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_7381 [MASK] item_8369 item_3302 item_34840 [MASK] [MASK] [MASK] item            _4777 [MASK] [MASK] [MASK] [MASK] [MASK] item_2716 [MASK] item_115
INFO:tensorflow:info: 19615
INFO:tensorflow:input_ids: 5668 46070 2175 4625 46070 46070 1278 46070 46070 46070 46070 407 11841 163 46070 46070 3172 67            82 46070 13313 46070 144 46070 349 46070 540 46070 46070 46070 46070 46070 46070 46070 218 46070 470 514 28214 46070 46070             46070 1051 46070 46070 46070 46070 46070 714 46070 4956
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 1 4 5 7 8 9 10 14 15 18 20 22 24 26 27 28 29 30 31 32 34 38 39 40 42 43 44 45 46 48
INFO:tensorflow:masked_lm_ids: 2175 729 1278 7 740 5589 5589 176 136 10391 22593 618 2352 673 25669 7191 4807 1752 9802 70            5 27 1127 15572 1056 1985 23055 2690 10640 120 4054
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2464 [MASK] item_314 [MASK] item_8290 [MASK] [MASK] [MASK] item_21241 [MASK] [MASK] [MASK] [M            ASK] item_18439 [MASK] item_22009 item_12486 item_33250 [MASK] [MASK] item_23831 [MASK] item_2739 [MASK] [MASK] [MASK] ite            m_26568 item_26568 [MASK] item_7699 [MASK] [MASK] item_10152 [MASK] [MASK] item_6932 [MASK] [MASK] [MASK] item_20356 [MASK            ] item_20356 [MASK] item_20356 item_20356 item_40338 [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 14795
INFO:tensorflow:input_ids: 6437 46070 1838 46070 1391 46070 46070 46070 12498 46070 46070 46070 46070 7300 46070 12875 627            3 27693 46070 46070 2440 46070 1623 46070 46070 46070 24521 24521 46070 9539 46070 46070 8861 46070 46070 9080 46070 46070             46070 13287 46070 13287 46070 13287 13287 43187 46070 46070 46070 46070
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 1 3 5 6 7 9 10 11 12 14 18 19 21 23 24 25 28 30 31 33 34 36 37 38 40 42 46 47 48 49
INFO:tensorflow:masked_lm_ids: 3577 1838 1391 1391 12498 12498 1511 7300 7300 7300 2440 2440 3871 2808 8151 8151 6467 1932            9 5522 7353 7353 9080 9080 9080 13287 13287 8353 12768 16837 27526
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11 item_979 [MASK] [MASK] item_23438 item_10524 [MASK] item_4215 item_18628 [MASK] item_3936             item_33829 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_1022 [MASK] [MASK] [MASK] [MASK] item_12110
INFO:tensorflow:info: 13005
INFO:tensorflow:input_ids: 433 10131 46070 46070 14008 23669 46070 3113 9864 46070 6121 30676 46070 46070 46070 46070 4607            0 46070 46070 46070 6569 46070 46070 46070 46070 30531 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 2 3 6 9 12 13 14 15 16 17 18 19 21 22 23 24 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 26241 4348 3943 38634 2833 7495 19928 7824 9634 288 25134 4499 6715 3974 9633 3432 0 0 0 0             0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_8496 [MASK] item_41478 [MASK] item_1220 item_254 [MASK] [MASK] item_9157 item_41479 [MASK] it            em_39838 [MASK] [MASK] [MASK] item_35731 item_7545 item_1265 [MASK] [MASK] [MASK] [MASK] [MASK] item_258 [MASK] [MASK] ite            m_20071 [MASK] [MASK] [MASK] item_41 item_13318 [MASK] [MASK] item_1106 item_3467 [MASK] [MASK] [MASK] [MASK] item_25730 i            tem_10808 item_10808 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_7550
INFO:tensorflow:info: 11344
INFO:tensorflow:input_ids: 4693 46070 37253 46070 346 7 46070 46070 1781 26962 46070 18840 46070 46070 46070 15598 820 21             46070 46070 46070 46070 46070 195 46070 46070 15764 46070 46070 46070 460 8287 46070 46070 406 365 46070 46070 46070 46070             26556 19542 19542 46070 46070 46070 46070 46070 46070 1359
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 1 3 6 7 10 12 13 14 18 19 20 21 22 24 25 27 28 29 32 33 36 37 38 39 43 44 45 46 47 48
INFO:tensorflow:masked_lm_ids: 2868 1170 5947 1781 18840 30629 642 1990 21 521 144 72 5658 207 187 1061 5030 5030 12 236 5            51 2453 5484 7487 1044 37768 51 170 4292 16203
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2039 item_2039 [MASK] [MASK] item_13952 [MASK] [MASK] [MASK] [MASK] item_14064
INFO:tensorflow:info: 2323
INFO:tensorflow:input_ids: 3154 3154 46070 46070 19978 46070 46070 46070 46070 15537 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 2 3 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 261 5801 19978 31053 8717 8717 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] [MASK] item_22446 item_2287 item_16579
INFO:tensorflow:info: 16566
INFO:tensorflow:input_ids: 46070 46070 46070 46070 34159 4802 1396 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 17853 21755 3215 1178 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_1449 item_1450 item_1451 item_1452 item_1453 [MASK] [MASK] [MASK] item_1457 [MASK] ite            m_1459 [MASK] [MASK] item_851 item_1462 [MASK] [MASK] item_1465 item_1466 [MASK] [MASK] item_1468 [MASK] [MASK] [MASK] [MA            SK] [MASK] item_1474 item_1475 [MASK] [MASK] [MASK] item_1479 item_1480 [MASK] item_1482 [MASK] [MASK] [MASK] [MASK] item_            1487 item_1488 item_1489 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 49
INFO:tensorflow:input_ids: 46070 16610 2649 11813 2650 20617 46070 46070 46070 17193 46070 1865 46070 46070 14 10364 46070             46070 518 3108 46070 46070 7109 46070 46070 46070 46070 46070 45702 4823 46070 46070 46070 3040 4415 46070 12751 46070 46            070 46070 46070 16002 28836 12750 46070 46070 46070 46070 46070 46070
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 0 6 7 8 10 12 13 16 17 20 21 23 24 25 26 27 30 31 32 35 37 38 39 40 44 45 46 47 48 49
INFO:tensorflow:masked_lm_ids: 27154 10433 22744 20618 10432 31244 2640 283 1808 2711 9772 17026 11993 3620 19186 19185 13            797 12827 17581 14765 13726 17457 936 6849 10155 7756 3184 1265 303 8577
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] [MASK] [MASK] item_5792 [MASK] [MASK] item_5793 item_34711 item_12345
INFO:tensorflow:info: 29065
INFO:tensorflow:input_ids: 46070 46070 46070 46070 46070 3652 46070 46070 833 34346 4202 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 2 3 4 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 10585 41164 1085 11890 6421 17014 667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_33631 item_11556             item_19575 item_11561 [MASK] [MASK] [MASK] [MASK] item_11304 item_35502 item_12903 [MASK] item_25026 [MASK] [MASK] item_1            1570 [MASK] item_5657 [MASK] item_6899 item_10352 item_36513 item_20616 [MASK] item_758 item_15508 item_22824 [MASK] [MASK            ] [MASK] [MASK] [MASK] item_34205 item_32171 [MASK] [MASK] [MASK] [MASK] item_16950
INFO:tensorflow:info: 5830
INFO:tensorflow:input_ids: 46070 46070 46070 46070 46070 46070 46070 46070 46070 46070 46070 26720 6225 14407 5687 46070 4            6070 46070 46070 3096 18152 1105 46070 26476 46070 46070 6922 46070 4214 46070 3057 15135 31004 21362 46070 1281 1284 2486            6 46070 46070 46070 46070 46070 17400 20359 46070 46070 46070 46070 9988
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 0 1 2 3 4 5 6 7 8 9 10 15 16 17 18 22 24 25 27 29 34 38 39 40 41 42 45 46 47 48
INFO:tensorflow:masked_lm_ids: 6711 923 7283 5031 8039 29769 373 23591 23591 23591 477 8846 3798 8331 17152 16853 17203 69            22 8729 6099 10025 2487 2182 11779 9279 17400 20359 8086 103 12874
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0             1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1317 [MASK] [MASK] [MASK] [MASK] item_8459 item_518 item_447 [MASK] [MASK] [MASK] item_7805 i            tem_27595 [MASK] [MASK] [MASK] item_2912 item_6713 [MASK] [MASK] [MASK] [MASK] item_7822 [MASK] item_3138 item_6813 [MASK]             [MASK] item_8579 [MASK] [MASK] [MASK] item_2142
INFO:tensorflow:info: 18841
INFO:tensorflow:input_ids: 1647 46070 46070 46070 46070 1159 380 6477 46070 46070 46070 193 7351 46070 46070 46070 38 3379             46070 46070 46070 46070 364 46070 79 1409 46070 46070 3356 46070 46070 46070 266 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 3 4 8 9 10 13 14 15 18 19 20 21 23 26 27 29 30 31 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 53 113 1769 2517 9711 28 6160 164 14757 711 1845 163 229 176 42 310 2180 1232 16540 8660 0             0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1432 [MASK] item_14579 [MASK] item_1564 [MASK] [MASK] [MASK] [MASK] item_1676
INFO:tensorflow:info: 14913
INFO:tensorflow:input_ids: 2385 46070 2880 46070 5956 46070 46070 46070 46070 2344 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 32667 1487 2888 4471 8502 15561 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_22059 item_16260 item_9941 item_3107 item_1400 item_14194 item_22060 item_5157 item_14298 ite            m_2395 item_15539 item_2019 item_20530 item_22061 item_22062 item_14721 [MASK]
INFO:tensorflow:info: 1393
INFO:tensorflow:input_ids: 16288 29369 4375 4796 4995 28957 14636 3788 19596 219 1102 854 5242 15817 15818 17795 46070 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 13601 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_43735 item_43735 item_33351 item_35781 [MASK] [MASK] item_30351 [MASK] item_773            8 [MASK] [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 16707
INFO:tensorflow:input_ids: 46070 46070 35106 35106 20340 19098 46070 46070 22516 46070 6846 46070 46070 46070 46070 46070             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 6 7 9 11 12 13 14 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 2791 38040 11946 1278 22516 2754 7569 640 25341 28341 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 535293 total instances
train:./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
begin to generate test
num of instance:34306
INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1459 item_7356 item_15245 item_1462 item_28045 item_4617 item_4304 item_17242 item_4629 item_            5237 item_33962 item_17098 item_17098 item_23808 item_33963 item_16896 item_2075 item_20919 item_11997 item_5135 item_1316            6 item_6024 item_4796 item_905 item_5262 item_1687 item_12007 item_3722 item_16403 item_919 item_11486 [MASK]
INFO:tensorflow:info: 4379
INFO:tensorflow:input_ids: 1865 2163 18340 10364 25607 135 27002 13653 4 648 31783 13176 13176 37977 18845 20373 10671 104            49 26816 19647 19029 17234 397 1345 3129 18186 6301 2071 7337 4824 15698 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 31 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 16651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_4052 item_5310 item_13684 item_33708 item_1134 item_3294 item_33600 [MASK]
INFO:tensorflow:info: 7564
INFO:tensorflow:input_ids: 7067 6522 12504 18643 23039 90 10196 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 30989 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_834 item_20428 item_2184 item_767 item_4715 item_8859 item_11342 item_4176 item_5928 item_161            98 item_7496 item_6641 item_6382 item_597 item_6492 item_8916 item_5956 item_10429 item_618 [MASK]
INFO:tensorflow:info: 26270
INFO:tensorflow:input_ids: 1631 5686 9313 487 3211 285 6283 2161 88 25454 668 2832 1907 171 553 9120 3286 2200 1904 46070             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 19 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 33923 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_6170 item_28402 item_23360 item_26069 item_1141 item_4685 item_18078 item_33447 item_20251 it            em_3461 item_10946 item_3229 item_3229 item_27927 item_26919 item_1266 item_44987 item_44987 item_18993 item_19072 [MASK]
INFO:tensorflow:info: 22757
INFO:tensorflow:input_ids: 1023 24558 5172 15395 164 4891 1597 27387 9663 166 33908 1980 1980 8341 6606 5360 37036 37036 2            2052 10136 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 11118 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11086 item_33111 item_24362 item_26773 item_13592 item_15971 item_14968 item_5122 item_12639             item_5620 item_8939 item_12296 item_11097 item_5097 item_7333 item_3640 item_3651 item_20379 item_1557 item_4646 item_2953            8 item_1658 item_19274 item_9091 item_17821 item_5267 [MASK]
INFO:tensorflow:info: 5527
INFO:tensorflow:input_ids: 3523 25335 13931 16595 2151 12989 7233 994 21554 2920 2149 4409 5760 1799 583 6538 5092 6601 10            33 1016 13288 15829 17768 4746 10115 9326 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 26 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 18232 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3897 item_3896 item_38384 item_4580 item_17199 item_976 item_3902 item_18609 item_18619 item_            3915 item_17757 item_9281 item_36894 item_6040 item_1008 item_4700 item_3958 item_3955 item_11407 item_26173 item_8767 [MA            SK]
INFO:tensorflow:info: 7278
INFO:tensorflow:input_ids: 1331 2889 42732 32570 30532 1639 416 11640 25815 9555 4299 2062 34165 23767 802 2864 2646 1250             18632 34622 2235 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 21 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 39397 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_16723 item_39482 item_944 item_20805 item_15539 item_20636 item_1758 item_5158 [MASK]
INFO:tensorflow:info: 33532
INFO:tensorflow:input_ids: 7145 26602 421 2154 1102 13202 29 68 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 9076 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_35417 item_513 item_22162 item_7967 item_73 item_10270 item_33144 item_17920 [MASK]
INFO:tensorflow:info: 26033
INFO:tensorflow:input_ids: 28094 4233 6720 2395 3260 3892 11169 4896 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3072 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_4380 item_23692 item_5380 item_1132 item_11744 item_279 item_23871 item_6184 item_30108 item_            7977 item_5834 item_44049 item_3294 item_7989 item_5872 item_7806 item_542 item_19750 item_477 item_473 item_30178 item_13            56 item_3300 item_28873 item_8842 item_3544 item_26498 item_1265 item_6966 item_12559 item_2624 item_3513 item_5852 item_8            559 item_38088 item_5849 item_20258 item_4905 item_11973 item_18999 item_1176 item_7813 item_14920 item_8706 item_27792 it            em_6354 item_15735 item_6210 item_15177 [MASK]
INFO:tensorflow:info: 17820
INFO:tensorflow:input_ids: 5317 37783 13762 109 5963 1338 4734 1666 12928 835 300 37950 90 347 413 1909 42 2002 645 80 160            59 1881 1981 19005 3835 5511 20138 21 1748 8272 122 1958 1542 607 28296 4787 9104 546 753 15382 366 28015 984 3580 6088 18            36 4182 409 32558 46070
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 49 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3435 item_12540 item_7709 item_3434 item_1141 item_459 item_22475 item_4846 item_532 item_180            76 item_374 item_5411 item_11635 item_9341 item_1205 item_9342 item_1859 item_3411 item_6096 item_6968 item_30550 item_355            2 item_21374 item_8537 item_6718 item_26919 item_4663 item_7715 item_1174 item_7713 item_7714 item_13410 item_20253 item_1            973 item_4074 item_2843 item_1064 item_3307 item_3515 item_3141 item_5516 item_19553 item_5508 item_30551 item_26483 item_            5543 item_1982 item_21347 item_2716 [MASK]
INFO:tensorflow:info: 3086
INFO:tensorflow:input_ids: 138 852 268 184 164 3 37466 3645 270 3554 16187 796 2850 2670 292 71 797 580 434 716 33708 1306             7924 104 3780 6606 59 1231 758 29598 1024 6961 6396 619 707 749 222 51 976 962 199 15269 627 30164 6836 4368 417 7791 714             46070
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1             1 1 1
INFO:tensorflow:masked_lm_positions: 49 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 2350 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1195 item_2127 item_10835 item_3531 item_2912 item_3090 item_14745 item_6716 item_260 item_11            3 item_9218 item_15825 item_15832 [MASK]
INFO:tensorflow:info: 29060
INFO:tensorflow:input_ids: 69 273 614 1871 38 515 23137 1821 144 549 8174 5666 11431 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3926 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1212 item_1044 item_32048 item_3453 item_6172 item_3076 item_5214 item_7971 item_3536 item_13            9 item_26969 item_260 item_236 item_3096 item_6193 item_13089 [MASK]
INFO:tensorflow:info: 6733
INFO:tensorflow:input_ids: 157 152 10002 216 134 11895 1818 1172 63 1908 10672 144 39 52 126 1965 46070 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 115 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_10782 item_33130 item_2084 item_26903 item_9201 item_6339 item_25989 item_5019 item_10825 ite            m_1345 item_31457 item_18919 item_1204 item_3007 item_9752 item_4776 item_19725 item_11973 item_3062 item_3143 [MASK]
INFO:tensorflow:info: 26301
INFO:tensorflow:input_ids: 964 21101 8664 12697 732 30724 14048 3705 5985 47 24180 8673 143 8 399 275 3711 753 4162 11 460            70 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 9776 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1198 item_7936 item_12404 item_34392 item_182 item_3097 item_6156 item_3029 item_2032 item_28            758 item_16575 [MASK]
INFO:tensorflow:info: 28193
INFO:tensorflow:input_ids: 9 20701 4035 33531 385 187 826 13697 7953 13785 1357 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 409 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_37165 item_5650 item_6917 item_29831 item_14031 item_318 item_21244 item_36905 item_32728 ite            m_21917 item_353 [MASK]
INFO:tensorflow:info: 32134
INFO:tensorflow:input_ids: 27954 1516 23620 39495 27397 529 25058 39180 36470 21424 15853 46070 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6610 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_13497 item_31296 item_13525 item_23971 item_5605 [MASK]
INFO:tensorflow:info: 22386
INFO:tensorflow:input_ids: 29575 39233 12481 26301 28793 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 42114 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_17110 item_10766 item_4083 item_20466 item_16237 item_19599 item_20608 item_2540 item_20473 i            tem_10329 item_646 item_29213 item_20610 item_28530 item_20474 item_4143 item_29233 item_8306 item_16943 item_656 item_131            18 item_10342 item_661 item_4108 item_20488 item_4477 item_16946 item_37434 item_679 item_10351 item_33043 item_13134 item            _20617 item_19421 [MASK]
INFO:tensorflow:info: 13982
INFO:tensorflow:input_ids: 4692 1062 8653 21604 5498 7981 12395 99 20865 2214 116 10586 11363 11519 35658 2291 9012 414 16            627 1352 4428 4403 4080 14534 13826 3288 6099 29558 3573 4000 22330 5444 12095 8922 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 34 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 9988 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_8065 item_40751 item_18041 item_3652 item_12874 item_23809 item_36604 item_19857 item_33052 [            MASK]
INFO:tensorflow:info: 10181
INFO:tensorflow:input_ids: 7392 40478 8606 4674 2275 18395 22677 8111 19560 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3809 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_18726 item_16190 item_10995 item_7011 item_17057 item_20852 item_40020 item_17981 [MASK]
INFO:tensorflow:info: 10465
INFO:tensorflow:input_ids: 2273 8350 3337 33138 10489 2028 32107 1961 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3347 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_21940 item_38461 item_28936 item_28936 item_1241 item_20235 item_14235 item_4970 item_33879 i            tem_4430 [MASK]
INFO:tensorflow:info: 13758
INFO:tensorflow:input_ids: 8921 21432 2761 2761 3119 1408 13243 843 22455 5166 46070 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 16167 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 34306 total instances
test:./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
vocab_size:46073, user_size:34306, item_size:46069, item_with_other_size:46072
vocab pickle file: ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
test data pickle file: ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
done.
checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
Traceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "run.py", line 508, in main
    bert_config = modeling.BertConfig.from_json_file(FLAGS.bert_config_file)
  File "/root/BERT4Rec/modeling.py", line 81, in from_json_file
    text = reader.read()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/lib/io/file_io.py", line 125, in read
    self._preread_check()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/lib/io/file_io.py", line 85, in _preread_            check
    compat.as_bytes(self.__name), 1024 * 512, status)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py", line 528, in _            _exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.NotFoundError: ./bert_train/bert_config_yelp_bert_64.json; No such file or directo            ry
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 519, in main
    dataset = data_partition(output_dir+dataset_name+'.txt')
  File "/root/BERT4Rec/util.py", line 26, in data_partition
    tstInt = np.array(pickle.load(fs))
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 1384, in load
    return Unpickler(file).load()
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 864, in load
    dispatch[key](self)
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 892, in load_proto
    raise ValueError, "unsupported pickle protocol: %d" % proto
ValueError: unsupported pickle protocol: 4
checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
INFO:tensorflow:*** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tenso            rflow.python.training.server_lib.ClusterSpec object at 0x7f4c3aae4310>, '_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-ml            p0.6-df10-mpps30-msl50-64', '_protocol': None, '_save_checkpoints_steps': 1000, '_keep_checkpoint_every_n_hours': 10000, '            _service': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_experim            ental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '',             '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': ''}
INFO:tensorflow:***** Running training *****
INFO:tensorflow:  Batch size = 256
WARNING:tensorflow:From /root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.            py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use tf.cast instead.
INFO:tensorflow:Calling model_fn.
INFO:tensorflow:*** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
INFO:tensorflow:**** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/learning_rate_de            cay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/ops/gradients_impl.py:110: UserWarning: Convertin            g sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
2022-04-11 13:05:13.420231: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2022-04-11 13:05:13.450498: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 13:05:13.452678: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55a0c08672c0 executing computa            tions on platform Host. Devices:
2022-04-11 13:05:13.452743: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 13:05:13.460741: E tensorflow/stream_executor/cuda/cuda_driver.cc:300] failed call to cuInit: CUDA_ERROR_NO_DEV            ICE: no CUDA-capable device is detected
2022-04-11 13:05:13.460784: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:155] no NVIDIA GPU device is present: /d            ev/nvidia0 does not exist
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:loss = 10.916352, step = 1
^C
Traceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "run.py", line 571, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 3            58, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            124, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            158, in _train_model_default
    saving_listeners)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1            407, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 676,             in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1171            , in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1255            , in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1327            , in run
    run_metadata=run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 1091            , in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1334, in _do_cal            l
    return fn(*args)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1407, in _call_t            f_sessionrun
    run_metadata)
KeyboardInterrupt
(bert) root@container-855111b90c-e179f175:~/BERT4Rec#
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# conda activate base
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 519, in main
    dataset = data_partition(output_dir+dataset_name+'.txt')
  File "/root/BERT4Rec/util.py", line 29, in data_partition
    if tstInt[user]==None:# nfeedback < 3:
IndexError: index 34306 is out of bounds for axis 0 with size 34306
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 13:16:20.694300 140244271101760 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 13:16:20.694497 140244271101760 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 13:16:20.694757 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 13:16:20.695528 140244271101760 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 13:16:20.695735 140244271101760 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 13:16:20.699293 140244271101760 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 13:16:20.699498 140244271101760 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:16:20.699609 140244271101760 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 13:16:20.699708 140244271101760 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:16:20.699829 140244271101760 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f8c98dc8810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 13:16:20.756251 140244271101760 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f8c98dc8810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 13:16:20.758335 140244271101760 run.py:563] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 13:16:20.758456 140244271101760 run.py:564]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Vari            able.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
W0411 13:16:20.824832 140244271101760 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 13:16:20.848014 140244271101760 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 13:16:20.877198 140244271101760 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 13:16:20.885101 140244271101760 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 13:16:20.916356 140244271101760 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 13:16:20.916584 140244271101760 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 13:16:20.916765 140244271101760 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 13:16:20.916918 140244271101760 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 13:16:20.917066 140244271101760 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 13:16:20.917210 140244271101760 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 13:16:20.917355 140244271101760 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 13:16:20.917493 140244271101760 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 13:16:20.930737 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 13:16:20.933061 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 13:16:20.978401 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 13:16:21.904425 140244271101760 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 13:16:21.930796 140244271101760 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tenso            rflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 13:16:21.985357 140244271101760 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.035598 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8015eed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.079891 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8015eed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.124273 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8015eed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8015eed0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8018b810>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8018b810>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.251141 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8018b810>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8018b810>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bf10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bf10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.329229 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8017bf10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bf10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.368819 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8001d450>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799f690>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799f690>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.438671 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c7799f690>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799f690>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.468872 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c7799c5d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.498163 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c7799c5d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7799c5d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7792be10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7792be10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.578838 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c7792be10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c7792be10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.645716 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8001d450>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8001d450>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bfd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bfd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.687340 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c8017bfd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c8017bfd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c776d58d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f8c776d58d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:16:22.793482 140244271101760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f8c776d58d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f8c776d58d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 13:16:22.852614 140244271101760 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 13:16:22.852888 140244271101760 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 13:16:22.853106 140244271101760 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 13:16:22.853293 140244271101760 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.853444 140244271101760 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.853604 140244271101760 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:16:22.853748 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 13:16:22.853893 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:16:22.854042 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 13:16:22.854183 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:16:22.854315 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 13:16:22.854451 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:16:22.854584 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 13:16:22.854726 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.854855 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.854985 140244271101760 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:16:22.855117 140244271101760 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 13:16:22.855267 140244271101760 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 13:16:22.855394 140244271101760 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 13:16:22.855568 140244271101760 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.855701 140244271101760 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.855863 140244271101760 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:16:22.855991 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 13:16:22.856120 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:16:22.856245 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 13:16:22.856382 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:16:22.856583 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 13:16:22.856718 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:16:22.856864 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 13:16:22.857000 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.857134 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.857263 140244271101760 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:16:22.857393 140244271101760 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 13:16:22.857527 140244271101760 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 13:16:22.857683 140244271101760 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 13:16:22.857821 140244271101760 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.857954 140244271101760 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.858101 140244271101760 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 13:16:22.858230 140244271101760 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 13:16:22.858364 140244271101760 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 13:16:22.858493 140244271101760 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 13:16:22.858621 140244271101760 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 13:16:22.858749 140244271101760 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Plea            se use tf.compat.v1.train.get_or_create_global_step instead.

W0411 13:16:22.858963 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.trai            n.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf            .compat.v1.train.polynomial_decay instead.

W0411 13:16:22.859940 140244271101760 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.trai            n.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_sc            hedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 13:16:22.865324 140244271101760 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be             removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_s            upport.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 13:16:24.324808 140244271101760 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Done calling model_fn.
I0411 13:16:25.618991 140244271101760 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0411 13:16:25.621133 140244271101760 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
^CTraceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 571, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 367, in tra            in
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1158, in _t            rain_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1192, in _t            rain_model_default
    saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1480, in _t            rain_with_estimator_spec
    log_step_count_steps=log_step_count_steps) as mon_sess:
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 584, in Monito            redTrainingSession
    stop_grace_period_secs=stop_grace_period_secs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1007, in __ini            t__
    stop_grace_period_secs=stop_grace_period_secs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 725, in __init            __
    self._sess = _RecoverableSession(self._coordinated_creator)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1200, in __ini            t__
    _WrappedSession.__init__(self, self._create_session())
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1205, in _crea            te_session
    return self._sess_creator.create_session()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 871, in create            _session
    self.tf_sess = self._session_creator.create_session()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 638, in create            _session
    self._scaffold.finalize()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 205, in finali            ze
    default_ready_op)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 287, in get_or            _default
    op = default_constructor()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 199, in defaul            t_ready_op
    variables.report_uninitialized_variables(),
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/util/tf_should_use.py", line 193, in wrapped
    return _add_should_use_warning(fn(*args, **kwargs))
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py", line 3158, in report_uninitializ            ed_variables
    init_vars = [state_ops.is_variable_initialized(v) for v in var_list]
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/variables.py", line 3158, in <listcomp>
    init_vars = [state_ops.is_variable_initialized(v) for v in var_list]
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/state_ops.py", line 131, in is_variable_initial            ized
    return gen_state_ops.is_variable_initialized(ref=ref, name=name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/gen_state_ops.py", line 284, in is_variable_ini            tialized
    "IsVariableInitialized", ref=ref, name=name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py", line 410, in _apply_o            p_helper
    with g.as_default(), ops.name_scope(name) as scope:
  File "/root/miniconda3/lib/python3.7/contextlib.py", line 112, in __enter__
    return next(self.gen)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 5651, in get_controller
    self).get_controller(default) as g, context.graph_mode():
  File "/root/miniconda3/lib/python3.7/contextlib.py", line 239, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/root/miniconda3/lib/python3.7/contextlib.py", line 86, in __init__
    if doc is None:
KeyboardInterrupt
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 519, in main
    dataset = data_partition(output_dir+dataset_name+'.txt')
  File "/root/BERT4Rec/util.py", line 29, in data_partition
    if tstInt[user]==None:# nfeedback < 3:
IndexError: index 34306 is out of bounds for axis 0 with size 34306
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 13:20:51.955944 140536762054464 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 13:20:51.956205 140536762054464 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 13:20:51.956562 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 13:20:51.957434 140536762054464 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 13:20:51.957768 140536762054464 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 13:20:51.961030 140536762054464 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 13:20:51.961216 140536762054464 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:20:51.961352 140536762054464 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 13:20:51.961499 140536762054464 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:20:51.961654 140536762054464 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fd0b2ad27d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 13:20:52.029123 140536762054464 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fd0b2ad27d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 13:20:52.031648 140536762054464 run.py:563] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 13:20:52.031818 140536762054464 run.py:564]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Vari            able.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
W0411 13:20:52.053018 140536762054464 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 13:20:52.068037 140536762054464 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 13:20:52.094649 140536762054464 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 13:20:52.100627 140536762054464 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 13:20:52.124475 140536762054464 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 13:20:52.124616 140536762054464 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 13:20:52.124744 140536762054464 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 13:20:52.124861 140536762054464 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 13:20:52.124975 140536762054464 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 13:20:52.125120 140536762054464 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 13:20:52.125234 140536762054464 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 13:20:52.125348 140536762054464 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 13:20:52.134915 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 13:20:52.136844 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 13:20:52.174365 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 13:20:52.682670 140536762054464 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 13:20:52.704523 140536762054464 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tenso            rflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 13:20:52.747635 140536762054464 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:52.786332 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b7de10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:52.820501 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b7de10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:52.853059 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b7de10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b7de10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091baa710>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091baa710>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:52.931885 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091baa710>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091baa710>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:52.997294 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b9de10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9df90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9df90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.037062 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b9df90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9df90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091679a90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091679a90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.100460 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091679a90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091679a90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091613990>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091613990>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.127017 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091613990>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091613990>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd09160ba10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd09160ba10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.157068 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd09160ba10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd09160ba10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.244920 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b9de50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b9de50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b56f90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b56f90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.310931 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091b56f90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091b56f90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091bbbd50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd091bbbd50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.345810 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd091bbbd50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd091bbbd50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd0913e8ed0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fd0913e8ed0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:20:53.429552 140536762054464 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fd0913e8ed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fd0913e8ed0>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 13:20:53.474516 140536762054464 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 13:20:53.474686 140536762054464 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 13:20:53.474869 140536762054464 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 13:20:53.475023 140536762054464 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.475193 140536762054464 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.475322 140536762054464 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:20:53.475499 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 13:20:53.475644 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:20:53.475808 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 13:20:53.475939 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:20:53.476065 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 13:20:53.476195 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:20:53.476322 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 13:20:53.476449 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.476578 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.476703 140536762054464 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:20:53.476833 140536762054464 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 13:20:53.476963 140536762054464 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 13:20:53.477092 140536762054464 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 13:20:53.477220 140536762054464 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.477342 140536762054464 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.477464 140536762054464 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:20:53.477590 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 13:20:53.477725 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:20:53.477851 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 13:20:53.477987 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:20:53.478167 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 13:20:53.478298 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:20:53.478469 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 13:20:53.478604 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.478758 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.478894 140536762054464 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:20:53.479017 140536762054464 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 13:20:53.479143 140536762054464 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 13:20:53.479266 140536762054464 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 13:20:53.479390 140536762054464 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.479548 140536762054464 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.479676 140536762054464 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 13:20:53.479835 140536762054464 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 13:20:53.479959 140536762054464 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 13:20:53.480078 140536762054464 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 13:20:53.480197 140536762054464 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 13:20:53.480316 140536762054464 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Plea            se use tf.compat.v1.train.get_or_create_global_step instead.

W0411 13:20:53.480482 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.trai            n.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf            .compat.v1.train.polynomial_decay instead.

W0411 13:20:53.481236 140536762054464 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.trai            n.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_sc            hedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 13:20:53.485989 140536762054464 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be             removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_s            upport.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 13:20:54.704007 140536762054464 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
^CTraceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 571, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 367, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1158, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1188, in _train_model_d
    features, labels, ModeKeys.TRAIN, self.config)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1146, in _call_model_fn
    model_fn_results = self._model_fn(features=features, **kwargs)
  File "run.py", line 308, in model_fn
    num_warmup_steps, use_tpu)
  File "/root/BERT4Rec/optimization.py", line 78, in create_optimizer
    zip(grads, tvars), global_step=global_step)
  File "/root/BERT4Rec/optimization.py", line 130, in apply_gradients
    tf.multiply(1.0 - self.beta_1, grad))
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py", line 322, in multiply
    return gen_math_ops.mul(x, y, name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/gen_math_ops.py", line 6490, in mul
    "Mul", x=x, y=y, name=name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py", line 527, in _apply_op_helper
    preferred_dtype=default_dtype)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1224, in internal_convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py", line 305, in _constant_tensor_conver
    return constant(v, dtype=dtype, name=name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py", line 246, in constant
    allow_broadcast=True)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/constant_op.py", line 284, in _constant_impl
    allow_broadcast=allow_broadcast))
KeyboardInterrupt
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 488, in gen_samples
    pool_size, force_last)
  File "gen_data_fin.py", line 255, in create_training_instances
    beg_idx.append(0)
AttributeError: 'range' object has no attribute 'append'
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 13:21:37.383013 140030086948672 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 13:21:37.383206 140030086948672 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 13:21:37.385147 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 13:21:37.386393 140030086948672 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 13:21:37.386602 140030086948672 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 13:21:37.390070 140030086948672 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 13:21:37.390386 140030086948672 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:21:37.390600 140030086948672 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 13:21:37.390862 140030086948672 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 13:21:37.391099 140030086948672 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f5aba7a4790>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 13:21:37.462787 140030086948672 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f5aba7a4790>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 13:21:37.466273 140030086948672 run.py:563] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 13:21:37.466413 140030086948672 run.py:564]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Vari            able.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
W0411 13:21:37.511722 140030086948672 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 13:21:37.530920 140030086948672 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 13:21:37.558367 140030086948672 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 13:21:37.565445 140030086948672 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 13:21:37.595829 140030086948672 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 13:21:37.596004 140030086948672 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 13:21:37.596173 140030086948672 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 13:21:37.596327 140030086948672 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 13:21:37.596478 140030086948672 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 13:21:37.596623 140030086948672 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 13:21:37.596765 140030086948672 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 13:21:37.596904 140030086948672 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 13:21:37.608804 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 13:21:37.611108 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 13:21:37.653360 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 13:21:38.137172 140030086948672 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 13:21:38.156216 140030086948672 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tenso            rflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 13:21:38.197760 140030086948672 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.232110 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9987ddd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.268139 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9987ddd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.309779 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9987ddd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9987ddd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a998aa750>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a998aa750>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.385569 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a998aa750>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a998aa750>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989ddd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989ddd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.452506 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9989ddd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989ddd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.490284 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9989df10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9933cf90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9933cf90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.560021 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9933cf90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9933cf90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9937ce90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9937ce90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.589512 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9937ce90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9937ce90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0bd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0bd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.619134 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a993b0bd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0bd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993aecd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993aecd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.692985 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a993aecd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993aecd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0150>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0150>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.756918 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a993b0150>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a993b0150>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.795478 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a9989df50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a9989df50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a990e8e90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f5a990e8e90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 13:21:38.892481 140030086948672 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f5a990e8e90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f5a990e8e90>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 13:21:38.954297 140030086948672 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 13:21:38.954538 140030086948672 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 13:21:38.954704 140030086948672 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 13:21:38.954846 140030086948672 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.954980 140030086948672 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.955104 140030086948672 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:21:38.955246 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 13:21:38.955389 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:21:38.955580 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 13:21:38.955727 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:21:38.955901 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 13:21:38.956028 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:21:38.956151 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 13:21:38.956278 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.956399 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.956519 140030086948672 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:21:38.956658 140030086948672 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 13:21:38.956807 140030086948672 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 13:21:38.956954 140030086948672 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 13:21:38.957103 140030086948672 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.957234 140030086948672 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.957386 140030086948672 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 13:21:38.957516 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 13:21:38.957661 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 13:21:38.957792 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 13:21:38.957949 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 13:21:38.958163 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 13:21:38.958328 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 13:21:38.958460 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 13:21:38.958615 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.958760 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.958890 140030086948672 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 13:21:38.959029 140030086948672 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 13:21:38.959167 140030086948672 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 13:21:38.959300 140030086948672 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 13:21:38.959475 140030086948672 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.959614 140030086948672 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.959764 140030086948672 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 13:21:38.959908 140030086948672 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 13:21:38.960046 140030086948672 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 13:21:38.960177 140030086948672 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 13:21:38.960306 140030086948672 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 13:21:38.960436 140030086948672 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Plea            se use tf.compat.v1.train.get_or_create_global_step instead.

W0411 13:21:38.960613 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.trai            n.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf            .compat.v1.train.polynomial_decay instead.

W0411 13:21:38.961502 140030086948672 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.trai            n.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_sc            hedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 13:21:38.966418 140030086948672 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be             removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_s            upport.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 13:21:40.209692 140030086948672 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Done calling model_fn.
I0411 13:21:41.475368 140030086948672 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0411 13:21:41.477333 140030086948672 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0411 13:21:42.401771 140030086948672 monitored_session.py:240] Graph was finalized.
2022-04-11 13:21:42.402438: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 13:21:42.422314: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 13:21:42.424014: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5605cbcdcd80 executing computa            tions on platform Host. Devices:
2022-04-11 13:21:42.424040: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 13:21:42.427944: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 13:21:42.434506: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEV            ICE: no CUDA-capable device is detected
2022-04-11 13:21:42.434552: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:163] no NVIDIA GPU device is present: /d            ev/nvidia0 does not exist
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 13:21:42.437936 140030086948672 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-0
I0411 13:21:42.439534 140030086948672 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-0
2022-04-11 13:21:42.739677: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1066: get_checkpo            int_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0411 13:21:42.809345 140030086948672 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1066: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated an            d will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0411 13:21:43.023220 140030086948672 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 13:21:43.063474 140030086948672 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 13:21:45.310134 140030086948672 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-m            p1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:loss = 10.914125, step = 1
I0411 13:21:55.646396 140030086948672 basic_session_run_hooks.py:262] loss = 10.914125, step = 1
^C
Traceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 571, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 367, in tra            in
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1158, in _t            rain_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1192, in _t            rain_model_default
    saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1484, in _t            rain_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1252, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1338, in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1411, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1169, in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionr            un
    run_metadata)
KeyboardInterrupt
(base) root@container-855111b90c-e179f175:~/BERT4Rec#
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 59.139387
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 60.048823
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 59.272459
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 58.752928000000004
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 59.621802
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 59.340851
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 60.186778000000004
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 60.089674
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 59.90616300000001
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 60.695882
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 6, name: ForkPoolWorker-7, step: 2000, time: 62.91637899999999
step: 1, name: ForkPoolWorker-2, step: 2000, time: 65.154593
step: 2, name: ForkPoolWorker-3, step: 2000, time: 64.414331
step: 0, name: ForkPoolWorker-1, step: 2000, time: 65.11986200000001
step: 5, name: ForkPoolWorker-6, step: 2000, time: 64.967108
step: 4, name: ForkPoolWorker-5, step: 2000, time: 64.94682
step: 3, name: ForkPoolWorker-4, step: 2000, time: 65.185846
step: 7, name: ForkPoolWorker-8, step: 2000, time: 64.54535
step: 8, name: ForkPoolWorker-9, step: 2000, time: 64.495841
step: 9, name: ForkPoolWorker-10, step: 2000, time: 64.13147599999999
step: 6, name: ForkPoolWorker-7, step: 3000, time: 49.892291000000014
step: 2, name: ForkPoolWorker-3, step: 3000, time: 52.17702600000001
step: 1, name: ForkPoolWorker-2, step: 3000, time: 52.581610999999995
step: 0, name: ForkPoolWorker-1, step: 3000, time: 52.62995000000001
step: 5, name: ForkPoolWorker-6, step: 3000, time: 52.450490000000016
step: 4, name: ForkPoolWorker-5, step: 3000, time: 52.68589999999999
step: 8, name: ForkPoolWorker-9, step: 3000, time: 51.556146999999996
step: 7, name: ForkPoolWorker-8, step: 3000, time: 52.082184999999996
step: 3, name: ForkPoolWorker-4, step: 3000, time: 52.77003099999999
step: 9, name: ForkPoolWorker-10, step: 3000, time: 52.22413800000001
step: 6, name: ForkPoolWorker-7, step: 4000, time: 42.300657
step: 2, name: ForkPoolWorker-3, step: 4000, time: 42.291240000000016
step: 1, name: ForkPoolWorker-2, step: 4000, time: 42.508050999999995
step: 0, name: ForkPoolWorker-1, step: 4000, time: 42.74528799999999
step: 5, name: ForkPoolWorker-6, step: 4000, time: 42.77439700000002
step: 4, name: ForkPoolWorker-5, step: 4000, time: 42.76083
step: 8, name: ForkPoolWorker-9, step: 4000, time: 42.17623499999999
step: 7, name: ForkPoolWorker-8, step: 4000, time: 42.159617999999995
step: 3, name: ForkPoolWorker-4, step: 4000, time: 42.64152300000001
step: 9, name: ForkPoolWorker-10, step: 4000, time: 42.335702
step: 6, name: ForkPoolWorker-7, step: 5000, time: 42.497803999999974
step: 2, name: ForkPoolWorker-3, step: 5000, time: 42.429933999999975
step: 1, name: ForkPoolWorker-2, step: 5000, time: 42.66898600000002
step: 0, name: ForkPoolWorker-1, step: 5000, time: 43.010895000000005
step: 4, name: ForkPoolWorker-5, step: 5000, time: 42.88509100000002
step: 5, name: ForkPoolWorker-6, step: 5000, time: 43.00340400000002
step: 8, name: ForkPoolWorker-9, step: 5000, time: 42.66465199999999
step: 7, name: ForkPoolWorker-8, step: 5000, time: 42.598123000000015
step: 3, name: ForkPoolWorker-4, step: 5000, time: 43.02321999999998
step: 9, name: ForkPoolWorker-10, step: 5000, time: 42.71662500000002
step: 6, name: ForkPoolWorker-7, step: 6000, time: 38.28510499999999
step: 2, name: ForkPoolWorker-3, step: 6000, time: 38.31299000000001
step: 1, name: ForkPoolWorker-2, step: 6000, time: 38.53958600000004
step: 0, name: ForkPoolWorker-1, step: 6000, time: 38.72421299999996
step: 5, name: ForkPoolWorker-6, step: 6000, time: 38.64424600000001
step: 8, name: ForkPoolWorker-9, step: 6000, time: 38.44881300000003
step: 4, name: ForkPoolWorker-5, step: 6000, time: 38.79141800000002
step: 7, name: ForkPoolWorker-8, step: 6000, time: 38.30503600000003
step: 9, name: ForkPoolWorker-10, step: 6000, time: 38.48833400000001
step: 3, name: ForkPoolWorker-4, step: 6000, time: 38.54271399999999
step: 6, name: ForkPoolWorker-7, step: 7000, time: 29.959652000000006
step: 2, name: ForkPoolWorker-3, step: 7000, time: 29.864634000000024
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.325355000000002
step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.054934000000003
step: 5, name: ForkPoolWorker-6, step: 7000, time: 29.98334299999999
step: 8, name: ForkPoolWorker-9, step: 7000, time: 29.989094000000023
step: 7, name: ForkPoolWorker-8, step: 7000, time: 29.957108000000005
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.131958999999995
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.096332000000018
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.237836000000016
step: 6, name: ForkPoolWorker-7, step: 8000, time: 32.50617600000004
step: 2, name: ForkPoolWorker-3, step: 8000, time: 32.52576899999997
step: 1, name: ForkPoolWorker-2, step: 8000, time: 33.03702800000002
step: 0, name: ForkPoolWorker-1, step: 8000, time: 33.041923999999995
step: 8, name: ForkPoolWorker-9, step: 8000, time: 32.676131
step: 5, name: ForkPoolWorker-6, step: 8000, time: 33.03525400000001
step: 4, name: ForkPoolWorker-5, step: 8000, time: 32.761941999999976
step: 7, name: ForkPoolWorker-8, step: 8000, time: 32.73141399999997
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.06440699999996
step: 3, name: ForkPoolWorker-4, step: 8000, time: 32.92327499999999
step: 6, name: ForkPoolWorker-7, step: 9000, time: 28.715686000000005
step: 2, name: ForkPoolWorker-3, step: 9000, time: 28.83488
step: 1, name: ForkPoolWorker-2, step: 9000, time: 28.938964999999996
step: 8, name: ForkPoolWorker-9, step: 9000, time: 28.865519000000006
step: 0, name: ForkPoolWorker-1, step: 9000, time: 29.156282000000033
step: 5, name: ForkPoolWorker-6, step: 9000, time: 28.857066999999972
step: 4, name: ForkPoolWorker-5, step: 9000, time: 28.974694
step: 7, name: ForkPoolWorker-8, step: 9000, time: 28.819067000000018
step: 9, name: ForkPoolWorker-10, step: 9000, time: 29.090497999999968
step: 3, name: ForkPoolWorker-4, step: 9000, time: 28.89002099999999
step: 6, name: ForkPoolWorker-7, step: 10000, time: 28.236589000000038
step: 2, name: ForkPoolWorker-3, step: 10000, time: 28.259506999999985
step: 1, name: ForkPoolWorker-2, step: 10000, time: 27.955415000000016
step: 8, name: ForkPoolWorker-9, step: 10000, time: 28.091702999999995
step: 4, name: ForkPoolWorker-5, step: 10000, time: 27.87979200000001
step: 0, name: ForkPoolWorker-1, step: 10000, time: 28.14375000000001
step: 7, name: ForkPoolWorker-8, step: 10000, time: 27.968365000000006
step: 5, name: ForkPoolWorker-6, step: 10000, time: 28.202574000000027
step: 9, name: ForkPoolWorker-10, step: 10000, time: 28.26065200000005
step: 3, name: ForkPoolWorker-4, step: 10000, time: 28.21130499999998
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.77721600000001
step: 2, name: ForkPoolWorker-3, step: 11000, time: 20.877871000000027
step: 1, name: ForkPoolWorker-2, step: 11000, time: 20.794324999999958
step: 4, name: ForkPoolWorker-5, step: 11000, time: 20.702589999999987
step: 8, name: ForkPoolWorker-9, step: 11000, time: 20.798721
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.805741999999952
step: 7, name: ForkPoolWorker-8, step: 11000, time: 20.935749999999985
step: 5, name: ForkPoolWorker-6, step: 11000, time: 20.758310999999992
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.705155999999988
step: 3, name: ForkPoolWorker-4, step: 11000, time: 20.780163000000016
step: 6, name: ForkPoolWorker-7, step: 12000, time: 25.482775000000004
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.637973999999986
step: 1, name: ForkPoolWorker-2, step: 12000, time: 25.56915299999997
step: 8, name: ForkPoolWorker-9, step: 12000, time: 25.447137999999995
step: 4, name: ForkPoolWorker-5, step: 12000, time: 25.518484
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.56944199999998
step: 5, name: ForkPoolWorker-6, step: 12000, time: 25.600420999999983
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.801534000000004
step: 9, name: ForkPoolWorker-10, step: 12000, time: 25.624439000000052
step: 3, name: ForkPoolWorker-4, step: 12000, time: 25.701565000000016
step: 6, name: ForkPoolWorker-7, step: 13000, time: 31.09429799999998
step: 2, name: ForkPoolWorker-3, step: 13000, time: 31.109694999999988
step: 1, name: ForkPoolWorker-2, step: 13000, time: 30.980272000000014
step: 8, name: ForkPoolWorker-9, step: 13000, time: 30.940579000000014
step: 4, name: ForkPoolWorker-5, step: 13000, time: 31.00270499999999
step: 0, name: ForkPoolWorker-1, step: 13000, time: 31.000094999999988
step: 7, name: ForkPoolWorker-8, step: 13000, time: 30.965138000000024
step: 5, name: ForkPoolWorker-6, step: 13000, time: 31.030660999999952
step: 9, name: ForkPoolWorker-10, step: 13000, time: 30.980691999999976
step: 3, name: ForkPoolWorker-4, step: 13000, time: 31.245319999999992
step: 6, name: ForkPoolWorker-7, step: 14000, time: 28.234252999999967
step: 2, name: ForkPoolWorker-3, step: 14000, time: 28.25618800000001
step: 1, name: ForkPoolWorker-2, step: 14000, time: 28.466071
step: 4, name: ForkPoolWorker-5, step: 14000, time: 28.282899999999984
step: 8, name: ForkPoolWorker-9, step: 14000, time: 28.248976000000084
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.492538999999965
step: 7, name: ForkPoolWorker-8, step: 14000, time: 28.382427000000007
step: 5, name: ForkPoolWorker-6, step: 14000, time: 28.415112999999963
step: 9, name: ForkPoolWorker-10, step: 14000, time: 28.31758099999996
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.432499000000007
step: 6, name: ForkPoolWorker-7, step: 15000, time: 22.564295000000016
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.39226300000007
step: 1, name: ForkPoolWorker-2, step: 15000, time: 22.544430000000034
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.416637000000037
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.45903599999997
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.471975000000043
step: 7, name: ForkPoolWorker-8, step: 15000, time: 22.389737000000082
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.467926000000034
step: 9, name: ForkPoolWorker-10, step: 15000, time: 22.385234999999966
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.647651999999994
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.504867000000104
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.50339400000007
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.671140000000037
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.51949000000002
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.568153000000052
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.597129999999993
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.38203299999998
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.613571999999976
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.574115000000006
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.650158999999917
step: 6, name: ForkPoolWorker-7, step: 17000, time: 23.818011999999953
step: 2, name: ForkPoolWorker-3, step: 17000, time: 24.00333999999998
step: 1, name: ForkPoolWorker-2, step: 17000, time: 23.82682699999998
step: 8, name: ForkPoolWorker-9, step: 17000, time: 23.73026600000003
step: 4, name: ForkPoolWorker-5, step: 17000, time: 24.09947999999997
step: 0, name: ForkPoolWorker-1, step: 17000, time: 23.79452200000003
step: 5, name: ForkPoolWorker-6, step: 17000, time: 23.898395999999934
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.999301999999943
step: 9, name: ForkPoolWorker-10, step: 17000, time: 23.859473999999977
step: 3, name: ForkPoolWorker-4, step: 17000, time: 24.002351999999973
step: 6, name: ForkPoolWorker-7, step: 18000, time: 16.341683999999987
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.32692099999997
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.330833000000098
step: 1, name: ForkPoolWorker-2, step: 18000, time: 16.376426000000038
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.367728000000056
step: 0, name: ForkPoolWorker-1, step: 18000, time: 16.417440000000056
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.393220000000042
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.29597799999999
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.329043999999953
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.26215000000002
step: 6, name: ForkPoolWorker-7, step: 19000, time: 15.264933000000042
step: 2, name: ForkPoolWorker-3, step: 19000, time: 15.267766999999935
step: 1, name: ForkPoolWorker-2, step: 19000, time: 15.10179400000004
step: 8, name: ForkPoolWorker-9, step: 19000, time: 15.174574000000007
step: 4, name: ForkPoolWorker-5, step: 19000, time: 15.170911000000046
step: 0, name: ForkPoolWorker-1, step: 19000, time: 15.446175999999923
step: 5, name: ForkPoolWorker-6, step: 19000, time: 15.234150999999997
step: 7, name: ForkPoolWorker-8, step: 19000, time: 15.170140999999944
step: 9, name: ForkPoolWorker-10, step: 19000, time: 15.176768000000038
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.230179000000021
step: 6, name: ForkPoolWorker-7, step: 20000, time: 15.667422999999985
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.724923999999987
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.558060000000069
step: 1, name: ForkPoolWorker-2, step: 20000, time: 15.819434000000001
step: 4, name: ForkPoolWorker-5, step: 20000, time: 15.70653900000002
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.624899000000028
step: 5, name: ForkPoolWorker-6, step: 20000, time: 15.716716999999903
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.747613999999999
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.696031000000062
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.689143000000058
step: 6, name: ForkPoolWorker-7, step: 21000, time: 16.129449000000022
step: 2, name: ForkPoolWorker-3, step: 21000, time: 16.264290000000074
step: 8, name: ForkPoolWorker-9, step: 21000, time: 16.115383000000065
step: 1, name: ForkPoolWorker-2, step: 21000, time: 16.15205000000003
step: 4, name: ForkPoolWorker-5, step: 21000, time: 16.172875999999974
step: 0, name: ForkPoolWorker-1, step: 21000, time: 16.050996000000055
step: 7, name: ForkPoolWorker-8, step: 21000, time: 16.08337800000004
step: 5, name: ForkPoolWorker-6, step: 21000, time: 16.189892999999984
step: 9, name: ForkPoolWorker-10, step: 21000, time: 16.125861999999984
step: 3, name: ForkPoolWorker-4, step: 21000, time: 16.13931500000001
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.462961000000064
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.758769999999913
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.41842399999996
step: 1, name: ForkPoolWorker-2, step: 22000, time: 18.697384000000056
step: 4, name: ForkPoolWorker-5, step: 22000, time: 18.479266000000052
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.53402200000005
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.387704999999983
step: 5, name: ForkPoolWorker-6, step: 22000, time: 18.675211999999988
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.79022000000009
step: 3, name: ForkPoolWorker-4, step: 22000, time: 18.710707999999954
step: 6, name: ForkPoolWorker-7, step: 23000, time: 14.236054999999965
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.489953000000014
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.136283000000049
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.386250000000018
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.418696999999952
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.08536700000002
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.426972999999975
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.382392999999979
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.459582999999952
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.446888000000058
step: 6, name: ForkPoolWorker-7, step: 24000, time: 12.77487300000007
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.921486000000073
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.818445999999994
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.838262999999984
step: 4, name: ForkPoolWorker-5, step: 24000, time: 12.87727099999995
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.806404999999927
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.79937300000006
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.882228000000055
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.821876999999972
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.868491999999947
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.473737000000028
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.542321000000015
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.462816999999973
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.575277000000028
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.53385400000002
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.581275000000005
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.97446500000001
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.639861999999994
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.549058999999943
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.441733999999997
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.669831999999928
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.437477999999942
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.398637000000008
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.493224999999939
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.766786000000025
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.638631000000032
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.583622999999989
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.622435999999993
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.765894000000003
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.309994999999958
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.70247500000005
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.364927999999964
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.258750000000077
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.32211099999995
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.638791999999967
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.46892600000001
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.603884999999991
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.595325000000003
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.61818299999993
step: 6, name: ForkPoolWorker-7, step: 28000, time: 10.161306999999965
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.446726000000012
step: 8, name: ForkPoolWorker-9, step: 28000, time: 10.100064000000089
step: 2, name: ForkPoolWorker-3, step: 28000, time: 10.222036000000003
step: 4, name: ForkPoolWorker-5, step: 28000, time: 10.257683999999927
step: 1, name: ForkPoolWorker-2, step: 28000, time: 10.311611000000084
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.228325999999925
step: 7, name: ForkPoolWorker-8, step: 28000, time: 10.462943999999993
step: 6, name: ForkPoolWorker-7, step: 29000, time: 9.052960999999982
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.252605000000017
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.313747000000035
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.231482000000028
step: 8, name: ForkPoolWorker-9, step: 29000, time: 9.118012000000022
step: 2, name: ForkPoolWorker-3, step: 29000, time: 9.121084999999994
step: 4, name: ForkPoolWorker-5, step: 29000, time: 9.10946899999999
step: 1, name: ForkPoolWorker-2, step: 29000, time: 9.085535999999934
step: 0, name: ForkPoolWorker-1, step: 29000, time: 9.077724999999987
step: 7, name: ForkPoolWorker-8, step: 29000, time: 9.062293000000068
step: 6, name: ForkPoolWorker-7, step: 30000, time: 9.116215999999895
step: 9, name: ForkPoolWorker-10, step: 29000, time: 9.224173000000064
step: 5, name: ForkPoolWorker-6, step: 29000, time: 9.219715999999949
step: 3, name: ForkPoolWorker-4, step: 29000, time: 9.047497000000021
step: 8, name: ForkPoolWorker-9, step: 30000, time: 9.170015000000035
step: 2, name: ForkPoolWorker-3, step: 30000, time: 9.17100599999992
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.183854999999994
step: 1, name: ForkPoolWorker-2, step: 30000, time: 9.15428200000008
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.102491999999984
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.182976999999937
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.935195000000022
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.22422999999992
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.272801999999956
step: 8, name: ForkPoolWorker-9, step: 31000, time: 8.89381000000003
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.156850000000077
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.824253999999996
step: 4, name: ForkPoolWorker-5, step: 31000, time: 8.823574000000008
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.807631000000015
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.90943100000004
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.833189000000061
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.550927999999999
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.934095999999954
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.978274000000056
step: 8, name: ForkPoolWorker-9, step: 32000, time: 8.625112000000058
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.571268000000032
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.861923000000047
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.540228999999954
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.662102000000004
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.483433999999988
step: 6, name: ForkPoolWorker-7, step: 33000, time: 8.221278999999981
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.682952
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.72035799999992
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.860187999999994
step: 2, name: ForkPoolWorker-3, step: 33000, time: 8.213171999999986
step: 8, name: ForkPoolWorker-9, step: 33000, time: 8.438516999999933
step: 4, name: ForkPoolWorker-5, step: 33000, time: 8.224775000000022
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.692290999999955
step: 1, name: ForkPoolWorker-2, step: 33000, time: 8.331053999999995
step: 6, name: ForkPoolWorker-7, step: 34000, time: 7.680549000000042
step: 7, name: ForkPoolWorker-8, step: 33000, time: 8.214066000000003
step: 0, name: ForkPoolWorker-1, step: 33000, time: 8.463892999999985
step: 9, name: ForkPoolWorker-10, step: 33000, time: 8.573051999999961
step: 2, name: ForkPoolWorker-3, step: 34000, time: 7.682902000000013
step: 5, name: ForkPoolWorker-6, step: 33000, time: 8.553995999999984
step: 8, name: ForkPoolWorker-9, step: 34000, time: 7.846938000000023
step: 4, name: ForkPoolWorker-5, step: 34000, time: 7.658698999999956
callback function result type: <class 'list'>, size: 48951
step: 3, name: ForkPoolWorker-4, step: 33000, time: 8.484643000000005
step: 1, name: ForkPoolWorker-2, step: 34000, time: 7.915087999999969
callback function result type: <class 'list'>, size: 48951
step: 7, name: ForkPoolWorker-8, step: 34000, time: 7.290076999999997
step: 0, name: ForkPoolWorker-1, step: 34000, time: 7.789027000000033
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 34000, time: 7.2393540000000485
callback function result type: <class 'list'>, size: 48951
step: 5, name: ForkPoolWorker-6, step: 34000, time: 7.40194699999995
callback function result type: <class 'list'>, size: 48951
step: 3, name: ForkPoolWorker-4, step: 34000, time: 7.116252000000031
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:45.683527999999995
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38538 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 14:03:29.144621 140477537077056 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 14:03:29.144814 140477537077056 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 14:03:29.145049 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 14:03:29.145981 140477537077056 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 14:03:29.146255 140477537077056 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 14:03:29.186661 140477537077056 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 14:03:29.186929 140477537077056 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 14:03:29.187093 140477537077056 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 14:03:29.187207 140477537077056 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 14:03:29.187316 140477537077056 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fc2e89957d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 14:03:29.251116 140477537077056 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fc2e89957d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 14:03:29.253734 140477537077056 run.py:563] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 14:03:29.253866 140477537077056 run.py:564]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Vari            able.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
W0411 14:03:29.274596 140477537077056 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 14:03:29.290221 140477537077056 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 14:03:29.312789 140477537077056 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 14:03:29.318055 140477537077056 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 14:03:29.342871 140477537077056 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 14:03:29.343060 140477537077056 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 14:03:29.343282 140477537077056 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 14:03:29.343511 140477537077056 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 14:03:29.343722 140477537077056 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 14:03:29.343869 140477537077056 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 14:03:29.344003 140477537077056 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 14:03:29.344141 140477537077056 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 14:03:29.353873 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 14:03:29.355863 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 14:03:29.391943 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 14:03:29.858013 140477537077056 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 14:03:29.877427 140477537077056 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tenso            rflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 14:03:29.918449 140477537077056 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:29.954423 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a31e50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:29.985109 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a31e50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.016579 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a31e50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a31e50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e750>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e750>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.087854 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a5e750>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e750>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4ee10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4ee10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.151405 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a4ee10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4ee10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c75ff910>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c75ff910>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.187656 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c75ff910>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c75ff910>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.276156 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7561110>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.327996 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7561110>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7561110>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c753e390>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c753e390>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.368959 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c753e390>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c753e390>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e510>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e510>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.455490 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a5e510>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a5e510>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a23510>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a23510>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.534175 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a23510>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a23510>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4eed0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4eed0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.578634 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7a4eed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7a4eed0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7298cd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7298cd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:03:30.704861 140477537077056 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fc2c7298cd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc2c7298cd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 14:03:30.767261 140477537077056 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 14:03:30.767603 140477537077056 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 14:03:30.767935 140477537077056 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 14:03:30.768179 140477537077056 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.768412 140477537077056 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.768645 140477537077056 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 14:03:30.768869 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 14:03:30.769093 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 14:03:30.769345 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 14:03:30.769591 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 14:03:30.769795 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 14:03:30.770004 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 14:03:30.770215 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 14:03:30.770460 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.770649 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.770827 140477537077056 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 14:03:30.771069 140477537077056 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 14:03:30.771272 140477537077056 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 14:03:30.771460 140477537077056 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 14:03:30.771657 140477537077056 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.771847 140477537077056 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.772100 140477537077056 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 14:03:30.772316 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 14:03:30.772500 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 14:03:30.772684 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 14:03:30.772932 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 14:03:30.773209 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 14:03:30.773436 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 14:03:30.773618 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 14:03:30.773864 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.774029 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.774209 140477537077056 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 14:03:30.774379 140477537077056 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 14:03:30.774580 140477537077056 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 14:03:30.774757 140477537077056 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 14:03:30.774983 140477537077056 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.775157 140477537077056 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.775373 140477537077056 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 14:03:30.775591 140477537077056 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 14:03:30.775839 140477537077056 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 14:03:30.776029 140477537077056 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 14:03:30.776246 140477537077056 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 14:03:30.776421 140477537077056 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Plea            se use tf.compat.v1.train.get_or_create_global_step instead.

W0411 14:03:30.776696 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.trai            n.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf            .compat.v1.train.polynomial_decay instead.

W0411 14:03:30.777744 140477537077056 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.trai            n.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_sc            hedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 14:03:30.783457 140477537077056 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be             removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_s            upport.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 14:03:32.103579 140477537077056 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Done calling model_fn.
I0411 14:03:33.337760 140477537077056 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0411 14:03:33.339685 140477537077056 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0411 14:03:34.284907 140477537077056 monitored_session.py:240] Graph was finalized.
2022-04-11 14:03:34.285460: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 14:03:34.294026: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 14:03:34.296688: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558ab748d9a0 executing computa            tions on platform Host. Devices:
2022-04-11 14:03:34.296735: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 14:03:34.299885: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 14:03:34.309401: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEV            ICE: no CUDA-capable device is detected
2022-04-11 14:03:34.309440: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:163] no NVIDIA GPU device is present: /d            ev/nvidia0 does not exist
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 14:03:34.313708 140477537077056 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-0
I0411 14:03:34.315459 140477537077056 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-0
2022-04-11 14:03:34.582640: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1066: get_checkpo            int_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0411 14:03:34.646829 140477537077056 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1066: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated an            d will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0411 14:03:34.837498 140477537077056 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 14:03:34.889645 140477537077056 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:03:37.238301 140477537077056 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-m            p1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:loss = 10.717688, step = 1
I0411 14:03:47.355665 140477537077056 basic_session_run_hooks.py:262] loss = 10.717688, step = 1

Network error: Software caused connection abort

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Session stopped
    - Press <return> to exit tab
    - Press R to restart session
    - Press S to save terminal output to file
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 20.3 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to root@region-11.autodl.com                         │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 100.80.192.179:0.0                           │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-90-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Mon Apr 11 14:08:21 2022 from 127.0.0.1
+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：41% 8.2G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
(base) root@container-855111b90c-e179f175:~# ./run_beauty.sh
-bash: ./run_beauty.sh: No such file or directory
(base) root@container-855111b90c-e179f175:~# cd ./BERT4Rec
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()

Network error: Software caused connection abort

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Session stopped
    - Press <return> to exit tab
    - Press R to restart session
    - Press S to save terminal output to file
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 20.3 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to root@region-11.autodl.com                         │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 100.80.192.179:0.0                           │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-90-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Mon Apr 11 14:13:27 2022 from 127.0.0.1
+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：41% 8.2G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
(base) root@container-855111b90c-e179f175:~#
Remote side unexpectedly closed network connection

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Session stopped
    - Press <return> to exit tab
    - Press R to restart session
    - Press S to save terminal output to file
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 20.3 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to root@region-11.autodl.com                         │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 100.80.192.179:0.0                           │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-90-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Mon Apr 11 14:13:52 2022 from 127.0.0.1
+--------------------------------------------------AutoDL--------------------------------------------------------+
目录说明:
╔═════════════════╦══════╦════╦═════════════════════════════════════════════════════════════════════════╗
║目录             ║名称  ║速度║说明                                                                     ║
╠═════════════════╬══════╬════╬═════════════════════════════════════════════════════════════════════════╣
║/                ║系统盘║快  ║实例关机数据不会丢失，可存放代码等。会随保存镜像一起保存。               ║
║/root/autodl-tmp ║数据盘║快  ║实例关机数据不会丢失，可存放读写IO要求高的数据。但不会随保存镜像一起保存 ║
╚═════════════════╩══════╩════╩═════════════════════════════════════════════════════════════════════════╝
CPU ：8 核心
内存：16 GB
GPU ：NVIDIA TITAN X (Pascal), 1
存储：
  /               ：41% 8.2G/20G
  /root/autodl-tmp：0% 0/50G
+----------------------------------------------------------------------------------------------------------------+
注意: 系统盘较小请将大的数据放置于数据盘或网盘中，重置系统时数据盘和网盘下的数据不受影响
(base) root@container-855111b90c-e179f175:~# top
top - 14:14:42 up 132 days, 15:16,  4 users,  load average: 8.39, 11.89, 10.80
Tasks:  11 total,   1 running,  10 sleeping,   0 stopped,   0 zombie
%Cpu(s): 10.5 us,  4.1 sy,  0.0 ni, 84.9 id,  0.0 wa,  0.0 hi,  0.5 si,  0.0 st
KiB Mem : 65835656 total, 45875392 free, 11145832 used,  8814432 buff/cache
KiB Swap:  8388604 total,  2124164 free,  6264440 used. 54026728 avail Mem

   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    23 root      20   0  716628  16580      4 S   2.7  0.0   0:00.78 supervisord
     1 root      20   0   25368   3372   3044 S   0.0  0.0   0:00.06 bash
    40 root      20   0  122048  66476  13360 S   0.0  0.1   0:01.23 jupyter-lab
    41 root      20   0  711876   9076   7348 S   0.0  0.0   0:00.05 proxy
    42 root      20   0   72304   5688   4960 S   0.0  0.0   0:00.01 sshd
    44 root      20   0 1970640 247688  34800 S   0.0  0.4   0:00.89 autopanel
   147 root      20   0   97532   6896   5856 S   0.0  0.0   0:00.04 sshd
   158 root      20   0   97204   6764   5816 S   0.0  0.0   0:00.03 sshd
   160 root      20   0   25600   4032   3476 S   0.0  0.0   0:00.02 bash
   214 root      20   0   13064   2108   1984 S   0.0  0.0   0:00.00 sftp-server
   272 root      20   0   38744   3232   2760 R   0.0  0.0   0:00.00 top



























(base) root@container-855111b90c-e179f175:~# cd ./BERT4Rec
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()

gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 62.796076
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 63.590593999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 63.375913
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 62.693923999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 63.002683999999995
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 63.61163
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 64.052225
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 63.93084999999999
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 64.13374999999999
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 63.740335
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()

step: 0, name: ForkPoolWorker-1, step: 2000, time: 67.26377500000001
step: 1, name: ForkPoolWorker-2, step: 2000, time: 67.06608999999999
step: 4, name: ForkPoolWorker-5, step: 2000, time: 67.130291
step: 6, name: ForkPoolWorker-7, step: 2000, time: 67.26928099999999
step: 3, name: ForkPoolWorker-4, step: 2000, time: 66.990613
step: 2, name: ForkPoolWorker-3, step: 2000, time: 67.27335699999999
step: 7, name: ForkPoolWorker-8, step: 2000, time: 67.03266
step: 5, name: ForkPoolWorker-6, step: 2000, time: 67.53802
step: 8, name: ForkPoolWorker-9, step: 2000, time: 67.424879
step: 9, name: ForkPoolWorker-10, step: 2000, time: 67.016319

step: 0, name: ForkPoolWorker-1, step: 3000, time: 54.64070000000001
step: 1, name: ForkPoolWorker-2, step: 3000, time: 54.34018499999999
step: 4, name: ForkPoolWorker-5, step: 3000, time: 54.288253999999995
step: 6, name: ForkPoolWorker-7, step: 3000, time: 54.54023599999999
step: 3, name: ForkPoolWorker-4, step: 3000, time: 54.30077699999998
step: 2, name: ForkPoolWorker-3, step: 3000, time: 54.522092000000015
step: 5, name: ForkPoolWorker-6, step: 3000, time: 54.23384200000001
step: 7, name: ForkPoolWorker-8, step: 3000, time: 54.628298
step: 8, name: ForkPoolWorker-9, step: 3000, time: 54.55017700000002
step: 9, name: ForkPoolWorker-10, step: 3000, time: 54.56658199999998
step: 0, name: ForkPoolWorker-1, step: 4000, time: 43.964585
step: 1, name: ForkPoolWorker-2, step: 4000, time: 44.28040100000001
step: 4, name: ForkPoolWorker-5, step: 4000, time: 44.39791099999999
step: 6, name: ForkPoolWorker-7, step: 4000, time: 44.29361300000002
step: 2, name: ForkPoolWorker-3, step: 4000, time: 44.065799
step: 3, name: ForkPoolWorker-4, step: 4000, time: 44.346463
step: 7, name: ForkPoolWorker-8, step: 4000, time: 43.70001400000001
step: 8, name: ForkPoolWorker-9, step: 4000, time: 44.09412500000002
step: 5, name: ForkPoolWorker-6, step: 4000, time: 44.368515
step: 9, name: ForkPoolWorker-10, step: 4000, time: 44.017086000000006
step: 0, name: ForkPoolWorker-1, step: 5000, time: 44.523289000000005
step: 1, name: ForkPoolWorker-2, step: 5000, time: 44.36818999999997
step: 4, name: ForkPoolWorker-5, step: 5000, time: 44.43867500000002
step: 6, name: ForkPoolWorker-7, step: 5000, time: 44.646567000000005
step: 3, name: ForkPoolWorker-4, step: 5000, time: 43.83596600000001
step: 2, name: ForkPoolWorker-3, step: 5000, time: 44.95764699999998
step: 7, name: ForkPoolWorker-8, step: 5000, time: 44.55376899999999
step: 5, name: ForkPoolWorker-6, step: 5000, time: 44.346930000000015
step: 9, name: ForkPoolWorker-10, step: 5000, time: 44.04534400000003
step: 8, name: ForkPoolWorker-9, step: 5000, time: 44.75662599999998
step: 0, name: ForkPoolWorker-1, step: 6000, time: 39.66112399999997
step: 1, name: ForkPoolWorker-2, step: 6000, time: 39.57181000000003
step: 6, name: ForkPoolWorker-7, step: 6000, time: 39.37827200000004
step: 4, name: ForkPoolWorker-5, step: 6000, time: 39.568894
step: 2, name: ForkPoolWorker-3, step: 6000, time: 39.485029
step: 3, name: ForkPoolWorker-4, step: 6000, time: 39.75797800000004
step: 7, name: ForkPoolWorker-8, step: 6000, time: 39.517971999999986
step: 9, name: ForkPoolWorker-10, step: 6000, time: 39.414784999999995
step: 5, name: ForkPoolWorker-6, step: 6000, time: 39.73294500000003
step: 8, name: ForkPoolWorker-9, step: 6000, time: 39.46734500000002

step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.773225000000025
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.733158000000003
step: 6, name: ForkPoolWorker-7, step: 7000, time: 30.72835600000002
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.693116000000032
step: 2, name: ForkPoolWorker-3, step: 7000, time: 30.845778999999993
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.825390999999968
step: 7, name: ForkPoolWorker-8, step: 7000, time: 31.143106999999986
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.65604400000001
step: 5, name: ForkPoolWorker-6, step: 7000, time: 30.852169000000004
step: 8, name: ForkPoolWorker-9, step: 7000, time: 30.992557999999974
step: 0, name: ForkPoolWorker-1, step: 8000, time: 34.01621200000005
step: 6, name: ForkPoolWorker-7, step: 8000, time: 33.401656
step: 1, name: ForkPoolWorker-2, step: 8000, time: 34.053015000000016
step: 4, name: ForkPoolWorker-5, step: 8000, time: 33.982781999999986
step: 3, name: ForkPoolWorker-4, step: 8000, time: 33.55070999999998
step: 2, name: ForkPoolWorker-3, step: 8000, time: 33.85446200000001
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.356694000000005
step: 7, name: ForkPoolWorker-8, step: 8000, time: 34.04047099999997
step: 5, name: ForkPoolWorker-6, step: 8000, time: 34.25447499999996
step: 8, name: ForkPoolWorker-9, step: 8000, time: 33.824382000000014
step: 6, name: ForkPoolWorker-7, step: 9000, time: 28.70174400000002
step: 0, name: ForkPoolWorker-1, step: 9000, time: 29.51291299999997
step: 3, name: ForkPoolWorker-4, step: 9000, time: 28.873156999999992
step: 1, name: ForkPoolWorker-2, step: 9000, time: 29.46373699999998
step: 9, name: ForkPoolWorker-10, step: 9000, time: 28.670706999999993
step: 4, name: ForkPoolWorker-5, step: 9000, time: 29.66476
step: 2, name: ForkPoolWorker-3, step: 9000, time: 29.501731000000007
step: 7, name: ForkPoolWorker-8, step: 9000, time: 29.284914000000015
step: 5, name: ForkPoolWorker-6, step: 9000, time: 29.785277000000008
step: 8, name: ForkPoolWorker-9, step: 9000, time: 29.739539999999977
step: 6, name: ForkPoolWorker-7, step: 10000, time: 27.886397999999986
step: 0, name: ForkPoolWorker-1, step: 10000, time: 28.460211000000015
step: 3, name: ForkPoolWorker-4, step: 10000, time: 28.098433
step: 1, name: ForkPoolWorker-2, step: 10000, time: 28.423547999999982
step: 9, name: ForkPoolWorker-10, step: 10000, time: 28.018944999999974
step: 4, name: ForkPoolWorker-5, step: 10000, time: 28.54791
step: 2, name: ForkPoolWorker-3, step: 10000, time: 28.519646999999964
step: 7, name: ForkPoolWorker-8, step: 10000, time: 28.254538999999966
step: 5, name: ForkPoolWorker-6, step: 10000, time: 28.44451700000002
step: 8, name: ForkPoolWorker-9, step: 10000, time: 28.497539999999958
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.688823999999954
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.75107300000002
step: 3, name: ForkPoolWorker-4, step: 11000, time: 20.687202000000013
step: 1, name: ForkPoolWorker-2, step: 11000, time: 20.968433000000005
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.654926999999986
step: 4, name: ForkPoolWorker-5, step: 11000, time: 21.150436000000013
step: 2, name: ForkPoolWorker-3, step: 11000, time: 21.264197999999965
step: 7, name: ForkPoolWorker-8, step: 11000, time: 21.00799699999999
step: 5, name: ForkPoolWorker-6, step: 11000, time: 20.900168000000008
step: 8, name: ForkPoolWorker-9, step: 11000, time: 21.106719999999996
step: 6, name: ForkPoolWorker-7, step: 12000, time: 25.368169000000023
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.479457999999966
step: 3, name: ForkPoolWorker-4, step: 12000, time: 25.416879999999992
step: 9, name: ForkPoolWorker-10, step: 12000, time: 25.601828000000012
step: 1, name: ForkPoolWorker-2, step: 12000, time: 25.74366600000002
step: 4, name: ForkPoolWorker-5, step: 12000, time: 25.941033000000004
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.95820500000002
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.829069000000004
step: 5, name: ForkPoolWorker-6, step: 12000, time: 25.778380000000027
step: 8, name: ForkPoolWorker-9, step: 12000, time: 26.01416499999999
step: 6, name: ForkPoolWorker-7, step: 13000, time: 30.918383000000006
step: 3, name: ForkPoolWorker-4, step: 13000, time: 30.720429000000024
step: 0, name: ForkPoolWorker-1, step: 13000, time: 30.85797999999994
step: 9, name: ForkPoolWorker-10, step: 13000, time: 30.905179000000032
step: 1, name: ForkPoolWorker-2, step: 13000, time: 31.427688000000046
step: 4, name: ForkPoolWorker-5, step: 13000, time: 31.394307999999967
step: 2, name: ForkPoolWorker-3, step: 13000, time: 31.264259999999922
step: 7, name: ForkPoolWorker-8, step: 13000, time: 31.437502999999992
step: 5, name: ForkPoolWorker-6, step: 13000, time: 31.08250700000002
step: 8, name: ForkPoolWorker-9, step: 13000, time: 31.218132000000026
step: 6, name: ForkPoolWorker-7, step: 14000, time: 28.134254
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.01129099999997
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.129748000000063
step: 9, name: ForkPoolWorker-10, step: 14000, time: 28.206772
step: 1, name: ForkPoolWorker-2, step: 14000, time: 28.494049000000018
step: 4, name: ForkPoolWorker-5, step: 14000, time: 28.474038000000064
step: 2, name: ForkPoolWorker-3, step: 14000, time: 28.60397499999999
step: 7, name: ForkPoolWorker-8, step: 14000, time: 28.427322000000004
step: 5, name: ForkPoolWorker-6, step: 14000, time: 28.19328799999994
step: 8, name: ForkPoolWorker-9, step: 14000, time: 28.654585999999995
step: 6, name: ForkPoolWorker-7, step: 15000, time: 22.189239000000043
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.163842000000045
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.309510000000046
step: 9, name: ForkPoolWorker-10, step: 15000, time: 22.130348000000026
step: 1, name: ForkPoolWorker-2, step: 15000, time: 22.356498999999985
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.57518099999993
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.67303000000004
step: 7, name: ForkPoolWorker-8, step: 15000, time: 22.628062
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.499341999999956
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.52506399999993
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.527911000000017
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.377783000000022
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.510733000000073
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.44119099999989
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.61688700000002
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.813433000000032
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.61947799999996
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.63663699999995
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.76573200000007
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.880747000000042
step: 6, name: ForkPoolWorker-7, step: 17000, time: 23.39950399999998
step: 3, name: ForkPoolWorker-4, step: 17000, time: 23.64339099999995
step: 0, name: ForkPoolWorker-1, step: 17000, time: 23.75640199999998
step: 9, name: ForkPoolWorker-10, step: 17000, time: 23.806789999999978
step: 1, name: ForkPoolWorker-2, step: 17000, time: 24.293376999999964
step: 4, name: ForkPoolWorker-5, step: 17000, time: 24.03177900000003
step: 2, name: ForkPoolWorker-3, step: 17000, time: 24.006046999999967
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.903463999999985
step: 5, name: ForkPoolWorker-6, step: 17000, time: 23.97849300000007
step: 6, name: ForkPoolWorker-7, step: 18000, time: 15.959949999999935
step: 8, name: ForkPoolWorker-9, step: 17000, time: 23.970984999999928
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.16590400000007
step: 0, name: ForkPoolWorker-1, step: 18000, time: 15.67840000000001
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.221141999999986
step: 1, name: ForkPoolWorker-2, step: 18000, time: 16.341701000000057
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.59455600000001
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.498714000000064
step: 6, name: ForkPoolWorker-7, step: 19000, time: 15.066511000000105
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.543071000000054
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.514760000000024
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.115023999999949
step: 0, name: ForkPoolWorker-1, step: 19000, time: 14.655242000000044
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.589943999999946
step: 9, name: ForkPoolWorker-10, step: 19000, time: 15.137987000000066
step: 1, name: ForkPoolWorker-2, step: 19000, time: 15.382683000000043
step: 4, name: ForkPoolWorker-5, step: 19000, time: 15.316479000000072
step: 6, name: ForkPoolWorker-7, step: 20000, time: 15.583161000000018
step: 2, name: ForkPoolWorker-3, step: 19000, time: 15.279543999999987
step: 7, name: ForkPoolWorker-8, step: 19000, time: 15.259747000000061
step: 5, name: ForkPoolWorker-6, step: 19000, time: 15.349697000000106
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.599302999999964
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.565830000000005
step: 8, name: ForkPoolWorker-9, step: 19000, time: 15.34319199999993
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.587201999999934
step: 1, name: ForkPoolWorker-2, step: 20000, time: 15.828789000000029
step: 4, name: ForkPoolWorker-5, step: 20000, time: 15.73222700000008
step: 6, name: ForkPoolWorker-7, step: 21000, time: 16.112117000000012
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.769590000000107
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.785309999999981
step: 5, name: ForkPoolWorker-6, step: 20000, time: 15.695337999999992
step: 3, name: ForkPoolWorker-4, step: 21000, time: 16.170333000000028
step: 0, name: ForkPoolWorker-1, step: 21000, time: 16.064847999999984
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.743583000000058
step: 9, name: ForkPoolWorker-10, step: 21000, time: 16.293384999999944
step: 1, name: ForkPoolWorker-2, step: 21000, time: 16.31193200000007
step: 4, name: ForkPoolWorker-5, step: 21000, time: 16.316476999999963
step: 2, name: ForkPoolWorker-3, step: 21000, time: 16.20199200000002
step: 7, name: ForkPoolWorker-8, step: 21000, time: 16.26466300000004
step: 5, name: ForkPoolWorker-6, step: 21000, time: 16.144611000000054
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.511810999999966
step: 8, name: ForkPoolWorker-9, step: 21000, time: 16.303739999999948
step: 3, name: ForkPoolWorker-4, step: 22000, time: 18.456577999999922
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.50887499999999
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.634835000000066
step: 1, name: ForkPoolWorker-2, step: 22000, time: 18.72450200000003
step: 6, name: ForkPoolWorker-7, step: 23000, time: 14.389129000000025
step: 4, name: ForkPoolWorker-5, step: 22000, time: 18.678668000000016
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.43429900000001
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.583094999999958
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.37453000000005
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.630731000000083
step: 5, name: ForkPoolWorker-6, step: 22000, time: 18.780460999999946
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.47649899999999
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.891815000000065
step: 6, name: ForkPoolWorker-7, step: 24000, time: 12.852865999999949
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.536249999999995
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.735611000000063
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.777489999999943
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.556150000000002
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.618667000000073
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.498949000000039
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.488608999999997
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.710234000000014
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.569202000000018
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.430673999999954
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.94355900000005
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.555808999999954
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.443204000000037
step: 4, name: ForkPoolWorker-5, step: 24000, time: 12.967654999999922
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.916042999999945
step: 7, name: ForkPoolWorker-8, step: 24000, time: 13.019689000000085
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.903503
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.621000999999978
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.815803999999957
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.545254
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.550374000000033
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.568058000000065
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.542932999999948
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.699259999999981
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.574975999999992
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.491651999999931
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.64532100000008
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.520559000000048
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.34336200000007
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.639883000000054
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.309627999999975
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.310497000000055
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.579973999999993
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.605872999999974
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.353349999999978
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.743615999999975
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.693366999999967
step: 6, name: ForkPoolWorker-7, step: 28000, time: 10.035706000000005
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.612899999999968
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.113285999999903
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.680797000000098
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.127637999999934
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.654091999999991
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.046587999999929
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.583300000000008
step: 6, name: ForkPoolWorker-7, step: 29000, time: 8.971502999999984
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.706007999999997
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.539334999999937
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.476237999999967
step: 3, name: ForkPoolWorker-4, step: 29000, time: 9.029314999999997
step: 0, name: ForkPoolWorker-1, step: 29000, time: 8.986431999999922
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.62527799999998
step: 1, name: ForkPoolWorker-2, step: 28000, time: 10.37018999999998
step: 9, name: ForkPoolWorker-10, step: 29000, time: 9.003792999999973
step: 6, name: ForkPoolWorker-7, step: 30000, time: 9.07116499999995
step: 4, name: ForkPoolWorker-5, step: 28000, time: 10.317831999999953
step: 2, name: ForkPoolWorker-3, step: 28000, time: 10.24995100000001
step: 7, name: ForkPoolWorker-8, step: 28000, time: 10.343235999999933
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.097707000000014
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.363124000000084
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.01693899999998
step: 8, name: ForkPoolWorker-9, step: 28000, time: 10.36084100000005
step: 1, name: ForkPoolWorker-2, step: 29000, time: 9.127587999999946
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.053500999999983
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.787913000000003
step: 4, name: ForkPoolWorker-5, step: 29000, time: 9.080241000000001
step: 2, name: ForkPoolWorker-3, step: 29000, time: 9.15828399999998
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.781435999999985
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.817500999999993
step: 7, name: ForkPoolWorker-8, step: 29000, time: 9.386019000000033
step: 5, name: ForkPoolWorker-6, step: 29000, time: 9.177607999999964
step: 8, name: ForkPoolWorker-9, step: 29000, time: 9.084423000000015
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.822978000000035
step: 1, name: ForkPoolWorker-2, step: 30000, time: 9.250586999999996
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.55917599999998
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.265693000000056
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.495712000000026
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.497994000000062
step: 2, name: ForkPoolWorker-3, step: 30000, time: 9.320336999999995
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.162818000000016
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.241340000000037
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.421357000000057
step: 6, name: ForkPoolWorker-7, step: 33000, time: 8.315596000000028
step: 1, name: ForkPoolWorker-2, step: 31000, time: 9.123163999999974
step: 8, name: ForkPoolWorker-9, step: 30000, time: 9.331021999999962
step: 3, name: ForkPoolWorker-4, step: 33000, time: 8.172901000000024
step: 4, name: ForkPoolWorker-5, step: 31000, time: 9.111958000000072
step: 0, name: ForkPoolWorker-1, step: 33000, time: 8.449590000000057
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.986239999999952
step: 7, name: ForkPoolWorker-8, step: 31000, time: 9.07278999999994
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.99989000000005
step: 6, name: ForkPoolWorker-7, step: 34000, time: 7.711965999999961
step: 9, name: ForkPoolWorker-10, step: 33000, time: 8.160507000000052
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.725221000000033
step: 8, name: ForkPoolWorker-9, step: 31000, time: 9.270174999999995
step: 3, name: ForkPoolWorker-4, step: 34000, time: 7.623546999999917
step: 0, name: ForkPoolWorker-1, step: 34000, time: 7.982364999999959
callback function result type: <class 'list'>, size: 48951
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.769969999999944
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.751630999999975
step: 9, name: ForkPoolWorker-10, step: 34000, time: 7.458397999999988
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.872539999999958
callback function result type: <class 'list'>, size: 48951
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.88408800000002
callback function result type: <class 'list'>, size: 48951
step: 1, name: ForkPoolWorker-2, step: 33000, time: 8.095802999999933
step: 8, name: ForkPoolWorker-9, step: 32000, time: 8.341635999999994
callback function result type: <class 'list'>, size: 48951
step: 4, name: ForkPoolWorker-5, step: 33000, time: 7.968938999999978
step: 2, name: ForkPoolWorker-3, step: 33000, time: 7.346946000000003
step: 7, name: ForkPoolWorker-8, step: 33000, time: 7.364317999999912
step: 5, name: ForkPoolWorker-6, step: 33000, time: 7.236752000000024
step: 1, name: ForkPoolWorker-2, step: 34000, time: 6.636977000000002
step: 8, name: ForkPoolWorker-9, step: 33000, time: 7.128808000000049
step: 4, name: ForkPoolWorker-5, step: 34000, time: 6.663686999999982
step: 2, name: ForkPoolWorker-3, step: 34000, time: 6.743783000000008
callback function result type: <class 'list'>, size: 48951
step: 7, name: ForkPoolWorker-8, step: 34000, time: 6.678902999999991
step: 5, name: ForkPoolWorker-6, step: 34000, time: 6.7372420000000375
callback function result type: <class 'list'>, size: 48951
step: 8, name: ForkPoolWorker-9, step: 34000, time: 6.601067000000057
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:45.573257999999996
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38537 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 14:35:43.896238 140578650728256 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 14:35:43.896410 140578650728256 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 14:35:43.896660 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 14:35:43.897338 140578650728256 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 14:35:43.897549 140578650728256 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 14:35:43.900559 140578650728256 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 14:35:43.900835 140578650728256 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 14:35:43.901026 140578650728256 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 14:35:43.901202 140578650728256 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 14:35:43.901383 140578650728256 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fda6f6cd810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 14:35:43.971938 140578650728256 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fda6f6cd810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 14:35:43.975014 140578650728256 run.py:563] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 14:35:43.975150 140578650728256 run.py:564]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Vari            able.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
W0411 14:35:44.000599 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts            .
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 14:35:44.017942 140578650728256 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 14:35:44.043427 140578650728256 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 14:35:44.050171 140578650728256 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 14:35:44.079747 140578650728256 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 14:35:44.079913 140578650728256 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 14:35:44.080082 140578650728256 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 14:35:44.080237 140578650728256 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 14:35:44.080385 140578650728256 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 14:35:44.080527 140578650728256 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 14:35:44.080667 140578650728256 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 14:35:44.080806 140578650728256 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 14:35:44.092052 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 14:35:44.094241 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 14:35:44.139464 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 14:35:44.684174 140578650728256 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob             is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 14:35:44.708928 140578650728256 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tenso            rflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 14:35:44.755948 140578650728256 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:44.798082 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7a7e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:44.834267 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7a7e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:44.870281 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7a7e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a7e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4750>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4750>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:44.954800 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7d4750>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4750>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.032313 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7c7e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e375bd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e375bd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.085741 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e375bd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e375bd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e38f950>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e38f950>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.160326 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e38f950>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e38f950>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.191304 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7a1410>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.223014 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7a1410>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7a1410>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4690>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4690>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.298669 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7d4690>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7d4690>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e6dfa10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e6dfa10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.362859 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e6dfa10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e6dfa10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.401664 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e7c7e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e7c7e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e010ad0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e010ad0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 14:35:45.500645 140578650728256 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fda4e010ad0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fda4e010ad0>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 14:35:45.557171 140578650728256 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 14:35:45.557415 140578650728256 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 14:35:45.557609 140578650728256 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 14:35:45.557759 140578650728256 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.557909 140578650728256 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.558051 140578650728256 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 14:35:45.558188 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 14:35:45.558323 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 14:35:45.558451 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 14:35:45.558587 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 14:35:45.558719 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 14:35:45.558850 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 14:35:45.558984 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 14:35:45.559118 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.559255 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.559380 140578650728256 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 14:35:45.559566 140578650728256 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 14:35:45.559707 140578650728256 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 14:35:45.559882 140578650728256 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 14:35:45.560001 140578650728256 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.560113 140578650728256 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.560226 140578650728256 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 14:35:45.560377 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 14:35:45.560502 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 14:35:45.560622 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 14:35:45.560764 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 14:35:45.560942 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 14:35:45.561070 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 14:35:45.561190 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 14:35:45.561313 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.561429 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.561551 140578650728256 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 14:35:45.561668 140578650728256 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 14:35:45.561789 140578650728256 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 14:35:45.561907 140578650728256 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 14:35:45.562028 140578650728256 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.562142 140578650728256 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.562257 140578650728256 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 14:35:45.562373 140578650728256 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 14:35:45.562492 140578650728256 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 14:35:45.562605 140578650728256 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 14:35:45.562719 140578650728256 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 14:35:45.562832 140578650728256 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Plea            se use tf.compat.v1.train.get_or_create_global_step instead.

W0411 14:35:45.563011 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.trai            n.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf            .compat.v1.train.polynomial_decay instead.

W0411 14:35:45.563893 140578650728256 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.trai            n.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_sc            hedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 14:35:45.569545 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be             removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_s            upport.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 14:35:46.866489 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Done calling model_fn.
I0411 14:35:48.143780 140578650728256 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0411 14:35:48.145442 140578650728256 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0411 14:35:49.005573 140578650728256 monitored_session.py:240] Graph was finalized.
2022-04-11 14:35:49.006176: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 14:35:49.018147: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 14:35:49.020508: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559225f9aca0 executing computa            tions on platform Host. Devices:
2022-04-11 14:35:49.020544: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 14:35:49.023296: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 14:35:49.059641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 14:35:49.064280: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 14:35:49.129187: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
2022-04-11 14:35:49.163775: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcufft.so.10.0
2022-04-11 14:35:49.171390: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcurand.so.10.0
2022-04-11 14:35:49.246698: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusolver.so.10.0
2022-04-11 14:35:49.306954: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusparse.so.10.0
2022-04-11 14:35:49.460078: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudnn.so.7
2022-04-11 14:35:49.461483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 14:35:49.461574: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 14:35:49.720713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor wi            th strength 1 edge matrix:
2022-04-11 14:35:49.720763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 14:35:49.720771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 14:35:49.722091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:local            host/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bu            s id: 0000:82:00.0, compute capability: 6.1)
2022-04-11 14:35:49.726807: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559227a47040 executing computa            tions on platform CUDA. Devices:
2022-04-11 14:35:49.726835: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): NVIDIA TITAN X             (Pascal), Compute Capability 6.1
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 14:35:49.731951 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-0
I0411 14:35:49.736534 140578650728256 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-0
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1066: get_checkpo            int_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0411 14:35:52.349893 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1066: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated an            d will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
2022-04-11 14:35:52.563170: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0411 14:35:52.587893 140578650728256 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 14:35:52.632791 140578650728256 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:35:54.927714 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-m            p1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
2022-04-11 14:35:56.813839: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
INFO:tensorflow:loss = 10.7432995, step = 0
I0411 14:35:57.701319 140578650728256 basic_session_run_hooks.py:262] loss = 10.7432995, step = 0
INFO:tensorflow:global_step/sec: 4.60255
I0411 14:36:19.427859 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 4.60255
INFO:tensorflow:loss = 7.462219, step = 100 (21.728 sec)
I0411 14:36:19.429229 140578650728256 basic_session_run_hooks.py:260] loss = 7.462219, step = 100 (21.728 sec)
INFO:tensorflow:global_step/sec: 5.62199
I0411 14:36:37.214942 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62199
INFO:tensorflow:loss = 3.357239, step = 200 (17.787 sec)
I0411 14:36:37.216141 140578650728256 basic_session_run_hooks.py:260] loss = 3.357239, step = 200 (17.787 sec)
INFO:tensorflow:global_step/sec: 5.6117
I0411 14:36:55.034919 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6117
INFO:tensorflow:loss = 0.5418298, step = 300 (17.820 sec)
I0411 14:36:55.036325 140578650728256 basic_session_run_hooks.py:260] loss = 0.5418298, step = 300 (17.820 sec)
INFO:tensorflow:global_step/sec: 5.60714
I0411 14:37:12.869492 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60714
INFO:tensorflow:loss = 0.11898847, step = 400 (17.835 sec)
I0411 14:37:12.870912 140578650728256 basic_session_run_hooks.py:260] loss = 0.11898847, step = 400 (17.835 sec)
INFO:tensorflow:global_step/sec: 5.61561
I0411 14:37:30.676837 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61561
INFO:tensorflow:loss = 0.06224545, step = 500 (17.807 sec)
I0411 14:37:30.678181 140578650728256 basic_session_run_hooks.py:260] loss = 0.06224545, step = 500 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.61224
I0411 14:37:48.495164 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61224
INFO:tensorflow:loss = 0.041085526, step = 600 (17.819 sec)
I0411 14:37:48.496867 140578650728256 basic_session_run_hooks.py:260] loss = 0.041085526, step = 600 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61382
I0411 14:38:06.308174 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61382
INFO:tensorflow:loss = 0.0301433, step = 700 (17.812 sec)
I0411 14:38:06.309203 140578650728256 basic_session_run_hooks.py:260] loss = 0.0301433, step = 700 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61045
I0411 14:38:24.132016 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61045
INFO:tensorflow:loss = 0.02349332, step = 800 (17.824 sec)
I0411 14:38:24.132915 140578650728256 basic_session_run_hooks.py:260] loss = 0.02349332, step = 800 (17.824 sec)
INFO:tensorflow:global_step/sec: 5.61278
I0411 14:38:41.948490 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61278
INFO:tensorflow:loss = 0.019051868, step = 900 (17.816 sec)
I0411 14:38:41.949255 140578650728256 basic_session_run_hooks.py:260] loss = 0.019051868, step = 900 (17.816 sec)
INFO:tensorflow:Saving checkpoints for 1000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:38:59.590801 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 1000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4834
I0411 14:39:00.185253 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4834
INFO:tensorflow:loss = 0.015875094, step = 1000 (18.237 sec)
I0411 14:39:00.186021 140578650728256 basic_session_run_hooks.py:260] loss = 0.015875094, step = 1000 (18.237 sec)
INFO:tensorflow:global_step/sec: 5.61385
I0411 14:39:17.998484 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61385
INFO:tensorflow:loss = 0.013499845, step = 1100 (17.814 sec)
I0411 14:39:18.000005 140578650728256 basic_session_run_hooks.py:260] loss = 0.013499845, step = 1100 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.60881
I0411 14:39:35.827719 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60881
INFO:tensorflow:loss = 0.011665662, step = 1200 (17.829 sec)
I0411 14:39:35.828890 140578650728256 basic_session_run_hooks.py:260] loss = 0.011665662, step = 1200 (17.829 sec)
INFO:tensorflow:global_step/sec: 5.61196
I0411 14:39:53.646744 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61196
INFO:tensorflow:loss = 0.010200963, step = 1300 (17.819 sec)
I0411 14:39:53.648198 140578650728256 basic_session_run_hooks.py:260] loss = 0.010200963, step = 1300 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.609
I0411 14:40:11.475540 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.609
INFO:tensorflow:loss = 0.009003572, step = 1400 (17.829 sec)
I0411 14:40:11.476779 140578650728256 basic_session_run_hooks.py:260] loss = 0.009003572, step = 1400 (17.829 sec)
INFO:tensorflow:global_step/sec: 5.60862
I0411 14:40:29.305067 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60862
INFO:tensorflow:loss = 0.00802166, step = 1500 (17.829 sec)
I0411 14:40:29.306275 140578650728256 basic_session_run_hooks.py:260] loss = 0.00802166, step = 1500 (17.829 sec)
INFO:tensorflow:global_step/sec: 5.61308
I0411 14:40:47.120553 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61308
INFO:tensorflow:loss = 0.0071970085, step = 1600 (17.815 sec)
I0411 14:40:47.121762 140578650728256 basic_session_run_hooks.py:260] loss = 0.0071970085, step = 1600 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.60985
I0411 14:41:04.946197 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60985
INFO:tensorflow:loss = 0.006496609, step = 1700 (17.826 sec)
I0411 14:41:04.947651 140578650728256 basic_session_run_hooks.py:260] loss = 0.006496609, step = 1700 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.61178
I0411 14:41:22.765990 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61178
INFO:tensorflow:loss = 0.0058936058, step = 1800 (17.820 sec)
I0411 14:41:22.767492 140578650728256 basic_session_run_hooks.py:260] loss = 0.0058936058, step = 1800 (17.820 sec)
INFO:tensorflow:global_step/sec: 5.60643
I0411 14:41:40.602490 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60643
INFO:tensorflow:loss = 0.0053706067, step = 1900 (17.836 sec)
I0411 14:41:40.603663 140578650728256 basic_session_run_hooks.py:260] loss = 0.0053706067, step = 1900 (17.836 sec)
INFO:tensorflow:Saving checkpoints for 2000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:41:58.226831 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 2000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48914
I0411 14:41:58.820091 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48914
INFO:tensorflow:loss = 0.0049131443, step = 2000 (18.217 sec)
I0411 14:41:58.820796 140578650728256 basic_session_run_hooks.py:260] loss = 0.0049131443, step = 2000 (18.217 sec)
INFO:tensorflow:global_step/sec: 5.60938
I0411 14:42:16.647764 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60938
INFO:tensorflow:loss = 0.004510016, step = 2100 (17.828 sec)
I0411 14:42:16.649075 140578650728256 basic_session_run_hooks.py:260] loss = 0.004510016, step = 2100 (17.828 sec)
INFO:tensorflow:global_step/sec: 5.60702
I0411 14:42:34.482491 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60702
INFO:tensorflow:loss = 0.004153289, step = 2200 (17.835 sec)
I0411 14:42:34.483775 140578650728256 basic_session_run_hooks.py:260] loss = 0.004153289, step = 2200 (17.835 sec)
INFO:tensorflow:global_step/sec: 5.61017
I0411 14:42:52.306918 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61017
INFO:tensorflow:loss = 0.0038337416, step = 2300 (17.824 sec)
I0411 14:42:52.307573 140578650728256 basic_session_run_hooks.py:260] loss = 0.0038337416, step = 2300 (17.824 sec)
INFO:tensorflow:global_step/sec: 5.61482
I0411 14:43:10.117165 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61482
INFO:tensorflow:loss = 0.0035437066, step = 2400 (17.811 sec)
I0411 14:43:10.118522 140578650728256 basic_session_run_hooks.py:260] loss = 0.0035437066, step = 2400 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.6082
I0411 14:43:27.948473 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6082
INFO:tensorflow:loss = 0.0032789037, step = 2500 (17.831 sec)
I0411 14:43:27.949707 140578650728256 basic_session_run_hooks.py:260] loss = 0.0032789037, step = 2500 (17.831 sec)
INFO:tensorflow:global_step/sec: 5.61609
I0411 14:43:45.754305 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61609
INFO:tensorflow:loss = 0.0030402367, step = 2600 (17.806 sec)
I0411 14:43:45.756004 140578650728256 basic_session_run_hooks.py:260] loss = 0.0030402367, step = 2600 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.60995
I0411 14:44:03.579588 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60995
INFO:tensorflow:loss = 0.0028280793, step = 2700 (17.825 sec)
I0411 14:44:03.580588 140578650728256 basic_session_run_hooks.py:260] loss = 0.0028280793, step = 2700 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.6169
I0411 14:44:21.382901 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6169
INFO:tensorflow:loss = 0.0026367973, step = 2800 (17.803 sec)
I0411 14:44:21.383714 140578650728256 basic_session_run_hooks.py:260] loss = 0.0026367973, step = 2800 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61149
I0411 14:44:39.203649 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61149
INFO:tensorflow:loss = 0.002462795, step = 2900 (17.821 sec)
I0411 14:44:39.204663 140578650728256 basic_session_run_hooks.py:260] loss = 0.002462795, step = 2900 (17.821 sec)
INFO:tensorflow:Saving checkpoints for 3000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:44:56.845392 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 3000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48788
I0411 14:44:57.425374 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48788
INFO:tensorflow:loss = 0.002303368, step = 3000 (18.221 sec)
I0411 14:44:57.426093 140578650728256 basic_session_run_hooks.py:260] loss = 0.002303368, step = 3000 (18.221 sec)
INFO:tensorflow:global_step/sec: 5.6106
I0411 14:45:15.249082 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6106
INFO:tensorflow:loss = 0.0021571147, step = 3100 (17.824 sec)
I0411 14:45:15.250379 140578650728256 basic_session_run_hooks.py:260] loss = 0.0021571147, step = 3100 (17.824 sec)
INFO:tensorflow:global_step/sec: 5.60859
I0411 14:45:33.078607 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60859
INFO:tensorflow:loss = 0.0020222524, step = 3200 (17.829 sec)
I0411 14:45:33.079401 140578650728256 basic_session_run_hooks.py:260] loss = 0.0020222524, step = 3200 (17.829 sec)
INFO:tensorflow:global_step/sec: 5.61053
I0411 14:45:50.902249 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61053
INFO:tensorflow:loss = 0.0018982562, step = 3300 (17.824 sec)
I0411 14:45:50.903443 140578650728256 basic_session_run_hooks.py:260] loss = 0.0018982562, step = 3300 (17.824 sec)
INFO:tensorflow:global_step/sec: 5.61734
I0411 14:46:08.704426 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61734
INFO:tensorflow:loss = 0.0017837456, step = 3400 (17.802 sec)
I0411 14:46:08.705805 140578650728256 basic_session_run_hooks.py:260] loss = 0.0017837456, step = 3400 (17.802 sec)
INFO:tensorflow:global_step/sec: 5.61514
I0411 14:46:26.513341 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61514
INFO:tensorflow:loss = 0.001677209, step = 3500 (17.808 sec)
I0411 14:46:26.514276 140578650728256 basic_session_run_hooks.py:260] loss = 0.001677209, step = 3500 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61064
I0411 14:46:44.336487 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61064
INFO:tensorflow:loss = 0.0015787685, step = 3600 (17.823 sec)
I0411 14:46:44.337229 140578650728256 basic_session_run_hooks.py:260] loss = 0.0015787685, step = 3600 (17.823 sec)
INFO:tensorflow:global_step/sec: 5.61447
I0411 14:47:02.147979 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61447
INFO:tensorflow:loss = 0.0014874876, step = 3700 (17.812 sec)
I0411 14:47:02.149195 140578650728256 basic_session_run_hooks.py:260] loss = 0.0014874876, step = 3700 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61218
I0411 14:47:19.965950 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61218
INFO:tensorflow:loss = 0.0014024735, step = 3800 (17.817 sec)
I0411 14:47:19.966601 140578650728256 basic_session_run_hooks.py:260] loss = 0.0014024735, step = 3800 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61017
I0411 14:47:37.791112 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61017
INFO:tensorflow:loss = 0.0013230795, step = 3900 (17.826 sec)
I0411 14:47:37.792677 140578650728256 basic_session_run_hooks.py:260] loss = 0.0013230795, step = 3900 (17.826 sec)
INFO:tensorflow:Saving checkpoints for 4000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:47:55.428398 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 4000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4902
I0411 14:47:56.004997 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4902
INFO:tensorflow:loss = 0.0012492302, step = 4000 (18.213 sec)
I0411 14:47:56.005663 140578650728256 basic_session_run_hooks.py:260] loss = 0.0012492302, step = 4000 (18.213 sec)
INFO:tensorflow:global_step/sec: 5.60845
I0411 14:48:13.835741 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60845
INFO:tensorflow:loss = 0.0011801189, step = 4100 (17.831 sec)
I0411 14:48:13.836919 140578650728256 basic_session_run_hooks.py:260] loss = 0.0011801189, step = 4100 (17.831 sec)
INFO:tensorflow:global_step/sec: 5.6095
I0411 14:48:31.662649 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6095
INFO:tensorflow:loss = 0.0011154262, step = 4200 (17.827 sec)
I0411 14:48:31.664198 140578650728256 basic_session_run_hooks.py:260] loss = 0.0011154262, step = 4200 (17.827 sec)
INFO:tensorflow:global_step/sec: 5.61157
I0411 14:48:49.482585 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61157
INFO:tensorflow:loss = 0.0010550574, step = 4300 (17.819 sec)
I0411 14:48:49.483347 140578650728256 basic_session_run_hooks.py:260] loss = 0.0010550574, step = 4300 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61168
I0411 14:49:07.302815 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61168
INFO:tensorflow:loss = 0.0009982826, step = 4400 (17.821 sec)
I0411 14:49:07.304017 140578650728256 basic_session_run_hooks.py:260] loss = 0.0009982826, step = 4400 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61337
I0411 14:49:25.117410 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61337
INFO:tensorflow:loss = 0.00094527943, step = 4500 (17.814 sec)
I0411 14:49:25.118422 140578650728256 basic_session_run_hooks.py:260] loss = 0.00094527943, step = 4500 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.61113
I0411 14:49:42.938729 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61113
INFO:tensorflow:loss = 0.0008951995, step = 4600 (17.821 sec)
I0411 14:49:42.939316 140578650728256 basic_session_run_hooks.py:260] loss = 0.0008951995, step = 4600 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61573
I0411 14:50:00.746195 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61573
INFO:tensorflow:loss = 0.00084841566, step = 4700 (17.808 sec)
I0411 14:50:00.747235 140578650728256 basic_session_run_hooks.py:260] loss = 0.00084841566, step = 4700 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.60735
I0411 14:50:18.579714 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60735
INFO:tensorflow:loss = 0.00080420147, step = 4800 (17.833 sec)
I0411 14:50:18.580505 140578650728256 basic_session_run_hooks.py:260] loss = 0.00080420147, step = 4800 (17.833 sec)
INFO:tensorflow:global_step/sec: 5.61698
I0411 14:50:36.383322 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61698
INFO:tensorflow:loss = 0.0007626625, step = 4900 (17.804 sec)
I0411 14:50:36.384861 140578650728256 basic_session_run_hooks.py:260] loss = 0.0007626625, step = 4900 (17.804 sec)
INFO:tensorflow:Saving checkpoints for 5000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:50:54.017725 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 5000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:960: remove_check            point (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
W0411 14:50:54.078399 140578650728256 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:960: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and wil            l be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
INFO:tensorflow:global_step/sec: 5.48298
I0411 14:50:54.621033 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48298
INFO:tensorflow:loss = 0.0007232824, step = 5000 (18.237 sec)
I0411 14:50:54.621639 140578650728256 basic_session_run_hooks.py:260] loss = 0.0007232824, step = 5000 (18.237 sec)
INFO:tensorflow:global_step/sec: 5.61175
I0411 14:51:12.441108 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61175
INFO:tensorflow:loss = 0.0006864513, step = 5100 (17.821 sec)
I0411 14:51:12.442261 140578650728256 basic_session_run_hooks.py:260] loss = 0.0006864513, step = 5100 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61052
I0411 14:51:30.265002 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61052
INFO:tensorflow:loss = 0.0006514328, step = 5200 (17.824 sec)
I0411 14:51:30.266572 140578650728256 basic_session_run_hooks.py:260] loss = 0.0006514328, step = 5200 (17.824 sec)
INFO:tensorflow:global_step/sec: 5.61312
I0411 14:51:48.080346 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61312
INFO:tensorflow:loss = 0.000618652, step = 5300 (17.815 sec)
I0411 14:51:48.081450 140578650728256 basic_session_run_hooks.py:260] loss = 0.000618652, step = 5300 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61652
I0411 14:52:05.885004 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61652
INFO:tensorflow:loss = 0.0005875296, step = 5400 (17.805 sec)
I0411 14:52:05.886173 140578650728256 basic_session_run_hooks.py:260] loss = 0.0005875296, step = 5400 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.60958
I0411 14:52:23.711668 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60958
INFO:tensorflow:loss = 0.0005582158, step = 5500 (17.827 sec)
I0411 14:52:23.712750 140578650728256 basic_session_run_hooks.py:260] loss = 0.0005582158, step = 5500 (17.827 sec)
INFO:tensorflow:global_step/sec: 5.61234
I0411 14:52:41.529036 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61234
INFO:tensorflow:loss = 0.0005303202, step = 5600 (17.817 sec)
I0411 14:52:41.529744 140578650728256 basic_session_run_hooks.py:260] loss = 0.0005303202, step = 5600 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61017
I0411 14:52:59.353982 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61017
INFO:tensorflow:loss = 0.00050402817, step = 5700 (17.825 sec)
I0411 14:52:59.354954 140578650728256 basic_session_run_hooks.py:260] loss = 0.00050402817, step = 5700 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.6128
I0411 14:53:17.170307 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6128
INFO:tensorflow:loss = 0.00047912984, step = 5800 (17.816 sec)
I0411 14:53:17.171134 140578650728256 basic_session_run_hooks.py:260] loss = 0.00047912984, step = 5800 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61095
I0411 14:53:34.992707 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61095
INFO:tensorflow:loss = 0.0004555956, step = 5900 (17.822 sec)
I0411 14:53:34.993653 140578650728256 basic_session_run_hooks.py:260] loss = 0.0004555956, step = 5900 (17.822 sec)
INFO:tensorflow:Saving checkpoints for 6000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:53:52.632007 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 6000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47101
I0411 14:53:53.270716 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.47101
INFO:tensorflow:loss = 0.0004331658, step = 6000 (18.278 sec)
I0411 14:53:53.271344 140578650728256 basic_session_run_hooks.py:260] loss = 0.0004331658, step = 6000 (18.278 sec)
INFO:tensorflow:global_step/sec: 5.62036
I0411 14:54:11.063461 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62036
INFO:tensorflow:loss = 0.00041190616, step = 6100 (17.793 sec)
I0411 14:54:11.064473 140578650728256 basic_session_run_hooks.py:260] loss = 0.00041190616, step = 6100 (17.793 sec)
INFO:tensorflow:global_step/sec: 5.61532
I0411 14:54:28.871636 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61532
INFO:tensorflow:loss = 0.00039191966, step = 6200 (17.808 sec)
I0411 14:54:28.872391 140578650728256 basic_session_run_hooks.py:260] loss = 0.00039191966, step = 6200 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61564
I0411 14:54:46.679286 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61564
INFO:tensorflow:loss = 0.0003727473, step = 6300 (17.808 sec)
I0411 14:54:46.680503 140578650728256 basic_session_run_hooks.py:260] loss = 0.0003727473, step = 6300 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61671
I0411 14:55:04.482947 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61671
INFO:tensorflow:loss = 0.0003546946, step = 6400 (17.803 sec)
I0411 14:55:04.483534 140578650728256 basic_session_run_hooks.py:260] loss = 0.0003546946, step = 6400 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61758
I0411 14:55:22.284308 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61758
INFO:tensorflow:loss = 0.0003375954, step = 6500 (17.802 sec)
I0411 14:55:22.285210 140578650728256 basic_session_run_hooks.py:260] loss = 0.0003375954, step = 6500 (17.802 sec)
INFO:tensorflow:global_step/sec: 5.61078
I0411 14:55:40.107235 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61078
INFO:tensorflow:loss = 0.00032108848, step = 6600 (17.823 sec)
I0411 14:55:40.108307 140578650728256 basic_session_run_hooks.py:260] loss = 0.00032108848, step = 6600 (17.823 sec)
INFO:tensorflow:global_step/sec: 5.61886
I0411 14:55:57.904310 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61886
INFO:tensorflow:loss = 0.00030563152, step = 6700 (17.797 sec)
I0411 14:55:57.905043 140578650728256 basic_session_run_hooks.py:260] loss = 0.00030563152, step = 6700 (17.797 sec)
INFO:tensorflow:global_step/sec: 5.61778
I0411 14:56:15.705235 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61778
INFO:tensorflow:loss = 0.0002908302, step = 6800 (17.801 sec)
I0411 14:56:15.706368 140578650728256 basic_session_run_hooks.py:260] loss = 0.0002908302, step = 6800 (17.801 sec)
INFO:tensorflow:global_step/sec: 5.61188
I0411 14:56:33.524282 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61188
INFO:tensorflow:loss = 0.00027689323, step = 6900 (17.819 sec)
I0411 14:56:33.525153 140578650728256 basic_session_run_hooks.py:260] loss = 0.00027689323, step = 6900 (17.819 sec)
INFO:tensorflow:Saving checkpoints for 7000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:56:51.145768 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 7000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4872
I0411 14:56:51.748492 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4872
INFO:tensorflow:loss = 0.0002635002, step = 7000 (18.224 sec)
I0411 14:56:51.749164 140578650728256 basic_session_run_hooks.py:260] loss = 0.0002635002, step = 7000 (18.224 sec)
INFO:tensorflow:global_step/sec: 5.61532
I0411 14:57:09.556937 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61532
INFO:tensorflow:loss = 0.00025086076, step = 7100 (17.809 sec)
I0411 14:57:09.557845 140578650728256 basic_session_run_hooks.py:260] loss = 0.00025086076, step = 7100 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61751
I0411 14:57:27.358825 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61751
INFO:tensorflow:loss = 0.00023864713, step = 7200 (17.802 sec)
I0411 14:57:27.359877 140578650728256 basic_session_run_hooks.py:260] loss = 0.00023864713, step = 7200 (17.802 sec)
INFO:tensorflow:global_step/sec: 5.61133
I0411 14:57:45.180118 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61133
INFO:tensorflow:loss = 0.0002271815, step = 7300 (17.822 sec)
I0411 14:57:45.181656 140578650728256 basic_session_run_hooks.py:260] loss = 0.0002271815, step = 7300 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.60996
I0411 14:58:03.005331 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60996
INFO:tensorflow:loss = 0.0002162907, step = 7400 (17.825 sec)
I0411 14:58:03.006297 140578650728256 basic_session_run_hooks.py:260] loss = 0.0002162907, step = 7400 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.61043
I0411 14:58:20.828901 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61043
INFO:tensorflow:loss = 0.00020588584, step = 7500 (17.823 sec)
I0411 14:58:20.829723 140578650728256 basic_session_run_hooks.py:260] loss = 0.00020588584, step = 7500 (17.823 sec)
INFO:tensorflow:global_step/sec: 5.61346
I0411 14:58:38.643337 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61346
INFO:tensorflow:loss = 0.00019603677, step = 7600 (17.815 sec)
I0411 14:58:38.644258 140578650728256 basic_session_run_hooks.py:260] loss = 0.00019603677, step = 7600 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61293
I0411 14:58:56.459218 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61293
INFO:tensorflow:loss = 0.0001865605, step = 7700 (17.816 sec)
I0411 14:58:56.459995 140578650728256 basic_session_run_hooks.py:260] loss = 0.0001865605, step = 7700 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61228
I0411 14:59:14.277260 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61228
INFO:tensorflow:loss = 0.00017772013, step = 7800 (17.818 sec)
I0411 14:59:14.277887 140578650728256 basic_session_run_hooks.py:260] loss = 0.00017772013, step = 7800 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61249
I0411 14:59:32.094915 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61249
INFO:tensorflow:loss = 0.00016919302, step = 7900 (17.818 sec)
I0411 14:59:32.095981 140578650728256 basic_session_run_hooks.py:260] loss = 0.00016919302, step = 7900 (17.818 sec)
INFO:tensorflow:Saving checkpoints for 8000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 14:59:49.722207 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 8000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48957
I0411 14:59:50.311036 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48957
INFO:tensorflow:loss = 0.00016096476, step = 8000 (18.216 sec)
I0411 14:59:50.311725 140578650728256 basic_session_run_hooks.py:260] loss = 0.00016096476, step = 8000 (18.216 sec)
INFO:tensorflow:global_step/sec: 5.61005
I0411 15:00:08.136098 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61005
INFO:tensorflow:loss = 0.00015331374, step = 8100 (17.825 sec)
I0411 15:00:08.136711 140578650728256 basic_session_run_hooks.py:260] loss = 0.00015331374, step = 8100 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.616
I0411 15:00:25.942852 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.616
INFO:tensorflow:loss = 0.00014596718, step = 8200 (17.807 sec)
I0411 15:00:25.944102 140578650728256 basic_session_run_hooks.py:260] loss = 0.00014596718, step = 8200 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.61532
I0411 15:00:43.750861 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61532
INFO:tensorflow:loss = 0.00013884544, step = 8300 (17.808 sec)
I0411 15:00:43.751633 140578650728256 basic_session_run_hooks.py:260] loss = 0.00013884544, step = 8300 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61483
I0411 15:01:01.561224 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61483
INFO:tensorflow:loss = 0.00013212825, step = 8400 (17.811 sec)
I0411 15:01:01.562331 140578650728256 basic_session_run_hooks.py:260] loss = 0.00013212825, step = 8400 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61006
I0411 15:01:19.385976 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61006
INFO:tensorflow:loss = 0.00012585055, step = 8500 (17.825 sec)
I0411 15:01:19.386851 140578650728256 basic_session_run_hooks.py:260] loss = 0.00012585055, step = 8500 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.61592
I0411 15:01:37.192852 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61592
INFO:tensorflow:loss = 0.000119768825, step = 8600 (17.807 sec)
I0411 15:01:37.193876 140578650728256 basic_session_run_hooks.py:260] loss = 0.000119768825, step = 8600 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.61626
I0411 15:01:54.997944 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61626
INFO:tensorflow:loss = 0.0001139548, step = 8700 (17.805 sec)
I0411 15:01:54.998777 140578650728256 basic_session_run_hooks.py:260] loss = 0.0001139548, step = 8700 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61256
I0411 15:02:12.815302 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61256
INFO:tensorflow:loss = 0.0001085635, step = 8800 (17.818 sec)
I0411 15:02:12.816530 140578650728256 basic_session_run_hooks.py:260] loss = 0.0001085635, step = 8800 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61323
I0411 15:02:30.630206 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61323
INFO:tensorflow:loss = 0.0001032071, step = 8900 (17.815 sec)
I0411 15:02:30.631123 140578650728256 basic_session_run_hooks.py:260] loss = 0.0001032071, step = 8900 (17.815 sec)
INFO:tensorflow:Saving checkpoints for 9000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:02:48.270145 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 9000 into ~/BERT4Rec/yelp_ber            t-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49029
I0411 15:02:48.844114 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49029
INFO:tensorflow:loss = 9.817567e-05, step = 9000 (18.214 sec)
I0411 15:02:48.844809 140578650728256 basic_session_run_hooks.py:260] loss = 9.817567e-05, step = 9000 (18.214 sec)
INFO:tensorflow:global_step/sec: 5.61467
I0411 15:03:06.654637 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61467
INFO:tensorflow:loss = 9.346596e-05, step = 9100 (17.810 sec)
I0411 15:03:06.655259 140578650728256 basic_session_run_hooks.py:260] loss = 9.346596e-05, step = 9100 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.61444
I0411 15:03:24.465711 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61444
INFO:tensorflow:loss = 8.901464e-05, step = 9200 (17.811 sec)
I0411 15:03:24.466233 140578650728256 basic_session_run_hooks.py:260] loss = 8.901464e-05, step = 9200 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61621
I0411 15:03:42.271466 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61621
INFO:tensorflow:loss = 8.469601e-05, step = 9300 (17.806 sec)
I0411 15:03:42.272239 140578650728256 basic_session_run_hooks.py:260] loss = 8.469601e-05, step = 9300 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.61336
I0411 15:04:00.086265 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61336
INFO:tensorflow:loss = 8.073356e-05, step = 9400 (17.815 sec)
I0411 15:04:00.087239 140578650728256 basic_session_run_hooks.py:260] loss = 8.073356e-05, step = 9400 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61423
I0411 15:04:17.898112 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61423
INFO:tensorflow:loss = 7.67101e-05, step = 9500 (17.812 sec)
I0411 15:04:17.898976 140578650728256 basic_session_run_hooks.py:260] loss = 7.67101e-05, step = 9500 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61391
I0411 15:04:35.711313 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61391
INFO:tensorflow:loss = 7.307169e-05, step = 9600 (17.814 sec)
I0411 15:04:35.713166 140578650728256 basic_session_run_hooks.py:260] loss = 7.307169e-05, step = 9600 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.61231
I0411 15:04:53.528785 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61231
INFO:tensorflow:loss = 6.9298716e-05, step = 9700 (17.816 sec)
I0411 15:04:53.529439 140578650728256 basic_session_run_hooks.py:260] loss = 6.9298716e-05, step = 9700 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.6133
I0411 15:05:11.343975 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6133
INFO:tensorflow:loss = 6.6023465e-05, step = 9800 (17.816 sec)
I0411 15:05:11.344998 140578650728256 basic_session_run_hooks.py:260] loss = 6.6023465e-05, step = 9800 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61582
I0411 15:05:29.150575 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61582
INFO:tensorflow:loss = 6.271748e-05, step = 9900 (17.807 sec)
I0411 15:05:29.152138 140578650728256 basic_session_run_hooks.py:260] loss = 6.271748e-05, step = 9900 (17.807 sec)
INFO:tensorflow:Saving checkpoints for 10000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:05:46.789298 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 10000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48792
I0411 15:05:47.372301 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48792
INFO:tensorflow:loss = 5.9747683e-05, step = 10000 (18.221 sec)
I0411 15:05:47.372978 140578650728256 basic_session_run_hooks.py:260] loss = 5.9747683e-05, step = 10000 (18.221 sec)
INFO:tensorflow:global_step/sec: 5.61458
I0411 15:06:05.183282 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61458
INFO:tensorflow:loss = 5.677833e-05, step = 10100 (17.811 sec)
I0411 15:06:05.184486 140578650728256 basic_session_run_hooks.py:260] loss = 5.677833e-05, step = 10100 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61664
I0411 15:06:22.987359 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61664
INFO:tensorflow:loss = 5.3950993e-05, step = 10200 (17.804 sec)
I0411 15:06:22.988235 140578650728256 basic_session_run_hooks.py:260] loss = 5.3950993e-05, step = 10200 (17.804 sec)
INFO:tensorflow:global_step/sec: 5.61006
I0411 15:06:40.812640 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61006
INFO:tensorflow:loss = 5.1329458e-05, step = 10300 (17.826 sec)
I0411 15:06:40.813797 140578650728256 basic_session_run_hooks.py:260] loss = 5.1329458e-05, step = 10300 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.61327
I0411 15:06:58.627309 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61327
INFO:tensorflow:loss = 4.8995684e-05, step = 10400 (17.814 sec)
I0411 15:06:58.627962 140578650728256 basic_session_run_hooks.py:260] loss = 4.8995684e-05, step = 10400 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.62305
I0411 15:07:16.411342 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62305
INFO:tensorflow:loss = 4.637739e-05, step = 10500 (17.784 sec)
I0411 15:07:16.412114 140578650728256 basic_session_run_hooks.py:260] loss = 4.637739e-05, step = 10500 (17.784 sec)
INFO:tensorflow:global_step/sec: 5.61868
I0411 15:07:34.209045 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61868
INFO:tensorflow:loss = 4.4233584e-05, step = 10600 (17.798 sec)
I0411 15:07:34.209621 140578650728256 basic_session_run_hooks.py:260] loss = 4.4233584e-05, step = 10600 (17.798 sec)
INFO:tensorflow:global_step/sec: 5.61522
I0411 15:07:52.017800 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61522
INFO:tensorflow:loss = 4.2161944e-05, step = 10700 (17.809 sec)
I0411 15:07:52.018440 140578650728256 basic_session_run_hooks.py:260] loss = 4.2161944e-05, step = 10700 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.617
I0411 15:08:09.821011 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.617
INFO:tensorflow:loss = 4.00009e-05, step = 10800 (17.803 sec)
I0411 15:08:09.821958 140578650728256 basic_session_run_hooks.py:260] loss = 4.00009e-05, step = 10800 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.6143
I0411 15:08:27.632706 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6143
INFO:tensorflow:loss = 3.8030295e-05, step = 10900 (17.812 sec)
I0411 15:08:27.633554 140578650728256 basic_session_run_hooks.py:260] loss = 3.8030295e-05, step = 10900 (17.812 sec)
INFO:tensorflow:Saving checkpoints for 11000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:08:45.265577 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 11000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49523
I0411 15:08:45.830148 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49523
INFO:tensorflow:loss = 3.6147238e-05, step = 11000 (18.197 sec)
I0411 15:08:45.830681 140578650728256 basic_session_run_hooks.py:260] loss = 3.6147238e-05, step = 11000 (18.197 sec)
INFO:tensorflow:global_step/sec: 5.61111
I0411 15:09:03.652219 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61111
INFO:tensorflow:loss = 3.443878e-05, step = 11100 (17.823 sec)
I0411 15:09:03.653272 140578650728256 basic_session_run_hooks.py:260] loss = 3.443878e-05, step = 11100 (17.823 sec)
INFO:tensorflow:global_step/sec: 5.61393
I0411 15:09:21.464860 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61393
INFO:tensorflow:loss = 3.257527e-05, step = 11200 (17.812 sec)
I0411 15:09:21.465695 140578650728256 basic_session_run_hooks.py:260] loss = 3.257527e-05, step = 11200 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.60771
I0411 15:09:39.297775 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60771
INFO:tensorflow:loss = 3.099673e-05, step = 11300 (17.833 sec)
I0411 15:09:39.298957 140578650728256 basic_session_run_hooks.py:260] loss = 3.099673e-05, step = 11300 (17.833 sec)
INFO:tensorflow:global_step/sec: 5.6095
I0411 15:09:57.124573 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6095
INFO:tensorflow:loss = 2.9726913e-05, step = 11400 (17.827 sec)
I0411 15:09:57.125895 140578650728256 basic_session_run_hooks.py:260] loss = 2.9726913e-05, step = 11400 (17.827 sec)
INFO:tensorflow:global_step/sec: 5.61228
I0411 15:10:14.942735 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61228
INFO:tensorflow:loss = 2.8042195e-05, step = 11500 (17.818 sec)
I0411 15:10:14.944230 140578650728256 basic_session_run_hooks.py:260] loss = 2.8042195e-05, step = 11500 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61472
I0411 15:10:32.752698 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61472
INFO:tensorflow:loss = 2.692324e-05, step = 11600 (17.809 sec)
I0411 15:10:32.753446 140578650728256 basic_session_run_hooks.py:260] loss = 2.692324e-05, step = 11600 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61348
I0411 15:10:50.567085 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61348
INFO:tensorflow:loss = 2.5280431e-05, step = 11700 (17.814 sec)
I0411 15:10:50.567904 140578650728256 basic_session_run_hooks.py:260] loss = 2.5280431e-05, step = 11700 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.61526
I0411 15:11:08.375836 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61526
INFO:tensorflow:loss = 2.4120032e-05, step = 11800 (17.809 sec)
I0411 15:11:08.376858 140578650728256 basic_session_run_hooks.py:260] loss = 2.4120032e-05, step = 11800 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61715
I0411 15:11:26.178197 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61715
INFO:tensorflow:loss = 2.300713e-05, step = 11900 (17.802 sec)
I0411 15:11:26.178897 140578650728256 basic_session_run_hooks.py:260] loss = 2.300713e-05, step = 11900 (17.802 sec)
INFO:tensorflow:Saving checkpoints for 12000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:11:43.814579 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 12000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48646
I0411 15:11:44.404890 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48646
INFO:tensorflow:loss = 2.193846e-05, step = 12000 (18.227 sec)
I0411 15:11:44.405464 140578650728256 basic_session_run_hooks.py:260] loss = 2.193846e-05, step = 12000 (18.227 sec)
INFO:tensorflow:global_step/sec: 5.61264
I0411 15:12:02.221880 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61264
INFO:tensorflow:loss = 2.0717056e-05, step = 12100 (17.817 sec)
I0411 15:12:02.222697 140578650728256 basic_session_run_hooks.py:260] loss = 2.0717056e-05, step = 12100 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61414
I0411 15:12:20.033988 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61414
INFO:tensorflow:loss = 1.9521261e-05, step = 12200 (17.812 sec)
I0411 15:12:20.034628 140578650728256 basic_session_run_hooks.py:260] loss = 1.9521261e-05, step = 12200 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61114
I0411 15:12:37.855922 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61114
INFO:tensorflow:loss = 1.848984e-05, step = 12300 (17.822 sec)
I0411 15:12:37.857064 140578650728256 basic_session_run_hooks.py:260] loss = 1.848984e-05, step = 12300 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.6154
I0411 15:12:55.664289 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6154
INFO:tensorflow:loss = 1.7558072e-05, step = 12400 (17.809 sec)
I0411 15:12:55.665723 140578650728256 basic_session_run_hooks.py:260] loss = 1.7558072e-05, step = 12400 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61223
I0411 15:13:13.482377 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61223
INFO:tensorflow:loss = 1.6915932e-05, step = 12500 (17.818 sec)
I0411 15:13:13.483714 140578650728256 basic_session_run_hooks.py:260] loss = 1.6915932e-05, step = 12500 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61276
I0411 15:13:31.298632 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61276
INFO:tensorflow:loss = 1.6096385e-05, step = 12600 (17.816 sec)
I0411 15:13:31.299454 140578650728256 basic_session_run_hooks.py:260] loss = 1.6096385e-05, step = 12600 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.6053
I0411 15:13:49.138893 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6053
INFO:tensorflow:loss = 1.5261467e-05, step = 12700 (17.840 sec)
I0411 15:13:49.139507 140578650728256 basic_session_run_hooks.py:260] loss = 1.5261467e-05, step = 12700 (17.840 sec)
INFO:tensorflow:global_step/sec: 5.60633
I0411 15:14:06.976157 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60633
INFO:tensorflow:loss = 1.4520147e-05, step = 12800 (17.838 sec)
I0411 15:14:06.977499 140578650728256 basic_session_run_hooks.py:260] loss = 1.4520147e-05, step = 12800 (17.838 sec)
INFO:tensorflow:global_step/sec: 5.60786
I0411 15:14:24.808008 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60786
INFO:tensorflow:loss = 1.3708974e-05, step = 12900 (17.831 sec)
I0411 15:14:24.808789 140578650728256 basic_session_run_hooks.py:260] loss = 1.3708974e-05, step = 12900 (17.831 sec)
INFO:tensorflow:Saving checkpoints for 13000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:14:42.437580 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 13000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49277
I0411 15:14:43.013648 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49277
INFO:tensorflow:loss = 1.3232144e-05, step = 13000 (18.205 sec)
I0411 15:14:43.014072 140578650728256 basic_session_run_hooks.py:260] loss = 1.3232144e-05, step = 13000 (18.205 sec)
INFO:tensorflow:global_step/sec: 5.61242
I0411 15:15:00.831725 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61242
INFO:tensorflow:loss = 1.23976915e-05, step = 13100 (17.819 sec)
I0411 15:15:00.832921 140578650728256 basic_session_run_hooks.py:260] loss = 1.23976915e-05, step = 13100 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61085
I0411 15:15:18.654159 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61085
INFO:tensorflow:loss = 1.1706191e-05, step = 13200 (17.822 sec)
I0411 15:15:18.655254 140578650728256 basic_session_run_hooks.py:260] loss = 1.1706191e-05, step = 13200 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.6108
I0411 15:15:36.476743 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6108
INFO:tensorflow:loss = 1.1326215e-05, step = 13300 (17.822 sec)
I0411 15:15:36.477388 140578650728256 basic_session_run_hooks.py:260] loss = 1.1326215e-05, step = 13300 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.61216
I0411 15:15:54.295399 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61216
INFO:tensorflow:loss = 1.060957e-05, step = 13400 (17.819 sec)
I0411 15:15:54.296388 140578650728256 basic_session_run_hooks.py:260] loss = 1.060957e-05, step = 13400 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61523
I0411 15:16:12.103931 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61523
INFO:tensorflow:loss = 1.0259862e-05, step = 13500 (17.808 sec)
I0411 15:16:12.104774 140578650728256 basic_session_run_hooks.py:260] loss = 1.0259862e-05, step = 13500 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.60941
I0411 15:16:29.931252 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60941
INFO:tensorflow:loss = 9.542752e-06, step = 13600 (17.827 sec)
I0411 15:16:29.932172 140578650728256 basic_session_run_hooks.py:260] loss = 9.542752e-06, step = 13600 (17.827 sec)
INFO:tensorflow:global_step/sec: 5.61591
I0411 15:16:47.737839 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61591
INFO:tensorflow:loss = 9.039376e-06, step = 13700 (17.807 sec)
I0411 15:16:47.738750 140578650728256 basic_session_run_hooks.py:260] loss = 9.039376e-06, step = 13700 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.61172
I0411 15:17:05.557426 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61172
INFO:tensorflow:loss = 8.69479e-06, step = 13800 (17.819 sec)
I0411 15:17:05.558088 140578650728256 basic_session_run_hooks.py:260] loss = 8.69479e-06, step = 13800 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61997
I0411 15:17:23.351147 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61997
INFO:tensorflow:loss = 8.345545e-06, step = 13900 (17.794 sec)
I0411 15:17:23.352104 140578650728256 basic_session_run_hooks.py:260] loss = 8.345545e-06, step = 13900 (17.794 sec)
INFO:tensorflow:Saving checkpoints for 14000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:17:40.996603 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 14000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48242
I0411 15:17:41.591273 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48242
INFO:tensorflow:loss = 7.7490395e-06, step = 14000 (18.240 sec)
I0411 15:17:41.591903 140578650728256 basic_session_run_hooks.py:260] loss = 7.7490395e-06, step = 14000 (18.240 sec)
INFO:tensorflow:global_step/sec: 5.61273
I0411 15:17:59.407927 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61273
INFO:tensorflow:loss = 7.6084107e-06, step = 14100 (17.817 sec)
I0411 15:17:59.408518 140578650728256 basic_session_run_hooks.py:260] loss = 7.6084107e-06, step = 14100 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61474
I0411 15:18:17.218182 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61474
INFO:tensorflow:loss = 6.9141142e-06, step = 14200 (17.810 sec)
I0411 15:18:17.218977 140578650728256 basic_session_run_hooks.py:260] loss = 6.9141142e-06, step = 14200 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.61003
I0411 15:18:35.043632 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61003
INFO:tensorflow:loss = 6.68408e-06, step = 14300 (17.826 sec)
I0411 15:18:35.044620 140578650728256 basic_session_run_hooks.py:260] loss = 6.68408e-06, step = 14300 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.61423
I0411 15:18:52.855255 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61423
INFO:tensorflow:loss = 6.4372803e-06, step = 14400 (17.811 sec)
I0411 15:18:52.856089 140578650728256 basic_session_run_hooks.py:260] loss = 6.4372803e-06, step = 14400 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.60966
I0411 15:19:10.681817 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60966
INFO:tensorflow:loss = 5.9604463e-06, step = 14500 (17.827 sec)
I0411 15:19:10.682989 140578650728256 basic_session_run_hooks.py:260] loss = 5.9604463e-06, step = 14500 (17.827 sec)
INFO:tensorflow:global_step/sec: 5.61083
I0411 15:19:28.504350 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61083
INFO:tensorflow:loss = 5.7327397e-06, step = 14600 (17.822 sec)
I0411 15:19:28.505177 140578650728256 basic_session_run_hooks.py:260] loss = 5.7327397e-06, step = 14600 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.61624
I0411 15:19:46.309952 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61624
INFO:tensorflow:loss = 5.4859406e-06, step = 14700 (17.806 sec)
I0411 15:19:46.310976 140578650728256 basic_session_run_hooks.py:260] loss = 5.4859406e-06, step = 14700 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.60509
I0411 15:20:04.150770 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60509
INFO:tensorflow:loss = 5.0067774e-06, step = 14800 (17.841 sec)
I0411 15:20:04.151634 140578650728256 basic_session_run_hooks.py:260] loss = 5.0067774e-06, step = 14800 (17.841 sec)
INFO:tensorflow:global_step/sec: 5.61119
I0411 15:20:21.972573 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61119
INFO:tensorflow:loss = 4.88757e-06, step = 14900 (17.822 sec)
I0411 15:20:21.973606 140578650728256 basic_session_run_hooks.py:260] loss = 4.88757e-06, step = 14900 (17.822 sec)
INFO:tensorflow:Saving checkpoints for 15000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:20:39.613574 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 15000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48089
I0411 15:20:40.217406 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48089
INFO:tensorflow:loss = 4.6491514e-06, step = 15000 (18.244 sec)
I0411 15:20:40.217997 140578650728256 basic_session_run_hooks.py:260] loss = 4.6491514e-06, step = 15000 (18.244 sec)
INFO:tensorflow:global_step/sec: 5.61178
I0411 15:20:58.037100 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61178
INFO:tensorflow:loss = 4.529943e-06, step = 15100 (17.820 sec)
I0411 15:20:58.037703 140578650728256 basic_session_run_hooks.py:260] loss = 4.529943e-06, step = 15100 (17.820 sec)
INFO:tensorflow:global_step/sec: 5.61283
I0411 15:21:15.853427 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61283
INFO:tensorflow:loss = 4.053108e-06, step = 15200 (17.816 sec)
I0411 15:21:15.854063 140578650728256 basic_session_run_hooks.py:260] loss = 4.053108e-06, step = 15200 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61497
I0411 15:21:33.663345 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61497
INFO:tensorflow:loss = 3.933899e-06, step = 15300 (17.810 sec)
I0411 15:21:33.664402 140578650728256 basic_session_run_hooks.py:260] loss = 3.933899e-06, step = 15300 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.6139
I0411 15:21:51.475955 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6139
INFO:tensorflow:loss = 3.699672e-06, step = 15400 (17.812 sec)
I0411 15:21:51.476782 140578650728256 basic_session_run_hooks.py:260] loss = 3.699672e-06, step = 15400 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61429
I0411 15:22:09.287846 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61429
INFO:tensorflow:loss = 3.6954812e-06, step = 15500 (17.812 sec)
I0411 15:22:09.288952 140578650728256 basic_session_run_hooks.py:260] loss = 3.6954812e-06, step = 15500 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61727
I0411 15:22:27.089752 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61727
INFO:tensorflow:loss = 3.5762719e-06, step = 15600 (17.801 sec)
I0411 15:22:27.090225 140578650728256 basic_session_run_hooks.py:260] loss = 3.5762719e-06, step = 15600 (17.801 sec)
INFO:tensorflow:global_step/sec: 5.61124
I0411 15:22:44.911388 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61124
INFO:tensorflow:loss = 3.0994365e-06, step = 15700 (17.822 sec)
I0411 15:22:44.912376 140578650728256 basic_session_run_hooks.py:260] loss = 3.0994365e-06, step = 15700 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.61272
I0411 15:23:02.727915 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61272
INFO:tensorflow:loss = 3.0994365e-06, step = 15800 (17.816 sec)
I0411 15:23:02.728731 140578650728256 basic_session_run_hooks.py:260] loss = 3.0994365e-06, step = 15800 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61209
I0411 15:23:20.546592 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61209
INFO:tensorflow:loss = 2.861019e-06, step = 15900 (17.819 sec)
I0411 15:23:20.547679 140578650728256 basic_session_run_hooks.py:260] loss = 2.861019e-06, step = 15900 (17.819 sec)
INFO:tensorflow:Saving checkpoints for 16000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:23:38.178264 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 16000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49056
I0411 15:23:38.759659 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49056
INFO:tensorflow:loss = 2.7418098e-06, step = 16000 (18.213 sec)
I0411 15:23:38.760369 140578650728256 basic_session_run_hooks.py:260] loss = 2.7418098e-06, step = 16000 (18.213 sec)
INFO:tensorflow:global_step/sec: 5.61533
I0411 15:23:56.568075 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61533
INFO:tensorflow:loss = 2.7418098e-06, step = 16100 (17.809 sec)
I0411 15:23:56.568913 140578650728256 basic_session_run_hooks.py:260] loss = 2.7418098e-06, step = 16100 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61326
I0411 15:24:14.383015 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61326
INFO:tensorflow:loss = 2.622601e-06, step = 16200 (17.815 sec)
I0411 15:24:14.384098 140578650728256 basic_session_run_hooks.py:260] loss = 2.622601e-06, step = 16200 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.60732
I0411 15:24:32.217182 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60732
INFO:tensorflow:loss = 2.622601e-06, step = 16300 (17.834 sec)
I0411 15:24:32.218188 140578650728256 basic_session_run_hooks.py:260] loss = 2.622601e-06, step = 16300 (17.834 sec)
INFO:tensorflow:global_step/sec: 5.60978
I0411 15:24:50.042876 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60978
INFO:tensorflow:loss = 2.145765e-06, step = 16400 (17.826 sec)
I0411 15:24:50.043782 140578650728256 basic_session_run_hooks.py:260] loss = 2.145765e-06, step = 16400 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.60999
I0411 15:25:07.868596 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60999
INFO:tensorflow:loss = 2.145765e-06, step = 16500 (17.826 sec)
I0411 15:25:07.869695 140578650728256 basic_session_run_hooks.py:260] loss = 2.145765e-06, step = 16500 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.61468
I0411 15:25:25.678726 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61468
INFO:tensorflow:loss = 1.9073469e-06, step = 16600 (17.810 sec)
I0411 15:25:25.679611 140578650728256 basic_session_run_hooks.py:260] loss = 1.9073469e-06, step = 16600 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.61794
I0411 15:25:43.479211 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61794
INFO:tensorflow:loss = 1.9073469e-06, step = 16700 (17.801 sec)
I0411 15:25:43.480746 140578650728256 basic_session_run_hooks.py:260] loss = 1.9073469e-06, step = 16700 (17.801 sec)
INFO:tensorflow:global_step/sec: 5.61555
I0411 15:26:01.286387 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61555
INFO:tensorflow:loss = 1.7881376e-06, step = 16800 (17.806 sec)
I0411 15:26:01.286911 140578650728256 basic_session_run_hooks.py:260] loss = 1.7881376e-06, step = 16800 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.61406
I0411 15:26:19.098901 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61406
INFO:tensorflow:loss = 1.7881376e-06, step = 16900 (17.813 sec)
I0411 15:26:19.099754 140578650728256 basic_session_run_hooks.py:260] loss = 1.7881376e-06, step = 16900 (17.813 sec)
INFO:tensorflow:Saving checkpoints for 17000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:26:36.730054 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 17000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48746
I0411 15:26:37.322293 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48746
INFO:tensorflow:loss = 1.7881376e-06, step = 17000 (18.223 sec)
I0411 15:26:37.322953 140578650728256 basic_session_run_hooks.py:260] loss = 1.7881376e-06, step = 17000 (18.223 sec)
INFO:tensorflow:global_step/sec: 5.61368
I0411 15:26:55.135896 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61368
INFO:tensorflow:loss = 1.6689286e-06, step = 17100 (17.814 sec)
I0411 15:26:55.136581 140578650728256 basic_session_run_hooks.py:260] loss = 1.6689286e-06, step = 17100 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.61392
I0411 15:27:12.949011 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61392
INFO:tensorflow:loss = 1.6689286e-06, step = 17200 (17.813 sec)
I0411 15:27:12.950052 140578650728256 basic_session_run_hooks.py:260] loss = 1.6689286e-06, step = 17200 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61108
I0411 15:27:30.770659 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61108
INFO:tensorflow:loss = 1.6689286e-06, step = 17300 (17.821 sec)
I0411 15:27:30.771455 140578650728256 basic_session_run_hooks.py:260] loss = 1.6689286e-06, step = 17300 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61322
I0411 15:27:48.585998 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61322
INFO:tensorflow:loss = 1.192092e-06, step = 17400 (17.816 sec)
I0411 15:27:48.587056 140578650728256 basic_session_run_hooks.py:260] loss = 1.192092e-06, step = 17400 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.60565
I0411 15:28:06.424936 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60565
INFO:tensorflow:loss = 1.192092e-06, step = 17500 (17.839 sec)
I0411 15:28:06.425681 140578650728256 basic_session_run_hooks.py:260] loss = 1.192092e-06, step = 17500 (17.839 sec)
INFO:tensorflow:global_step/sec: 5.61231
I0411 15:28:24.243044 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61231
INFO:tensorflow:loss = 1.0728829e-06, step = 17600 (17.818 sec)
I0411 15:28:24.244143 140578650728256 basic_session_run_hooks.py:260] loss = 1.0728829e-06, step = 17600 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.60753
I0411 15:28:42.076221 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60753
INFO:tensorflow:loss = 1.0728829e-06, step = 17700 (17.833 sec)
I0411 15:28:42.077033 140578650728256 basic_session_run_hooks.py:260] loss = 1.0728829e-06, step = 17700 (17.833 sec)
INFO:tensorflow:global_step/sec: 5.61248
I0411 15:28:59.893387 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61248
INFO:tensorflow:loss = 9.5367386e-07, step = 17800 (17.817 sec)
I0411 15:28:59.894114 140578650728256 basic_session_run_hooks.py:260] loss = 9.5367386e-07, step = 17800 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61175
I0411 15:29:17.713523 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61175
INFO:tensorflow:loss = 9.5367386e-07, step = 17900 (17.821 sec)
I0411 15:29:17.715023 140578650728256 basic_session_run_hooks.py:260] loss = 9.5367386e-07, step = 17900 (17.821 sec)
INFO:tensorflow:Saving checkpoints for 18000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:29:35.350833 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 18000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48483
I0411 15:29:35.945276 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48483
INFO:tensorflow:loss = 9.5367386e-07, step = 18000 (18.231 sec)
I0411 15:29:35.945911 140578650728256 basic_session_run_hooks.py:260] loss = 9.5367386e-07, step = 18000 (18.231 sec)
INFO:tensorflow:global_step/sec: 5.61803
I0411 15:29:53.745140 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61803
INFO:tensorflow:loss = 9.5367386e-07, step = 18100 (17.800 sec)
I0411 15:29:53.745949 140578650728256 basic_session_run_hooks.py:260] loss = 9.5367386e-07, step = 18100 (17.800 sec)
INFO:tensorflow:global_step/sec: 5.61116
I0411 15:30:11.567130 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61116
INFO:tensorflow:loss = 9.5367386e-07, step = 18200 (17.823 sec)
I0411 15:30:11.568553 140578650728256 basic_session_run_hooks.py:260] loss = 9.5367386e-07, step = 18200 (17.823 sec)
INFO:tensorflow:global_step/sec: 5.61457
I0411 15:30:29.377540 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61457
INFO:tensorflow:loss = 8.344646e-07, step = 18300 (17.810 sec)
I0411 15:30:29.378257 140578650728256 basic_session_run_hooks.py:260] loss = 8.344646e-07, step = 18300 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.60869
I0411 15:30:47.207077 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60869
INFO:tensorflow:loss = 8.344646e-07, step = 18400 (17.830 sec)
I0411 15:30:47.207981 140578650728256 basic_session_run_hooks.py:260] loss = 8.344646e-07, step = 18400 (17.830 sec)
INFO:tensorflow:global_step/sec: 5.61425
I0411 15:31:05.019137 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61425
INFO:tensorflow:loss = 8.344646e-07, step = 18500 (17.812 sec)
I0411 15:31:05.020297 140578650728256 basic_session_run_hooks.py:260] loss = 8.344646e-07, step = 18500 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61034
I0411 15:31:22.843366 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61034
INFO:tensorflow:loss = 8.344646e-07, step = 18600 (17.825 sec)
I0411 15:31:22.844991 140578650728256 basic_session_run_hooks.py:260] loss = 8.344646e-07, step = 18600 (17.825 sec)
INFO:tensorflow:global_step/sec: 5.61359
I0411 15:31:40.657194 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61359
INFO:tensorflow:loss = 8.344646e-07, step = 18700 (17.813 sec)
I0411 15:31:40.658230 140578650728256 basic_session_run_hooks.py:260] loss = 8.344646e-07, step = 18700 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61441
I0411 15:31:58.468272 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61441
INFO:tensorflow:loss = 7.152555e-07, step = 18800 (17.811 sec)
I0411 15:31:58.468700 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 18800 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61856
I0411 15:32:16.266730 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61856
INFO:tensorflow:loss = 7.152555e-07, step = 18900 (17.799 sec)
I0411 15:32:16.268044 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 18900 (17.799 sec)

INFO:tensorflow:Saving checkpoints for 19000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:32:33.900731 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 19000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4767
I0411 15:32:34.525651 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4767
INFO:tensorflow:loss = 7.152555e-07, step = 19000 (18.258 sec)
I0411 15:32:34.526308 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 19000 (18.258 sec)
INFO:tensorflow:global_step/sec: 5.61639
I0411 15:32:52.330612 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61639
INFO:tensorflow:loss = 7.152555e-07, step = 19100 (17.805 sec)
I0411 15:32:52.331162 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 19100 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61531
I0411 15:33:10.139454 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61531
INFO:tensorflow:loss = 7.152555e-07, step = 19200 (17.809 sec)
I0411 15:33:10.140470 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 19200 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61329
I0411 15:33:27.954170 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61329
INFO:tensorflow:loss = 7.152555e-07, step = 19300 (17.815 sec)
I0411 15:33:27.955149 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 19300 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.60892
I0411 15:33:45.782763 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60892
INFO:tensorflow:loss = 7.152555e-07, step = 19400 (17.829 sec)
I0411 15:33:45.783733 140578650728256 basic_session_run_hooks.py:260] loss = 7.152555e-07, step = 19400 (17.829 sec)
INFO:tensorflow:global_step/sec: 5.61379
I0411 15:34:03.596458 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61379
INFO:tensorflow:loss = 2.4121252e-07, step = 19500 (17.814 sec)
I0411 15:34:03.597473 140578650728256 basic_session_run_hooks.py:260] loss = 2.4121252e-07, step = 19500 (17.814 sec)
INFO:tensorflow:global_step/sec: 5.61166
I0411 15:34:21.416103 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61166
INFO:tensorflow:loss = 2.3841855e-07, step = 19600 (17.819 sec)
I0411 15:34:21.416925 140578650728256 basic_session_run_hooks.py:260] loss = 2.3841855e-07, step = 19600 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61483
I0411 15:34:39.226376 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61483
INFO:tensorflow:loss = 2.3841855e-07, step = 19700 (17.810 sec)
I0411 15:34:39.227455 140578650728256 basic_session_run_hooks.py:260] loss = 2.3841855e-07, step = 19700 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.61803
I0411 15:34:57.026058 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61803
INFO:tensorflow:loss = 2.3841855e-07, step = 19800 (17.800 sec)
I0411 15:34:57.027847 140578650728256 basic_session_run_hooks.py:260] loss = 2.3841855e-07, step = 19800 (17.800 sec)
INFO:tensorflow:global_step/sec: 5.62089
I0411 15:35:14.816585 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62089
INFO:tensorflow:loss = 1.2060626e-07, step = 19900 (17.789 sec)
I0411 15:35:14.817312 140578650728256 basic_session_run_hooks.py:260] loss = 1.2060626e-07, step = 19900 (17.789 sec)
INFO:tensorflow:Saving checkpoints for 20000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:35:32.450661 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 20000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49151
I0411 15:35:33.026582 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49151
INFO:tensorflow:loss = 1.19209275e-07, step = 20000 (18.210 sec)
I0411 15:35:33.027306 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20000 (18.210 sec)
INFO:tensorflow:global_step/sec: 5.61503
I0411 15:35:50.835870 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61503
INFO:tensorflow:loss = 1.19209275e-07, step = 20100 (17.809 sec)
I0411 15:35:50.836529 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20100 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61461
I0411 15:36:08.646724 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61461
INFO:tensorflow:loss = 1.19209275e-07, step = 20200 (17.811 sec)
I0411 15:36:08.647907 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20200 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61482
I0411 15:36:26.456562 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61482
INFO:tensorflow:loss = 1.19209275e-07, step = 20300 (17.809 sec)
I0411 15:36:26.457337 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20300 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61663
I0411 15:36:44.261194 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61663
INFO:tensorflow:loss = 1.19209275e-07, step = 20400 (17.805 sec)
I0411 15:36:44.262699 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20400 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61277
I0411 15:37:02.077347 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61277
INFO:tensorflow:loss = 1.19209275e-07, step = 20500 (17.815 sec)
I0411 15:37:02.078109 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20500 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61319
I0411 15:37:19.892901 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61319
INFO:tensorflow:loss = 1.19209275e-07, step = 20600 (17.816 sec)
I0411 15:37:19.894096 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20600 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61285
I0411 15:37:37.708781 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61285
INFO:tensorflow:loss = 1.19209275e-07, step = 20700 (17.815 sec)
I0411 15:37:37.709456 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20700 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61341
I0411 15:37:55.523299 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61341
INFO:tensorflow:loss = 1.19209275e-07, step = 20800 (17.815 sec)
I0411 15:37:55.524214 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20800 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61998
I0411 15:38:13.317009 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61998
INFO:tensorflow:loss = 1.19209275e-07, step = 20900 (17.794 sec)
I0411 15:38:13.317809 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 20900 (17.794 sec)
INFO:tensorflow:Saving checkpoints for 21000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:38:30.943568 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 21000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49046
I0411 15:38:31.530336 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49046
INFO:tensorflow:loss = 1.19209275e-07, step = 21000 (18.213 sec)
I0411 15:38:31.531071 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21000 (18.213 sec)
INFO:tensorflow:global_step/sec: 5.61187
I0411 15:38:49.349638 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61187
INFO:tensorflow:loss = 1.19209275e-07, step = 21100 (17.819 sec)
I0411 15:38:49.350149 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21100 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61536
I0411 15:39:07.158193 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61536
INFO:tensorflow:loss = 1.19209275e-07, step = 21200 (17.809 sec)
I0411 15:39:07.159195 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21200 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61269
I0411 15:39:24.974824 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61269
INFO:tensorflow:loss = 1.19209275e-07, step = 21300 (17.817 sec)
I0411 15:39:24.975743 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21300 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61532
I0411 15:39:42.783241 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61532
INFO:tensorflow:loss = 1.19209275e-07, step = 21400 (17.808 sec)
I0411 15:39:42.784105 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21400 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61258
I0411 15:40:00.600491 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61258
INFO:tensorflow:loss = 1.19209275e-07, step = 21500 (17.817 sec)
I0411 15:40:00.601588 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21500 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.61697
I0411 15:40:18.403599 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61697
INFO:tensorflow:loss = 1.19209275e-07, step = 21600 (17.803 sec)
I0411 15:40:18.404376 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21600 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61757
I0411 15:40:36.205055 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61757
INFO:tensorflow:loss = 1.19209275e-07, step = 21700 (17.802 sec)
I0411 15:40:36.206095 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21700 (17.802 sec)
INFO:tensorflow:global_step/sec: 5.61697
I0411 15:40:54.008005 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61697
INFO:tensorflow:loss = 1.19209275e-07, step = 21800 (17.803 sec)
I0411 15:40:54.008797 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21800 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.6127
I0411 15:41:11.824765 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6127
INFO:tensorflow:loss = 1.19209275e-07, step = 21900 (17.817 sec)
I0411 15:41:11.825384 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 21900 (17.817 sec)
INFO:tensorflow:Saving checkpoints for 22000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:41:29.458686 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 22000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48852
I0411 15:41:30.044642 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48852
INFO:tensorflow:loss = 1.19209275e-07, step = 22000 (18.220 sec)
I0411 15:41:30.045311 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 22000 (18.220 sec)
INFO:tensorflow:global_step/sec: 5.61397
I0411 15:41:47.857368 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61397
INFO:tensorflow:loss = 1.19209275e-07, step = 22100 (17.813 sec)
I0411 15:41:47.858189 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 22100 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61916
I0411 15:42:05.653898 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61916
INFO:tensorflow:loss = 1.19209275e-07, step = 22200 (17.797 sec)
I0411 15:42:05.655224 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 22200 (17.797 sec)
INFO:tensorflow:global_step/sec: 5.6146
I0411 15:42:23.464415 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6146
INFO:tensorflow:loss = 1.19209275e-07, step = 22300 (17.810 sec)
I0411 15:42:23.465268 140578650728256 basic_session_run_hooks.py:260] loss = 1.19209275e-07, step = 22300 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.61685
I0411 15:42:41.267935 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61685
INFO:tensorflow:loss = 1.2572853e-08, step = 22400 (17.803 sec)
I0411 15:42:41.268745 140578650728256 basic_session_run_hooks.py:260] loss = 1.2572853e-08, step = 22400 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61328
I0411 15:42:59.083003 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61328
INFO:tensorflow:loss = 9.778886e-09, step = 22500 (17.815 sec)
I0411 15:42:59.084253 140578650728256 basic_session_run_hooks.py:260] loss = 9.778886e-09, step = 22500 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.62094
I0411 15:43:16.873446 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62094
INFO:tensorflow:loss = 5.587935e-09, step = 22600 (17.790 sec)
I0411 15:43:16.874255 140578650728256 basic_session_run_hooks.py:260] loss = 5.587935e-09, step = 22600 (17.790 sec)
INFO:tensorflow:global_step/sec: 5.6191
I0411 15:43:34.670067 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6191
INFO:tensorflow:loss = 6.9849184e-09, step = 22700 (17.797 sec)
I0411 15:43:34.671113 140578650728256 basic_session_run_hooks.py:260] loss = 6.9849184e-09, step = 22700 (17.797 sec)
INFO:tensorflow:global_step/sec: 5.61162
I0411 15:43:52.490007 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61162
INFO:tensorflow:loss = 5.1222737e-09, step = 22800 (17.820 sec)
I0411 15:43:52.490831 140578650728256 basic_session_run_hooks.py:260] loss = 5.1222737e-09, step = 22800 (17.820 sec)
INFO:tensorflow:global_step/sec: 5.61464
I0411 15:44:10.300570 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61464
INFO:tensorflow:loss = 6.5192576e-09, step = 22900 (17.810 sec)
I0411 15:44:10.301095 140578650728256 basic_session_run_hooks.py:260] loss = 6.5192576e-09, step = 22900 (17.810 sec)
INFO:tensorflow:Saving checkpoints for 23000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:44:27.935962 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 23000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4822
I0411 15:44:28.541559 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4822
INFO:tensorflow:loss = 5.1222737e-09, step = 23000 (18.241 sec)
I0411 15:44:28.542441 140578650728256 basic_session_run_hooks.py:260] loss = 5.1222737e-09, step = 23000 (18.241 sec)
INFO:tensorflow:global_step/sec: 5.61517
I0411 15:44:46.350361 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61517
INFO:tensorflow:loss = 3.2596288e-09, step = 23100 (17.809 sec)
I0411 15:44:46.351017 140578650728256 basic_session_run_hooks.py:260] loss = 3.2596288e-09, step = 23100 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61711
I0411 15:45:04.153130 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61711
INFO:tensorflow:loss = 2.3283062e-09, step = 23200 (17.803 sec)
I0411 15:45:04.153931 140578650728256 basic_session_run_hooks.py:260] loss = 2.3283062e-09, step = 23200 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61513
I0411 15:45:21.962336 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61513
INFO:tensorflow:loss = 4.6566124e-09, step = 23300 (17.809 sec)
I0411 15:45:21.963365 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566124e-09, step = 23300 (17.809 sec)
INFO:tensorflow:global_step/sec: 5.61594
I0411 15:45:39.768612 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61594
INFO:tensorflow:loss = 2.3283062e-09, step = 23400 (17.806 sec)
I0411 15:45:39.769417 140578650728256 basic_session_run_hooks.py:260] loss = 2.3283062e-09, step = 23400 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.6113
I0411 15:45:57.589942 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6113
INFO:tensorflow:loss = 1.3969838e-09, step = 23500 (17.821 sec)
I0411 15:45:57.590676 140578650728256 basic_session_run_hooks.py:260] loss = 1.3969838e-09, step = 23500 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61802
I0411 15:46:15.389666 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61802
INFO:tensorflow:loss = 4.6566126e-10, step = 23600 (17.800 sec)
I0411 15:46:15.390487 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 23600 (17.800 sec)
INFO:tensorflow:global_step/sec: 5.61302
I0411 15:46:33.205527 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61302
INFO:tensorflow:loss = 4.6566126e-10, step = 23700 (17.816 sec)
I0411 15:46:33.206213 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 23700 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61598
I0411 15:46:51.011710 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61598
INFO:tensorflow:loss = 4.6566126e-10, step = 23800 (17.806 sec)
I0411 15:46:51.012359 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 23800 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.61407
I0411 15:47:08.824078 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61407
INFO:tensorflow:loss = 4.6566126e-10, step = 23900 (17.813 sec)
I0411 15:47:08.824930 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 23900 (17.813 sec)
INFO:tensorflow:Saving checkpoints for 24000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:47:26.449602 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 24000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48794
I0411 15:47:27.045898 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48794
INFO:tensorflow:loss = 4.6566126e-10, step = 24000 (18.222 sec)
I0411 15:47:27.046545 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 24000 (18.222 sec)
n'cINFO:tensorflow:global_step/sec: 5.61418
I0411 15:47:44.857876 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61418
INFO:tensorflow:loss = 4.6566126e-10, step = 24100 (17.812 sec)
I0411 15:47:44.858551 140578650728256 basic_session_run_hooks.py:260] loss = 4.6566126e-10, step = 24100 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61418
I0411 15:48:02.669877 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61418
INFO:tensorflow:loss = 0.0, step = 24200 (17.812 sec)
I0411 15:48:02.670959 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24200 (17.812 sec)
INFO:tensorflow:global_step/sec: 5.61405
I0411 15:48:20.482823 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61405
INFO:tensorflow:loss = 0.0, step = 24300 (17.813 sec)
I0411 15:48:20.484115 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24300 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61509
I0411 15:48:38.291520 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61509
INFO:tensorflow:loss = 0.0, step = 24400 (17.808 sec)
I0411 15:48:38.292021 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24400 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61352
I0411 15:48:56.106439 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61352
INFO:tensorflow:loss = 0.0, step = 24500 (17.816 sec)
I0411 15:48:56.108063 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24500 (17.816 sec)
INFO:tensorflow:global_step/sec: 5.61339
I0411 15:49:13.920236 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61339
INFO:tensorflow:loss = 0.0, step = 24600 (17.813 sec)
I0411 15:49:13.920896 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24600 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61476
I0411 15:49:31.730556 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61476
INFO:tensorflow:loss = 0.0, step = 24700 (17.811 sec)
I0411 15:49:31.731537 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24700 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.6125
I0411 15:49:49.547875 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6125
INFO:tensorflow:loss = 0.0, step = 24800 (17.817 sec)
I0411 15:49:49.548763 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24800 (17.817 sec)
INFO:tensorflow:global_step/sec: 5.6135
I0411 15:50:07.362041 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.6135
INFO:tensorflow:loss = 0.0, step = 24900 (17.814 sec)
I0411 15:50:07.362859 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 24900 (17.814 sec)
INFO:tensorflow:Saving checkpoints for 25000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:50:25.003236 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 25000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.48469
I0411 15:50:25.594606 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.48469
INFO:tensorflow:loss = 0.0, step = 25000 (18.233 sec)
I0411 15:50:25.595377 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25000 (18.233 sec)
INFO:tensorflow:global_step/sec: 5.61625
I0411 15:50:43.400014 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61625
INFO:tensorflow:loss = 0.0, step = 25100 (17.805 sec)
I0411 15:50:43.400567 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25100 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61856
I0411 15:51:01.198432 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61856
INFO:tensorflow:loss = 0.0, step = 25200 (17.799 sec)
I0411 15:51:01.199352 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25200 (17.799 sec)
INFO:tensorflow:global_step/sec: 5.61534
I0411 15:51:19.006634 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61534
INFO:tensorflow:loss = 0.0, step = 25300 (17.808 sec)
I0411 15:51:19.007467 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25300 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61628
I0411 15:51:36.812383 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61628
INFO:tensorflow:loss = 0.0, step = 25400 (17.806 sec)
I0411 15:51:36.813766 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25400 (17.806 sec)
INFO:tensorflow:global_step/sec: 5.61513
I0411 15:51:54.621131 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61513
INFO:tensorflow:loss = 0.0, step = 25500 (17.808 sec)
I0411 15:51:54.622069 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25500 (17.808 sec)
INFO:tensorflow:global_step/sec: 5.61372
I0411 15:52:12.434561 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61372
INFO:tensorflow:loss = 0.0, step = 25600 (17.813 sec)
I0411 15:52:12.435382 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25600 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61161
I0411 15:52:30.254955 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61161
INFO:tensorflow:loss = 0.0, step = 25700 (17.821 sec)
I0411 15:52:30.256123 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25700 (17.821 sec)
INFO:tensorflow:global_step/sec: 5.61431
I0411 15:52:48.066365 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61431
INFO:tensorflow:loss = 0.0, step = 25800 (17.811 sec)
I0411 15:52:48.066959 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25800 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.61284
I0411 15:53:05.882657 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61284
INFO:tensorflow:loss = 0.0, step = 25900 (17.816 sec)
I0411 15:53:05.883389 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 25900 (17.816 sec)
INFO:tensorflow:Saving checkpoints for 26000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:53:23.520852 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 26000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4907
I0411 15:53:24.095319 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.4907
INFO:tensorflow:loss = 0.0, step = 26000 (18.213 sec)
I0411 15:53:24.096070 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26000 (18.213 sec)
INFO:tensorflow:global_step/sec: 5.61183
I0411 15:53:41.914757 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61183
INFO:tensorflow:loss = 0.0, step = 26100 (17.819 sec)
I0411 15:53:41.915411 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26100 (17.819 sec)
INFO:tensorflow:global_step/sec: 5.61657
I0411 15:53:59.719274 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61657
INFO:tensorflow:loss = 0.0, step = 26200 (17.805 sec)
I0411 15:53:59.720206 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26200 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61329
I0411 15:54:17.534410 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61329
INFO:tensorflow:loss = 0.0, step = 26300 (17.815 sec)
I0411 15:54:17.535566 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26300 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61308
I0411 15:54:35.349767 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61308
INFO:tensorflow:loss = 0.0, step = 26400 (17.815 sec)
I0411 15:54:35.350520 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26400 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61242
I0411 15:54:53.167649 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61242
INFO:tensorflow:loss = 0.0, step = 26500 (17.818 sec)
I0411 15:54:53.168887 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26500 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61307
I0411 15:55:10.982919 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61307
INFO:tensorflow:loss = 0.0, step = 26600 (17.815 sec)
I0411 15:55:10.983787 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26600 (17.815 sec)
INFO:tensorflow:global_step/sec: 5.61495
I0411 15:55:28.792484 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61495
INFO:tensorflow:loss = 0.0, step = 26700 (17.810 sec)
I0411 15:55:28.793319 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26700 (17.810 sec)
INFO:tensorflow:global_step/sec: 5.60984
I0411 15:55:46.618644 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60984
INFO:tensorflow:loss = 0.0, step = 26800 (17.826 sec)
I0411 15:55:46.619703 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26800 (17.826 sec)
INFO:tensorflow:global_step/sec: 5.61274
I0411 15:56:04.434863 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61274
INFO:tensorflow:loss = 0.0, step = 26900 (17.816 sec)
I0411 15:56:04.435564 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 26900 (17.816 sec)
INFO:tensorflow:Saving checkpoints for 27000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:56:22.068653 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 27000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49036
I0411 15:56:22.648632 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49036
INFO:tensorflow:loss = 0.0, step = 27000 (18.214 sec)
I0411 15:56:22.649295 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27000 (18.214 sec)
INFO:tensorflow:global_step/sec: 5.61388
I0411 15:56:40.461669 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61388
INFO:tensorflow:loss = 0.0, step = 27100 (17.813 sec)
I0411 15:56:40.462363 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27100 (17.813 sec)
INFO:tensorflow:global_step/sec: 5.61779
I0411 15:56:58.262156 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61779
INFO:tensorflow:loss = 0.0, step = 27200 (17.800 sec)
I0411 15:56:58.262837 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27200 (17.800 sec)
INFO:tensorflow:global_step/sec: 5.61436
I0411 15:57:16.073700 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61436
INFO:tensorflow:loss = 0.0, step = 27300 (17.811 sec)
I0411 15:57:16.074326 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27300 (17.811 sec)
INFO:tensorflow:global_step/sec: 5.62193
I0411 15:57:33.861468 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.62193
INFO:tensorflow:loss = 0.0, step = 27400 (17.788 sec)
I0411 15:57:33.862477 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27400 (17.788 sec)
INFO:tensorflow:global_step/sec: 5.61669
I0411 15:57:51.665162 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61669
INFO:tensorflow:loss = 0.0, step = 27500 (17.803 sec)
I0411 15:57:51.665858 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27500 (17.803 sec)
INFO:tensorflow:global_step/sec: 5.61596
I0411 15:58:09.471647 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61596
INFO:tensorflow:loss = 0.0, step = 27600 (17.807 sec)
I0411 15:58:09.472730 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27600 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.61233
I0411 15:58:27.289851 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61233
INFO:tensorflow:loss = 0.0, step = 27700 (17.818 sec)
I0411 15:58:27.291115 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27700 (17.818 sec)
INFO:tensorflow:global_step/sec: 5.61529
I0411 15:58:45.097998 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61529
INFO:tensorflow:loss = 0.0, step = 27800 (17.807 sec)
I0411 15:58:45.098588 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27800 (17.807 sec)
INFO:tensorflow:global_step/sec: 5.60955
I0411 15:59:02.925129 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.60955
INFO:tensorflow:loss = 0.0, step = 27900 (17.828 sec)
I0411 15:59:02.926293 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 27900 (17.828 sec)
INFO:tensorflow:Saving checkpoints for 28000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 15:59:20.558806 140578650728256 basic_session_run_hooks.py:606] Saving checkpoints for 28000 into ~/BERT4Rec/yelp_be            rt-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.49065
I0411 15:59:21.137522 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.49065
INFO:tensorflow:loss = 0.0, step = 28000 (18.212 sec)
I0411 15:59:21.138142 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 28000 (18.212 sec)
INFO:tensorflow:global_step/sec: 5.61665
I0411 15:59:38.941992 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61665
INFO:tensorflow:loss = 0.0, step = 28100 (17.805 sec)
I0411 15:59:38.942955 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 28100 (17.805 sec)
INFO:tensorflow:global_step/sec: 5.61171
I0411 15:59:56.761778 140578650728256 basic_session_run_hooks.py:692] global_step/sec: 5.61171
INFO:tensorflow:loss = 0.0, step = 28200 (17.820 sec)
I0411 15:59:56.762595 140578650728256 basic_session_run_hooks.py:260] loss = 0.0, step = 28200 (17.820 sec)
^CTraceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 571, in main
    input_fn=train_input_fn, max_steps=FLAGS.num_train_steps)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 367, in tra            in
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1158, in _t            rain_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1192, in _t            rain_model_default
    saving_listeners)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1484, in _t            rain_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1252, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1338, in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1411, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1169, in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionr            un
    run_metadata)
KeyboardInterrupt

(base) root@container-855111b90c-e179f175:~/BERT4Rec#
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 61.317418
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 61.810187
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 62.226287
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 62.256226
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 62.507416
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 62.332044
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 62.484401999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 62.492889000000005
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 62.737265
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 62.442991000000006
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 0, name: ForkPoolWorker-1, step: 2000, time: 66.64302
step: 2, name: ForkPoolWorker-3, step: 2000, time: 66.53759299999999
step: 1, name: ForkPoolWorker-2, step: 2000, time: 66.56678499999998
step: 5, name: ForkPoolWorker-6, step: 2000, time: 66.411326
step: 4, name: ForkPoolWorker-5, step: 2000, time: 66.408563
step: 3, name: ForkPoolWorker-4, step: 2000, time: 66.82228999999998
step: 8, name: ForkPoolWorker-9, step: 2000, time: 66.576944
step: 9, name: ForkPoolWorker-10, step: 2000, time: 66.45982800000002
step: 6, name: ForkPoolWorker-7, step: 2000, time: 66.660212
step: 7, name: ForkPoolWorker-8, step: 2000, time: 67.12710800000002
step: 5, name: ForkPoolWorker-6, step: 3000, time: 53.557591
step: 4, name: ForkPoolWorker-5, step: 3000, time: 53.68795699999998
step: 2, name: ForkPoolWorker-3, step: 3000, time: 53.97938099999999
step: 0, name: ForkPoolWorker-1, step: 3000, time: 54.351259
step: 1, name: ForkPoolWorker-2, step: 3000, time: 54.372928
step: 3, name: ForkPoolWorker-4, step: 3000, time: 53.816484
step: 8, name: ForkPoolWorker-9, step: 3000, time: 53.80563699999999
step: 9, name: ForkPoolWorker-10, step: 3000, time: 53.78048799999999
step: 6, name: ForkPoolWorker-7, step: 3000, time: 53.94779
step: 7, name: ForkPoolWorker-8, step: 3000, time: 54.059968999999995
step: 5, name: ForkPoolWorker-6, step: 4000, time: 43.515907999999996
step: 4, name: ForkPoolWorker-5, step: 4000, time: 43.41002599999999
step: 2, name: ForkPoolWorker-3, step: 4000, time: 43.705663000000015
step: 8, name: ForkPoolWorker-9, step: 4000, time: 43.48937600000002
step: 9, name: ForkPoolWorker-10, step: 4000, time: 43.63435799999999
step: 3, name: ForkPoolWorker-4, step: 4000, time: 43.73108400000001
step: 0, name: ForkPoolWorker-1, step: 4000, time: 43.99795400000002
step: 1, name: ForkPoolWorker-2, step: 4000, time: 43.78721100000001
step: 6, name: ForkPoolWorker-7, step: 4000, time: 43.646698999999984
step: 7, name: ForkPoolWorker-8, step: 4000, time: 43.62591600000002
step: 5, name: ForkPoolWorker-6, step: 5000, time: 43.82154200000002
step: 4, name: ForkPoolWorker-5, step: 5000, time: 44.175419000000005
step: 2, name: ForkPoolWorker-3, step: 5000, time: 43.79122600000002
step: 8, name: ForkPoolWorker-9, step: 5000, time: 44.05932800000002
step: 9, name: ForkPoolWorker-10, step: 5000, time: 43.93306900000002
step: 1, name: ForkPoolWorker-2, step: 5000, time: 43.86033500000002
step: 3, name: ForkPoolWorker-4, step: 5000, time: 44.022468
step: 0, name: ForkPoolWorker-1, step: 5000, time: 43.889639999999986
step: 6, name: ForkPoolWorker-7, step: 5000, time: 44.07567400000002
step: 7, name: ForkPoolWorker-8, step: 5000, time: 44.21227300000001
step: 5, name: ForkPoolWorker-6, step: 6000, time: 39.43901999999997
step: 4, name: ForkPoolWorker-5, step: 6000, time: 39.52185300000002
step: 2, name: ForkPoolWorker-3, step: 6000, time: 39.596108000000015
step: 8, name: ForkPoolWorker-9, step: 6000, time: 39.61112400000002
step: 9, name: ForkPoolWorker-10, step: 6000, time: 39.49055200000004
step: 1, name: ForkPoolWorker-2, step: 6000, time: 39.63767200000001
step: 3, name: ForkPoolWorker-4, step: 6000, time: 39.73112800000001
step: 0, name: ForkPoolWorker-1, step: 6000, time: 39.50498499999998
step: 6, name: ForkPoolWorker-7, step: 6000, time: 39.381587999999965
step: 7, name: ForkPoolWorker-8, step: 6000, time: 39.55259100000001
step: 5, name: ForkPoolWorker-6, step: 7000, time: 30.862544000000014
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.730203000000017
step: 2, name: ForkPoolWorker-3, step: 7000, time: 30.767964000000006
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.652713000000006
step: 8, name: ForkPoolWorker-9, step: 7000, time: 30.705876999999987
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.765588999999977
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.706778999999983
step: 6, name: ForkPoolWorker-7, step: 7000, time: 30.694435999999996
step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.821221999999977
step: 7, name: ForkPoolWorker-8, step: 7000, time: 30.578825999999992
step: 2, name: ForkPoolWorker-3, step: 8000, time: 33.10766899999999
step: 4, name: ForkPoolWorker-5, step: 8000, time: 33.89891600000004
step: 5, name: ForkPoolWorker-6, step: 8000, time: 33.891309999999976
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.721832000000006
step: 8, name: ForkPoolWorker-9, step: 8000, time: 33.78196499999996
step: 0, name: ForkPoolWorker-1, step: 8000, time: 33.58212900000001
step: 1, name: ForkPoolWorker-2, step: 8000, time: 34.31097399999999
step: 6, name: ForkPoolWorker-7, step: 8000, time: 34.39775500000002
step: 3, name: ForkPoolWorker-4, step: 8000, time: 34.59848499999998
step: 7, name: ForkPoolWorker-8, step: 8000, time: 33.579695000000015
step: 2, name: ForkPoolWorker-3, step: 9000, time: 28.993235999999968
step: 4, name: ForkPoolWorker-5, step: 9000, time: 29.814562999999964
step: 5, name: ForkPoolWorker-6, step: 9000, time: 29.838573999999994
step: 0, name: ForkPoolWorker-1, step: 9000, time: 28.966310999999962
step: 9, name: ForkPoolWorker-10, step: 9000, time: 29.705849999999998
step: 8, name: ForkPoolWorker-9, step: 9000, time: 29.55857100000003
step: 7, name: ForkPoolWorker-8, step: 9000, time: 28.87517299999996
step: 6, name: ForkPoolWorker-7, step: 9000, time: 29.530415000000005
step: 1, name: ForkPoolWorker-2, step: 9000, time: 29.67033699999996
step: 3, name: ForkPoolWorker-4, step: 9000, time: 29.908348000000046
step: 2, name: ForkPoolWorker-3, step: 10000, time: 28.01393200000001
step: 0, name: ForkPoolWorker-1, step: 10000, time: 27.972329000000002
step: 5, name: ForkPoolWorker-6, step: 10000, time: 28.64199100000002
step: 4, name: ForkPoolWorker-5, step: 10000, time: 28.44513699999999
step: 9, name: ForkPoolWorker-10, step: 10000, time: 28.39448500000003
step: 8, name: ForkPoolWorker-9, step: 10000, time: 28.619537999999977
step: 7, name: ForkPoolWorker-8, step: 10000, time: 28.003809999999987
step: 6, name: ForkPoolWorker-7, step: 10000, time: 28.491795000000025
step: 3, name: ForkPoolWorker-4, step: 10000, time: 28.222954000000016
step: 1, name: ForkPoolWorker-2, step: 10000, time: 28.696450000000027
step: 2, name: ForkPoolWorker-3, step: 11000, time: 20.760192000000018
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.71183199999996
step: 5, name: ForkPoolWorker-6, step: 11000, time: 21.002456999999993
step: 4, name: ForkPoolWorker-5, step: 11000, time: 21.166642999999965
step: 7, name: ForkPoolWorker-8, step: 11000, time: 20.66619799999995
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.915804000000037
step: 8, name: ForkPoolWorker-9, step: 11000, time: 21.20223599999997
step: 6, name: ForkPoolWorker-7, step: 11000, time: 21.19103899999999
step: 3, name: ForkPoolWorker-4, step: 11000, time: 21.016254000000004
step: 1, name: ForkPoolWorker-2, step: 11000, time: 21.024550000000033
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.759379000000024
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.50986499999999
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.479596000000015
step: 5, name: ForkPoolWorker-6, step: 12000, time: 26.202720999999997
step: 4, name: ForkPoolWorker-5, step: 12000, time: 26.017713000000015
step: 9, name: ForkPoolWorker-10, step: 12000, time: 26.058283000000017
step: 8, name: ForkPoolWorker-9, step: 12000, time: 26.344476000000043
step: 6, name: ForkPoolWorker-7, step: 12000, time: 26.21373699999998
step: 1, name: ForkPoolWorker-2, step: 12000, time: 26.137227999999993
step: 3, name: ForkPoolWorker-4, step: 12000, time: 26.430994999999996
step: 2, name: ForkPoolWorker-3, step: 13000, time: 30.857128999999986
step: 0, name: ForkPoolWorker-1, step: 13000, time: 30.850649999999973
step: 7, name: ForkPoolWorker-8, step: 13000, time: 30.761428999999964
step: 5, name: ForkPoolWorker-6, step: 13000, time: 31.557320000000004
step: 9, name: ForkPoolWorker-10, step: 13000, time: 31.60354799999999
step: 4, name: ForkPoolWorker-5, step: 13000, time: 31.724323000000027
step: 8, name: ForkPoolWorker-9, step: 13000, time: 31.481151000000068
step: 6, name: ForkPoolWorker-7, step: 13000, time: 31.301395999999954
step: 1, name: ForkPoolWorker-2, step: 13000, time: 31.26706299999995
step: 3, name: ForkPoolWorker-4, step: 13000, time: 31.600638999999944
step: 2, name: ForkPoolWorker-3, step: 14000, time: 28.038276999999994
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.054232999999954
step: 7, name: ForkPoolWorker-8, step: 14000, time: 28.049397999999997
step: 5, name: ForkPoolWorker-6, step: 14000, time: 28.786858000000052
step: 9, name: ForkPoolWorker-10, step: 14000, time: 28.941531999999995
step: 4, name: ForkPoolWorker-5, step: 14000, time: 29.060858000000053
step: 8, name: ForkPoolWorker-9, step: 14000, time: 29.033766000000014
step: 6, name: ForkPoolWorker-7, step: 14000, time: 28.617331000000036
step: 1, name: ForkPoolWorker-2, step: 14000, time: 28.70452899999998
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.78776999999991
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.215637000000015
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.246006999999963
step: 7, name: ForkPoolWorker-8, step: 15000, time: 22.252644000000032
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.82071099999996
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.768225999999913
step: 9, name: ForkPoolWorker-10, step: 15000, time: 23.112640000000056
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.90074800000002
step: 6, name: ForkPoolWorker-7, step: 15000, time: 22.871136999999976
step: 1, name: ForkPoolWorker-2, step: 15000, time: 22.666477999999984
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.93330000000003
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.384481999999934
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.348223000000075
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.465432999999962
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.777457000000027
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.58638499999995
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.713794000000007
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.773554000000104
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.940053000000034
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.8311480000001
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.62575700000002
step: 2, name: ForkPoolWorker-3, step: 17000, time: 24.09072900000001
step: 0, name: ForkPoolWorker-1, step: 17000, time: 23.829555000000028
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.884714999999915
step: 5, name: ForkPoolWorker-6, step: 17000, time: 24.175685000000044
step: 6, name: ForkPoolWorker-7, step: 17000, time: 24.240148999999974
step: 4, name: ForkPoolWorker-5, step: 17000, time: 24.326070999999956
step: 8, name: ForkPoolWorker-9, step: 17000, time: 24.380113999999935
step: 9, name: ForkPoolWorker-10, step: 17000, time: 24.227291000000037
step: 1, name: ForkPoolWorker-2, step: 17000, time: 24.371803999999997
step: 3, name: ForkPoolWorker-4, step: 17000, time: 24.599604999999997
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.164274999999975
step: 0, name: ForkPoolWorker-1, step: 18000, time: 16.162437000000068
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.36035199999992
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.34122400000001
step: 6, name: ForkPoolWorker-7, step: 18000, time: 16.646841999999992
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.677261000000044
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.662420999999995
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.607801999999992
step: 2, name: ForkPoolWorker-3, step: 19000, time: 15.148163999999952
step: 1, name: ForkPoolWorker-2, step: 18000, time: 16.653944000000024
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.750650999999948
step: 0, name: ForkPoolWorker-1, step: 19000, time: 15.12344100000007
step: 7, name: ForkPoolWorker-8, step: 19000, time: 15.06528400000002
step: 5, name: ForkPoolWorker-6, step: 19000, time: 15.607827000000043
step: 6, name: ForkPoolWorker-7, step: 19000, time: 15.518259999999941
step: 8, name: ForkPoolWorker-9, step: 19000, time: 15.620626000000016
step: 4, name: ForkPoolWorker-5, step: 19000, time: 15.687617000000046
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.646751999999992
step: 9, name: ForkPoolWorker-10, step: 19000, time: 16.08512399999995
step: 1, name: ForkPoolWorker-2, step: 19000, time: 15.68120900000008
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.664618000000019
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.548882000000049
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.530627000000095
step: 5, name: ForkPoolWorker-6, step: 20000, time: 16.410918000000038
step: 4, name: ForkPoolWorker-5, step: 20000, time: 16.05894599999999
step: 2, name: ForkPoolWorker-3, step: 21000, time: 16.109092000000032
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.883666000000062
step: 6, name: ForkPoolWorker-7, step: 20000, time: 16.160422999999923
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.913345999999933
step: 1, name: ForkPoolWorker-2, step: 20000, time: 16.126119000000017
step: 0, name: ForkPoolWorker-1, step: 21000, time: 16.21303899999998
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.876916000000051
step: 7, name: ForkPoolWorker-8, step: 21000, time: 16.097872999999936
step: 5, name: ForkPoolWorker-6, step: 21000, time: 16.51352799999995
step: 4, name: ForkPoolWorker-5, step: 21000, time: 16.66932100000008
step: 8, name: ForkPoolWorker-9, step: 21000, time: 16.48307299999999
step: 6, name: ForkPoolWorker-7, step: 21000, time: 16.437186999999994
step: 9, name: ForkPoolWorker-10, step: 21000, time: 16.555885000000103
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.40392600000007
step: 1, name: ForkPoolWorker-2, step: 21000, time: 16.745797999999922
step: 3, name: ForkPoolWorker-4, step: 21000, time: 16.575410000000034
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.483926999999994
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.47026299999993
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.353619999999978
step: 5, name: ForkPoolWorker-6, step: 22000, time: 19.123823000000016
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.37627299999997
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.97909299999992
step: 4, name: ForkPoolWorker-5, step: 22000, time: 19.008137000000033
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.369995000000017
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.93832699999996
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.77608399999997
step: 1, name: ForkPoolWorker-2, step: 22000, time: 19.183138999999983
step: 3, name: ForkPoolWorker-4, step: 22000, time: 19.1280569999999
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.775320999999963
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.844790999999987
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.462563000000046
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.863598000000025
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.663659000000052
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.636832000000027
step: 6, name: ForkPoolWorker-7, step: 23000, time: 14.651725000000056
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.649650999999949
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.76890000000003
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.737472999999909
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.513406000000032
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.510757000000012
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.53409099999999
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.93198700000005
step: 8, name: ForkPoolWorker-9, step: 24000, time: 13.117755999999986
step: 4, name: ForkPoolWorker-5, step: 24000, time: 13.203242000000046
step: 6, name: ForkPoolWorker-7, step: 24000, time: 13.049218999999994
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.866073000000029
step: 1, name: ForkPoolWorker-2, step: 24000, time: 13.206837999999948
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.929662000000008
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.591244999999958
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.52301
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.472099999999955
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.715648000000101
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.571222000000034
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.746371999999951
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.690454000000045
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.787850000000049
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.49839499999996
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.647944000000052
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.663748999999939
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.395553000000064
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.433573000000024
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.656542999999942
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.692037000000028
step: 2, name: ForkPoolWorker-3, step: 28000, time: 10.120252999999934
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.819797999999992
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.844513000000006
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.949793
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.787815000000023
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.797628000000032
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.058562999999936
step: 7, name: ForkPoolWorker-8, step: 28000, time: 10.037976000000072
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.589497999999935
step: 2, name: ForkPoolWorker-3, step: 29000, time: 8.977047999999968
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.715765999999917
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.861848000000009
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.595659000000069
step: 0, name: ForkPoolWorker-1, step: 29000, time: 8.952034000000026
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.973202000000015
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.738142999999923
step: 7, name: ForkPoolWorker-8, step: 29000, time: 8.95182299999999
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.655990999999972
step: 2, name: ForkPoolWorker-3, step: 30000, time: 9.051485999999954
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.313971000000038
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.150751000000014
step: 4, name: ForkPoolWorker-5, step: 28000, time: 10.406586999999945
step: 8, name: ForkPoolWorker-9, step: 28000, time: 10.678840000000037
step: 6, name: ForkPoolWorker-7, step: 28000, time: 10.433790999999928
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.113923999999997
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.814452999999958
step: 1, name: ForkPoolWorker-2, step: 28000, time: 10.736358999999993
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.796454999999924
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.92945199999997
step: 5, name: ForkPoolWorker-6, step: 29000, time: 9.395085999999992
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.754269000000022
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.750935000000027
step: 4, name: ForkPoolWorker-5, step: 29000, time: 9.587766999999985
step: 8, name: ForkPoolWorker-9, step: 29000, time: 9.299616000000015
step: 6, name: ForkPoolWorker-7, step: 29000, time: 9.294534999999996
step: 9, name: ForkPoolWorker-10, step: 29000, time: 9.234290999999985
step: 1, name: ForkPoolWorker-2, step: 29000, time: 9.285316999999964
step: 3, name: ForkPoolWorker-4, step: 29000, time: 9.336910999999986
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.494105999999988
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.47462500000006
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.497351999999978
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.538697999999954
step: 8, name: ForkPoolWorker-9, step: 30000, time: 9.369371000000001
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.403858000000014
step: 6, name: ForkPoolWorker-7, step: 30000, time: 9.360326999999984
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.314882000000011
step: 2, name: ForkPoolWorker-3, step: 33000, time: 8.17498599999999
step: 1, name: ForkPoolWorker-2, step: 30000, time: 9.263092000000029
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.48072000000002
step: 0, name: ForkPoolWorker-1, step: 33000, time: 8.200695999999994
step: 7, name: ForkPoolWorker-8, step: 33000, time: 8.193861999999967
step: 5, name: ForkPoolWorker-6, step: 31000, time: 9.094425999999999
step: 2, name: ForkPoolWorker-3, step: 34000, time: 7.733748999999989
step: 8, name: ForkPoolWorker-9, step: 31000, time: 9.086922999999956
step: 6, name: ForkPoolWorker-7, step: 31000, time: 9.056010000000015
step: 4, name: ForkPoolWorker-5, step: 31000, time: 9.143063999999981
step: 9, name: ForkPoolWorker-10, step: 31000, time: 9.13798399999996
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.964120999999977
step: 0, name: ForkPoolWorker-1, step: 34000, time: 7.667770000000019
step: 3, name: ForkPoolWorker-4, step: 31000, time: 9.129261000000042
step: 7, name: ForkPoolWorker-8, step: 34000, time: 7.716365999999994
callback function result type: <class 'list'>, size: 48951
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.991563999999926
callback function result type: <class 'list'>, size: 48951
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.393736999999987
step: 8, name: ForkPoolWorker-9, step: 32000, time: 8.502966000000015
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.65793700000006
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.244626999999923
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.275404000000094
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.250919999999951
step: 5, name: ForkPoolWorker-6, step: 33000, time: 7.27814699999999
step: 6, name: ForkPoolWorker-7, step: 33000, time: 7.068650999999932
step: 8, name: ForkPoolWorker-9, step: 33000, time: 7.191899000000035
step: 4, name: ForkPoolWorker-5, step: 33000, time: 7.023685999999998
step: 9, name: ForkPoolWorker-10, step: 33000, time: 7.037115999999969
step: 1, name: ForkPoolWorker-2, step: 33000, time: 7.1130549999999175
step: 3, name: ForkPoolWorker-4, step: 33000, time: 6.790971999999897
step: 5, name: ForkPoolWorker-6, step: 34000, time: 6.715489000000048
step: 6, name: ForkPoolWorker-7, step: 34000, time: 6.755229999999983
step: 8, name: ForkPoolWorker-9, step: 34000, time: 6.785751000000005
step: 4, name: ForkPoolWorker-5, step: 34000, time: 6.878293999999983
step: 9, name: ForkPoolWorker-10, step: 34000, time: 6.868219000000067
step: 3, name: ForkPoolWorker-4, step: 34000, time: 6.3119740000000775
step: 1, name: ForkPoolWorker-2, step: 34000, time: 6.787194999999997
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:47.787903
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38538 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:604: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 16:19:27.232370 140299083372352 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:499: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 16:19:27.232572 140299083372352 deprecation_wrapper.py:119] From run.py:499: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 16:19:27.232819 140299083372352 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:510: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 16:19:27.233509 140299083372352 deprecation_wrapper.py:119] From run.py:510: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:514: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 16:19:27.233708 140299083372352 deprecation_wrapper.py:119] From run.py:514: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:523: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 16:19:27.236476 140299083372352 deprecation_wrapper.py:119] From run.py:523: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 16:19:27.236605 140299083372352 run.py:523] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 16:19:27.236707 140299083372352 run.py:525]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 16:19:27.236819 140299083372352 run.py:527] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 16:19:27.236907 140299083372352 run.py:529]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f9947ed0750>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 16:19:27.289453 140299083372352 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f9947ed0750>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running evaluation *****
I0411 16:19:27.291915 140299083372352 run.py:574] ***** Running evaluation *****
INFO:tensorflow:  Batch size = 256
I0411 16:19:27.292052 140299083372352 run.py:575]   Batch size = 256
INFO:tensorflow:run init
I0411 16:19:27.292251 140299083372352 run.py:125] run init
WARNING:tensorflow:From run.py:439: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 16:19:27.313117 140299083372352 deprecation_wrapper.py:119] From run.py:439: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:485: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 16:19:27.334436 140299083372352 deprecation_wrapper.py:119] From run.py:485: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:492: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 16:19:27.340076 140299083372352 deprecation.py:323] From run.py:492: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 16:19:27.362363 140299083372352 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 16:19:27.362504 140299083372352 run.py:242] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 16:19:27.362635 140299083372352 run.py:245]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 16:19:27.362753 140299083372352 run.py:245]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 16:19:27.362864 140299083372352 run.py:245]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 16:19:27.362973 140299083372352 run.py:245]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 16:19:27.363081 140299083372352 run.py:245]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 16:19:27.363188 140299083372352 run.py:245]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 16:19:27.372156 140299083372352 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 16:19:27.373882 140299083372352 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 16:19:27.409441 140299083372352 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 16:19:27.916594 140299083372352 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 16:19:27.969731 140299083372352 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.008138 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f994405dd50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.044984 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f994405dd50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.087723 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f994405dd50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f994405dd50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.154757 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f9944085f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944014050>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f9944014050>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.207676 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f9944014050>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944014050>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eee4750>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993eee4750>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.245568 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993eee4750>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eee4750>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.304426 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993eb635d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.340323 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993eb635d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.375561 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993eb635d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993eb635d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.436987 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f9944085f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f9944085f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.494331 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993ea79350>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.556054 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993ea79350>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993ea79350>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993e8ecc50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f993e8ecc50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 16:19:28.643285 140299083372352 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f993e8ecc50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f993e8ecc50>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 16:19:28.694638 140299083372352 run.py:296] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 16:19:28.694818 140299083372352 run.py:302]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 16:19:28.695011 140299083372352 run.py:302]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 16:19:28.695196 140299083372352 run.py:302]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.695361 140299083372352 run.py:302]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.695565 140299083372352 run.py:302]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 16:19:28.695763 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 16:19:28.695927 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 16:19:28.696080 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 16:19:28.696235 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 16:19:28.696380 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 16:19:28.696528 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 16:19:28.696679 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 16:19:28.696829 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.696974 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.697118 140299083372352 run.py:302]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 16:19:28.697264 140299083372352 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 16:19:28.697418 140299083372352 run.py:302]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 16:19:28.697568 140299083372352 run.py:302]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 16:19:28.697722 140299083372352 run.py:302]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.697861 140299083372352 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.698003 140299083372352 run.py:302]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 16:19:28.698154 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 16:19:28.698302 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 16:19:28.698446 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 16:19:28.698663 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 16:19:28.698807 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 16:19:28.698955 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 16:19:28.699106 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 16:19:28.699249 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.699387 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.699574 140299083372352 run.py:302]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 16:19:28.699760 140299083372352 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 16:19:28.699921 140299083372352 run.py:302]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 16:19:28.700113 140299083372352 run.py:302]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 16:19:28.700266 140299083372352 run.py:302]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.700426 140299083372352 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.700584 140299083372352 run.py:302]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 16:19:28.700752 140299083372352 run.py:302]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 16:19:28.700904 140299083372352 run.py:302]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 16:19:28.701060 140299083372352 run.py:302]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 16:19:28.701226 140299083372352 run.py:302]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 16:19:28.701393 140299083372352 run.py:302]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From run.py:328: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy i            nstead.

W0411 16:19:28.708632 140299083372352 deprecation_wrapper.py:119] From run.py:328: The name tf.metrics.accuracy is depreca            ted. Please use tf.compat.v1.metrics.accuracy instead.

WARNING:tensorflow:From run.py:332: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

W0411 16:19:28.784887 140299083372352 deprecation_wrapper.py:119] From run.py:332: The name tf.metrics.mean is deprecated.             Please use tf.compat.v1.metrics.mean instead.

INFO:tensorflow:Done calling model_fn.
I0411 16:19:28.858435 140299083372352 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-04-11T16:19:28Z
I0411 16:19:28.883399 140299083372352 evaluation.py:255] Starting evaluation at 2022-04-11T16:19:28Z
load user history from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
load vocab from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch            _support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 16:19:29.302336 140299083372352 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and             will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Graph was finalized.
I0411 16:19:29.482716 140299083372352 monitored_session.py:240] Graph was finalized.
2022-04-11 16:19:29.483803: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 16:19:29.500932: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 16:19:29.503067: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5628dc130af0 executing computa            tions on platform Host. Devices:
2022-04-11 16:19:29.503108: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 16:19:29.505473: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 16:19:29.543483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 16:19:29.543894: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 16:19:29.545772: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
2022-04-11 16:19:29.547271: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcufft.so.10.0
2022-04-11 16:19:29.547714: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcurand.so.10.0
2022-04-11 16:19:29.550243: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusolver.so.10.0
2022-04-11 16:19:29.552545: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusparse.so.10.0
2022-04-11 16:19:29.558513: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudnn.so.7
2022-04-11 16:19:29.559728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 16:19:29.559782: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 16:19:29.811789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor wi            th strength 1 edge matrix:
2022-04-11 16:19:29.811836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 16:19:29.811850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 16:19:29.815857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:local            host/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bu            s id: 0000:82:00.0, compute capability: 6.1)
2022-04-11 16:19:29.818731: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5628de0baf60 executing computa            tions on platform CUDA. Devices:
2022-04-11 16:19:29.818754: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): NVIDIA TITAN X             (Pascal), Compute Capability 6.1
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 16:19:29.821177 140299083372352 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-28000
I0411 16:19:29.823213 140299083372352 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-28000
2022-04-11 16:19:30.880581: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0411 16:19:30.889758 140299083372352 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 16:19:30.915731 140299083372352 session_manager.py:502] Done running local_init_op.
WARNING:tensorflow:From run.py:174: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs             instead.

W0411 16:19:31.041857 140299083372352 deprecation_wrapper.py:119] From run.py:174: The name tf.train.SessionRunArgs is dep            recated. Please use tf.estimator.SessionRunArgs instead.

2022-04-11 16:19:31.268241: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
......................................................................................................................










^CTraceback (most recent call last):
  File "run.py", line 604, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 587, in main
    hooks=[EvalHooks()])
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 477, in eva            luate
    name=name)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 519, in _ac            tual_eval
    return _evaluate()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 508, in _ev            aluate
    output_dir=self.eval_dir(name))
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/estimator.py", line 1609, in _e            valuate_run
    config=self._session_config)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/evaluation.py", line 272, in _evaluate_onc            e
    session.run(eval_ops, feed_dict)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1252, in run
    run_metadata=run_metadata)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1338, in run
    return self._sess.run(*args, **kwargs)
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/monitored_session.py", line 1419, in run
    run_metadata=run_metadata))
  File "run.py", line 201, in after_run
    sampled_ids = [x for x in sampled_ids if x not in rated and x not in item_idx]
  File "run.py", line 201, in <listcomp>
    sampled_ids = [x for x in sampled_ids if x not in rated and x not in item_idx]
KeyboardInterrupt

(base) root@container-855111b90c-e179f175:~/BERT4Rec#
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 61.381384999999995
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 61.158022
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 61.399710999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 62.148596999999995
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 62.093159
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 62.273399000000005
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 62.828193000000006
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 62.693747
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 62.486669
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 63.32465199999999
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 1, name: ForkPoolWorker-2, step: 2000, time: 65.843212
step: 2, name: ForkPoolWorker-3, step: 2000, time: 65.78797599999999
step: 4, name: ForkPoolWorker-5, step: 2000, time: 65.936283
step: 5, name: ForkPoolWorker-6, step: 2000, time: 65.78559299999999
step: 0, name: ForkPoolWorker-1, step: 2000, time: 66.442414
step: 3, name: ForkPoolWorker-4, step: 2000, time: 66.542093
step: 7, name: ForkPoolWorker-8, step: 2000, time: 66.6517
step: 6, name: ForkPoolWorker-7, step: 2000, time: 67.02109800000001
step: 9, name: ForkPoolWorker-10, step: 2000, time: 66.602049
step: 8, name: ForkPoolWorker-9, step: 2000, time: 66.704934
step: 1, name: ForkPoolWorker-2, step: 3000, time: 53.25036299999999
step: 2, name: ForkPoolWorker-3, step: 3000, time: 53.31583900000001
step: 4, name: ForkPoolWorker-5, step: 3000, time: 53.23708500000001
step: 5, name: ForkPoolWorker-6, step: 3000, time: 52.991292999999985
step: 0, name: ForkPoolWorker-1, step: 3000, time: 53.499622999999985
step: 3, name: ForkPoolWorker-4, step: 3000, time: 53.04343500000002
step: 7, name: ForkPoolWorker-8, step: 3000, time: 53.32533700000002
step: 6, name: ForkPoolWorker-7, step: 3000, time: 53.47367
step: 9, name: ForkPoolWorker-10, step: 3000, time: 53.48059600000002
step: 8, name: ForkPoolWorker-9, step: 3000, time: 53.51929100000001
step: 1, name: ForkPoolWorker-2, step: 4000, time: 43.14143899999999
step: 2, name: ForkPoolWorker-3, step: 4000, time: 43.085072999999994
step: 4, name: ForkPoolWorker-5, step: 4000, time: 43.096295999999995
step: 5, name: ForkPoolWorker-6, step: 4000, time: 43.166563
step: 0, name: ForkPoolWorker-1, step: 4000, time: 43.00551299999998
step: 3, name: ForkPoolWorker-4, step: 4000, time: 43.239720000000005
step: 7, name: ForkPoolWorker-8, step: 4000, time: 43.11609499999997
step: 6, name: ForkPoolWorker-7, step: 4000, time: 43.322322000000014
step: 9, name: ForkPoolWorker-10, step: 4000, time: 43.201055
step: 8, name: ForkPoolWorker-9, step: 4000, time: 43.56884499999998
step: 1, name: ForkPoolWorker-2, step: 5000, time: 41.64953600000001
step: 2, name: ForkPoolWorker-3, step: 5000, time: 43.14401099999998
step: 5, name: ForkPoolWorker-6, step: 5000, time: 42.956953999999996
step: 4, name: ForkPoolWorker-5, step: 5000, time: 43.81262399999997
step: 0, name: ForkPoolWorker-1, step: 5000, time: 43.51500699999997
step: 3, name: ForkPoolWorker-4, step: 5000, time: 43.735784000000024
step: 7, name: ForkPoolWorker-8, step: 5000, time: 43.18382
step: 6, name: ForkPoolWorker-7, step: 5000, time: 43.66526699999997
step: 9, name: ForkPoolWorker-10, step: 5000, time: 43.91152200000002
step: 8, name: ForkPoolWorker-9, step: 5000, time: 43.40566700000002
step: 1, name: ForkPoolWorker-2, step: 6000, time: 38.42239600000005
step: 2, name: ForkPoolWorker-3, step: 6000, time: 38.836186999999995
step: 5, name: ForkPoolWorker-6, step: 6000, time: 39.25000799999998
step: 4, name: ForkPoolWorker-5, step: 6000, time: 39.656285000000025
step: 7, name: ForkPoolWorker-8, step: 6000, time: 38.83876899999996
step: 0, name: ForkPoolWorker-1, step: 6000, time: 39.65723600000001
step: 3, name: ForkPoolWorker-4, step: 6000, time: 39.94764599999996
step: 6, name: ForkPoolWorker-7, step: 6000, time: 39.558456999999976
step: 9, name: ForkPoolWorker-10, step: 6000, time: 39.529493
step: 8, name: ForkPoolWorker-9, step: 6000, time: 39.764588
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.14899600000001
step: 2, name: ForkPoolWorker-3, step: 7000, time: 30.341868000000034
step: 5, name: ForkPoolWorker-6, step: 7000, time: 31.017051000000038
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.882004999999992
step: 7, name: ForkPoolWorker-8, step: 7000, time: 30.121865000000014
step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.863698
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.91416499999997
step: 6, name: ForkPoolWorker-7, step: 7000, time: 30.669967000000042
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.788546999999994
step: 8, name: ForkPoolWorker-9, step: 7000, time: 30.809983999999986
step: 1, name: ForkPoolWorker-2, step: 8000, time: 32.93544400000002
step: 2, name: ForkPoolWorker-3, step: 8000, time: 32.92406199999999
step: 5, name: ForkPoolWorker-6, step: 8000, time: 33.787297000000024
step: 4, name: ForkPoolWorker-5, step: 8000, time: 33.37037499999997
step: 7, name: ForkPoolWorker-8, step: 8000, time: 33.07039900000001
step: 0, name: ForkPoolWorker-1, step: 8000, time: 33.189715999999976
step: 3, name: ForkPoolWorker-4, step: 8000, time: 33.460148000000004
step: 6, name: ForkPoolWorker-7, step: 8000, time: 33.571011
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.37434000000002
step: 8, name: ForkPoolWorker-9, step: 8000, time: 33.67052000000001
step: 1, name: ForkPoolWorker-2, step: 9000, time: 28.739531999999997
step: 2, name: ForkPoolWorker-3, step: 9000, time: 28.568099000000018
step: 5, name: ForkPoolWorker-6, step: 9000, time: 29.012576999999965
step: 7, name: ForkPoolWorker-8, step: 9000, time: 28.461546
step: 4, name: ForkPoolWorker-5, step: 9000, time: 28.811649999999986
step: 0, name: ForkPoolWorker-1, step: 9000, time: 28.651549000000045
step: 3, name: ForkPoolWorker-4, step: 9000, time: 29.045793000000003
step: 6, name: ForkPoolWorker-7, step: 9000, time: 28.55435399999999
step: 9, name: ForkPoolWorker-10, step: 9000, time: 28.79495800000001
step: 8, name: ForkPoolWorker-9, step: 9000, time: 28.860171999999977
step: 1, name: ForkPoolWorker-2, step: 10000, time: 27.661992999999995
step: 2, name: ForkPoolWorker-3, step: 10000, time: 27.63223899999997
step: 7, name: ForkPoolWorker-8, step: 10000, time: 27.58658700000001
step: 5, name: ForkPoolWorker-6, step: 10000, time: 28.05106699999999
step: 4, name: ForkPoolWorker-5, step: 10000, time: 27.955873999999994
step: 0, name: ForkPoolWorker-1, step: 10000, time: 27.89616000000001
step: 6, name: ForkPoolWorker-7, step: 10000, time: 27.661738000000014
step: 3, name: ForkPoolWorker-4, step: 10000, time: 28.030421999999987
step: 9, name: ForkPoolWorker-10, step: 10000, time: 27.958321000000012
step: 1, name: ForkPoolWorker-2, step: 11000, time: 20.375288000000012
step: 8, name: ForkPoolWorker-9, step: 10000, time: 28.08997999999997
step: 2, name: ForkPoolWorker-3, step: 11000, time: 20.451526
step: 7, name: ForkPoolWorker-8, step: 11000, time: 20.47693300000003
step: 5, name: ForkPoolWorker-6, step: 11000, time: 20.805383000000006
step: 4, name: ForkPoolWorker-5, step: 11000, time: 20.653513999999973
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.659130000000005
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.489705999999956
step: 3, name: ForkPoolWorker-4, step: 11000, time: 20.694069000000013
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.602390000000014
step: 8, name: ForkPoolWorker-9, step: 11000, time: 20.653413
step: 1, name: ForkPoolWorker-2, step: 12000, time: 25.39265800000004
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.227915999999993
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.39635100000004
step: 5, name: ForkPoolWorker-6, step: 12000, time: 25.38740100000001
step: 4, name: ForkPoolWorker-5, step: 12000, time: 25.338058999999987
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.70154500000001
step: 6, name: ForkPoolWorker-7, step: 12000, time: 25.44652400000001
step: 3, name: ForkPoolWorker-4, step: 12000, time: 25.611062000000004
step: 9, name: ForkPoolWorker-10, step: 12000, time: 25.48481099999998
step: 8, name: ForkPoolWorker-9, step: 12000, time: 25.28559200000001
step: 1, name: ForkPoolWorker-2, step: 13000, time: 30.63932600000004
step: 2, name: ForkPoolWorker-3, step: 13000, time: 30.892323000000033
step: 7, name: ForkPoolWorker-8, step: 13000, time: 30.546108000000004
step: 5, name: ForkPoolWorker-6, step: 13000, time: 30.776955999999984
step: 4, name: ForkPoolWorker-5, step: 13000, time: 30.808701999999982
step: 0, name: ForkPoolWorker-1, step: 13000, time: 30.96118100000001
step: 6, name: ForkPoolWorker-7, step: 13000, time: 30.534667999999954
step: 3, name: ForkPoolWorker-4, step: 13000, time: 30.721506000000034
step: 9, name: ForkPoolWorker-10, step: 13000, time: 30.615060000000028
step: 8, name: ForkPoolWorker-9, step: 13000, time: 30.777165000000025
step: 1, name: ForkPoolWorker-2, step: 14000, time: 27.71374700000007
step: 2, name: ForkPoolWorker-3, step: 14000, time: 27.718617999999992
step: 7, name: ForkPoolWorker-8, step: 14000, time: 27.78914199999997
step: 5, name: ForkPoolWorker-6, step: 14000, time: 27.858910000000037
step: 4, name: ForkPoolWorker-5, step: 14000, time: 28.186709000000064
step: 6, name: ForkPoolWorker-7, step: 14000, time: 27.823067999999978
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.168969000000004
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.31914900000004
step: 9, name: ForkPoolWorker-10, step: 14000, time: 28.058834999999988
step: 1, name: ForkPoolWorker-2, step: 15000, time: 22.045063000000027
step: 8, name: ForkPoolWorker-9, step: 14000, time: 28.213662
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.030042999999978
step: 7, name: ForkPoolWorker-8, step: 15000, time: 21.919894999999997
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.15798300000006
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.13668999999993
step: 6, name: ForkPoolWorker-7, step: 15000, time: 21.690898999999945
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.126326999999947
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.198646999999937
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.07985999999994
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.186679000000026
step: 9, name: ForkPoolWorker-10, step: 15000, time: 22.14592700000003
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.291218999999955
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.175929999999994
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.36358000000007
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.37996899999996
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.162094000000025
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.53371800000002
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.410387000000014
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.475595999999996
step: 1, name: ForkPoolWorker-2, step: 17000, time: 23.426568999999972
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.41596800000002
step: 2, name: ForkPoolWorker-3, step: 17000, time: 23.45410000000004
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.437987999999905
step: 5, name: ForkPoolWorker-6, step: 17000, time: 23.548029999999926
step: 4, name: ForkPoolWorker-5, step: 17000, time: 23.653617999999938
step: 1, name: ForkPoolWorker-2, step: 18000, time: 15.986493999999993
step: 6, name: ForkPoolWorker-7, step: 17000, time: 23.505188999999973
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.044828000000052
step: 0, name: ForkPoolWorker-1, step: 17000, time: 23.78679199999999
step: 3, name: ForkPoolWorker-4, step: 17000, time: 23.729584000000045
step: 9, name: ForkPoolWorker-10, step: 17000, time: 23.77370200000007
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.023301999999944
step: 8, name: ForkPoolWorker-9, step: 17000, time: 23.802864999999997
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.175748
step: 1, name: ForkPoolWorker-2, step: 19000, time: 14.85183399999994
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.31934100000001
step: 6, name: ForkPoolWorker-7, step: 18000, time: 16.043507999999974
step: 2, name: ForkPoolWorker-3, step: 19000, time: 14.93257200000005
step: 0, name: ForkPoolWorker-1, step: 18000, time: 16.201094000000012
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.23690899999997
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.315126000000078
step: 7, name: ForkPoolWorker-8, step: 19000, time: 14.907864000000018
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.18300899999997
step: 5, name: ForkPoolWorker-6, step: 19000, time: 14.989607999999976
step: 1, name: ForkPoolWorker-2, step: 20000, time: 15.441093999999907
step: 4, name: ForkPoolWorker-5, step: 19000, time: 15.064186000000063
step: 6, name: ForkPoolWorker-7, step: 19000, time: 14.899794000000043
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.348903000000064
step: 0, name: ForkPoolWorker-1, step: 19000, time: 15.077607000000057
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.060527999999977
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.457117999999923
step: 9, name: ForkPoolWorker-10, step: 19000, time: 15.07371599999999
step: 8, name: ForkPoolWorker-9, step: 19000, time: 15.05578700000001
step: 5, name: ForkPoolWorker-6, step: 20000, time: 15.594808999999941
step: 1, name: ForkPoolWorker-2, step: 21000, time: 15.79121699999996
step: 6, name: ForkPoolWorker-7, step: 20000, time: 15.435647000000017
step: 4, name: ForkPoolWorker-5, step: 20000, time: 15.520353
step: 2, name: ForkPoolWorker-3, step: 21000, time: 15.91846099999998
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.621465000000057
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.700997999999913
step: 7, name: ForkPoolWorker-8, step: 21000, time: 15.80469299999993
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.674347000000012
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.600288999999975
step: 5, name: ForkPoolWorker-6, step: 21000, time: 16.106071000000043
step: 6, name: ForkPoolWorker-7, step: 21000, time: 15.856019999999944
step: 4, name: ForkPoolWorker-5, step: 21000, time: 15.966023999999948
step: 1, name: ForkPoolWorker-2, step: 22000, time: 18.175229999999942
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.237122999999997
step: 0, name: ForkPoolWorker-1, step: 21000, time: 16.104513999999995
step: 3, name: ForkPoolWorker-4, step: 21000, time: 16.203066000000035
step: 9, name: ForkPoolWorker-10, step: 21000, time: 16.148483000000056
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.322111999999947
step: 8, name: ForkPoolWorker-9, step: 21000, time: 16.16156699999999
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.191354000000047
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.19797200000005
step: 5, name: ForkPoolWorker-6, step: 22000, time: 18.494128000000046
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.277143000000024
step: 4, name: ForkPoolWorker-5, step: 22000, time: 18.613287000000014
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.320319999999924
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.117600000000039
step: 3, name: ForkPoolWorker-4, step: 22000, time: 18.357605000000035
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.546406000000047
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.60715300000004
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.489074000000073
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.669540000000097
step: 6, name: ForkPoolWorker-7, step: 23000, time: 14.191254999999956
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.366458999999963
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.306378999999993
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.562810000000013
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.292682000000013
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.232754999999997
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.334054000000037
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.280598999999938
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.51209300000005
step: 6, name: ForkPoolWorker-7, step: 24000, time: 12.628867000000014
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.39373999999998
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.643220000000042
step: 4, name: ForkPoolWorker-5, step: 24000, time: 12.565249999999992
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.31886499999996
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.44539999999995
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.589691000000016
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.364759999999933
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.674199000000044
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.766065000000026
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.347096999999962
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.700461000000018
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.501921000000038
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.317866999999978
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.356151999999952
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.300377000000026
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.396575999999982
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.329750999999987
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.469605999999999
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.37326500000006
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.434734999999932
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.38988900000004
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.45904500000006
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.334741000000008
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.325910000000022
step: 1, name: ForkPoolWorker-2, step: 28000, time: 9.973191000000043
step: 2, name: ForkPoolWorker-3, step: 28000, time: 9.999909000000002
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.363047000000051
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.511049999999955
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.282534999999939
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.612967000000026
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.388401000000044
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.341743999999949
step: 1, name: ForkPoolWorker-2, step: 29000, time: 8.99836300000004
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.43617699999993
step: 7, name: ForkPoolWorker-8, step: 28000, time: 9.999582999999916
step: 2, name: ForkPoolWorker-3, step: 29000, time: 8.916656999999987
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.265411000000086
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.245100999999977
step: 6, name: ForkPoolWorker-7, step: 28000, time: 10.060893999999962
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.162297999999964
step: 1, name: ForkPoolWorker-2, step: 30000, time: 9.022362999999928
step: 7, name: ForkPoolWorker-8, step: 29000, time: 8.95099499999992
step: 4, name: ForkPoolWorker-5, step: 28000, time: 10.006818000000067
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.560300999999981
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.303981000000022
step: 2, name: ForkPoolWorker-3, step: 30000, time: 8.946181999999908
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.008851999999933
step: 6, name: ForkPoolWorker-7, step: 29000, time: 8.930441999999971
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.130415999999968
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.764812000000006
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.121721999999977
step: 5, name: ForkPoolWorker-6, step: 29000, time: 8.963727000000063
step: 4, name: ForkPoolWorker-5, step: 29000, time: 8.990859999999998
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.61870900000008
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.08776499999999
step: 8, name: ForkPoolWorker-9, step: 28000, time: 10.06149599999992
step: 0, name: ForkPoolWorker-1, step: 29000, time: 8.980024999999955
step: 1, name: ForkPoolWorker-2, step: 32000, time: 7.764340000000061
step: 6, name: ForkPoolWorker-7, step: 30000, time: 9.013537000000042
step: 3, name: ForkPoolWorker-4, step: 29000, time: 8.997263999999973
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.802028999999948
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.146623999999974
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.090689999999995
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.465651999999977
step: 9, name: ForkPoolWorker-10, step: 29000, time: 8.992607000000021
step: 8, name: ForkPoolWorker-9, step: 29000, time: 9.02189199999998
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.10638300000005
step: 1, name: ForkPoolWorker-2, step: 33000, time: 8.18226500000003
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.72788300000002
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.507999999999925
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.135447
step: 2, name: ForkPoolWorker-3, step: 33000, time: 8.161649000000011
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.793789999999944
step: 4, name: ForkPoolWorker-5, step: 31000, time: 8.881860999999958
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.08786699999996
step: 8, name: ForkPoolWorker-9, step: 30000, time: 9.246078000000011
step: 1, name: ForkPoolWorker-2, step: 34000, time: 7.701473999999962
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.815461000000028
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.478469000000018
step: 7, name: ForkPoolWorker-8, step: 33000, time: 8.161649000000011
step: 2, name: ForkPoolWorker-3, step: 34000, time: 7.621489999999994
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.802216999999928
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.532072999999968
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.53007500000001
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.750272999999993
callback function result type: <class 'list'>, size: 48951
step: 8, name: ForkPoolWorker-9, step: 31000, time: 8.743874000000005
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.349147000000016
step: 6, name: ForkPoolWorker-7, step: 33000, time: 7.562946000000011
step: 7, name: ForkPoolWorker-8, step: 34000, time: 7.055989000000068
step: 3, name: ForkPoolWorker-4, step: 32000, time: 7.945985999999948
step: 5, name: ForkPoolWorker-6, step: 33000, time: 7.5079339999999775
step: 4, name: ForkPoolWorker-5, step: 33000, time: 7.3299710000000005
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 32000, time: 7.497755999999981
step: 8, name: ForkPoolWorker-9, step: 32000, time: 7.297814000000017
step: 6, name: ForkPoolWorker-7, step: 34000, time: 6.191780999999992
step: 0, name: ForkPoolWorker-1, step: 33000, time: 7.118844000000081
step: 5, name: ForkPoolWorker-6, step: 34000, time: 6.390173000000004
step: 4, name: ForkPoolWorker-5, step: 34000, time: 6.52718799999991
step: 3, name: ForkPoolWorker-4, step: 33000, time: 6.960025999999971
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 33000, time: 6.642166000000088
step: 8, name: ForkPoolWorker-9, step: 33000, time: 7.097352999999998
callback function result type: <class 'list'>, size: 48951
step: 0, name: ForkPoolWorker-1, step: 34000, time: 6.395475000000033
callback function result type: <class 'list'>, size: 48951
step: 3, name: ForkPoolWorker-4, step: 34000, time: 6.378225999999927
callback function result type: <class 'list'>, size: 48951
step: 9, name: ForkPoolWorker-10, step: 34000, time: 6.236914999999954
step: 8, name: ForkPoolWorker-9, step: 34000, time: 6.1919410000000425
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:41.576981
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38537 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:606: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:501: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 18:19:49.108735 139847761344320 deprecation_wrapper.py:119] From run.py:501: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:501: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 18:19:49.108929 139847761344320 deprecation_wrapper.py:119] From run.py:501: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 18:19:49.109156 139847761344320 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:512: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 18:19:49.109844 139847761344320 deprecation_wrapper.py:119] From run.py:512: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:516: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 18:19:49.110035 139847761344320 deprecation_wrapper.py:119] From run.py:516: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:525: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 18:19:49.113086 139847761344320 deprecation_wrapper.py:119] From run.py:525: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 18:19:49.113195 139847761344320 run.py:525] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 18:19:49.113279 139847761344320 run.py:527]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 18:19:49.113355 139847761344320 run.py:529] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 18:19:49.113430 139847761344320 run.py:531]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f303b08c690>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 18:19:49.166568 139847761344320 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7f303b08c690>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running evaluation *****
I0411 18:19:49.169013 139847761344320 run.py:576] ***** Running evaluation *****
INFO:tensorflow:  Batch size = 256
I0411 18:19:49.169113 139847761344320 run.py:577]   Batch size = 256
INFO:tensorflow:run init
I0411 18:19:49.169330 139847761344320 run.py:125] run init
WARNING:tensorflow:From run.py:441: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 18:19:49.188461 139847761344320 deprecation_wrapper.py:119] From run.py:441: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:487: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 18:19:49.208102 139847761344320 deprecation_wrapper.py:119] From run.py:487: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:494: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 18:19:49.213108 139847761344320 deprecation.py:323] From run.py:494: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 18:19:49.235129 139847761344320 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 18:19:49.235265 139847761344320 run.py:244] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 18:19:49.235390 139847761344320 run.py:247]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 18:19:49.235520 139847761344320 run.py:247]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 18:19:49.235650 139847761344320 run.py:247]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 18:19:49.235791 139847761344320 run.py:247]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 18:19:49.235919 139847761344320 run.py:247]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 18:19:49.236032 139847761344320 run.py:247]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 18:19:49.244618 139847761344320 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 18:19:49.246397 139847761344320 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 18:19:49.281548 139847761344320 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 18:19:49.733345 139847761344320 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 18:19:49.779967 139847761344320 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1c50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1c50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:49.812865 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f30221a1c50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1c50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:49.840354 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f30221a1f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:49.867684 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f30221a1f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f30221a1f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:49.920415 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022164f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164610>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164610>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:49.965757 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022164610>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164610>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164c10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164c10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.001359 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022164c10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164c10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.055834 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022102fd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.084714 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022102fd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.113010 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022102fd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022102fd0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f302208cb10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f302208cb10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.166216 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f302208cb10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f302208cb10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164b50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164b50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.211339 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022164b50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164b50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164690>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164690>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.244507 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3022164690>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3022164690>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3021bf9e10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7f3021bf9e10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:19:50.315239 139847761344320 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7f3021bf9e10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7f3021bf9e10>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 18:19:50.360258 139847761344320 run.py:298] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 18:19:50.360410 139847761344320 run.py:304]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 18:19:50.360572 139847761344320 run.py:304]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 18:19:50.360724 139847761344320 run.py:304]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.360876 139847761344320 run.py:304]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.361005 139847761344320 run.py:304]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 18:19:50.361134 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 18:19:50.361265 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 18:19:50.361391 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 18:19:50.361519 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 18:19:50.361644 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 18:19:50.361773 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 18:19:50.361897 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 18:19:50.362024 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.362147 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.362268 139847761344320 run.py:304]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 18:19:50.362393 139847761344320 run.py:304]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 18:19:50.362538 139847761344320 run.py:304]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 18:19:50.362665 139847761344320 run.py:304]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 18:19:50.362797 139847761344320 run.py:304]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.362924 139847761344320 run.py:304]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.363049 139847761344320 run.py:304]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 18:19:50.363177 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 18:19:50.363308 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 18:19:50.363450 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 18:19:50.363649 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 18:19:50.363779 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 18:19:50.363925 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 18:19:50.364053 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 18:19:50.364181 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.364301 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.364422 139847761344320 run.py:304]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 18:19:50.364563 139847761344320 run.py:304]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 18:19:50.364693 139847761344320 run.py:304]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 18:19:50.364820 139847761344320 run.py:304]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 18:19:50.364956 139847761344320 run.py:304]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.365081 139847761344320 run.py:304]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.365206 139847761344320 run.py:304]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 18:19:50.365333 139847761344320 run.py:304]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 18:19:50.365463 139847761344320 run.py:304]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 18:19:50.365587 139847761344320 run.py:304]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 18:19:50.365712 139847761344320 run.py:304]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 18:19:50.365836 139847761344320 run.py:304]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From run.py:330: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy i            nstead.

W0411 18:19:50.372820 139847761344320 deprecation_wrapper.py:119] From run.py:330: The name tf.metrics.accuracy is depreca            ted. Please use tf.compat.v1.metrics.accuracy instead.

WARNING:tensorflow:From run.py:334: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

W0411 18:19:50.455899 139847761344320 deprecation_wrapper.py:119] From run.py:334: The name tf.metrics.mean is deprecated.             Please use tf.compat.v1.metrics.mean instead.

INFO:tensorflow:Done calling model_fn.
I0411 18:19:50.534541 139847761344320 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-04-11T18:19:50Z
I0411 18:19:50.558078 139847761344320 evaluation.py:255] Starting evaluation at 2022-04-11T18:19:50Z
load user history from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
load vocab from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch            _support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 18:19:50.885402 139847761344320 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and             will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Graph was finalized.
I0411 18:19:51.002308 139847761344320 monitored_session.py:240] Graph was finalized.
2022-04-11 18:19:51.002643: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 18:19:51.011173: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 18:19:51.013071: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558d6fbc1600 executing computa            tions on platform Host. Devices:
2022-04-11 18:19:51.013101: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 18:19:51.014812: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 18:19:51.051769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 18:19:51.052140: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 18:19:51.054048: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
2022-04-11 18:19:51.055644: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcufft.so.10.0
2022-04-11 18:19:51.056059: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcurand.so.10.0
2022-04-11 18:19:51.058616: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusolver.so.10.0
2022-04-11 18:19:51.060532: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusparse.so.10.0
2022-04-11 18:19:51.066543: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudnn.so.7
2022-04-11 18:19:51.067750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 18:19:51.067802: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 18:19:51.318096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor wi            th strength 1 edge matrix:
2022-04-11 18:19:51.318144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 18:19:51.318151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 18:19:51.319518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:local            host/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bu            s id: 0000:82:00.0, compute capability: 6.1)
2022-04-11 18:19:51.321858: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558d71b4c910 executing computa            tions on platform CUDA. Devices:
2022-04-11 18:19:51.321891: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): NVIDIA TITAN X             (Pascal), Compute Capability 6.1
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 18:19:51.326912 139847761344320 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-28000
I0411 18:19:51.328934 139847761344320 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-28000
2022-04-11 18:19:52.288574: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0411 18:19:52.297124 139847761344320 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 18:19:52.322301 139847761344320 session_manager.py:502] Done running local_init_op.
WARNING:tensorflow:From run.py:174: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs             instead.

W0411 18:19:52.440365 139847761344320 deprecation_wrapper.py:119] From run.py:174: The name tf.train.SessionRunArgs is dep            recated. Please use tf.estimator.SessionRunArgs instead.

2022-04-11 18:19:52.599538: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
..........................................................................................................................            ..........................................................................................................................            ...................................................................................................ndcg@1:0.00754969976097            4756, hit@1:0.007549699760974756， ndcg@5:0.0421688356267015, hit@5:0.06640237859266601, ndcg@10:0.06318394082087281, hit@            10:0.13251326298606658, ap:0.06488922078916759, valid_user:34306.0
INFO:tensorflow:Finished evaluation at 2022-04-11-18:20:34
I0411 18:20:34.032541 139847761344320 evaluation.py:275] Finished evaluation at 2022-04-11-18:20:34
INFO:tensorflow:Saving dict for global step 28000: global_step = 28000, loss = 26.290142, masked_lm_accuracy = 0.0, masked            _lm_loss = 26.290258
I0411 18:20:34.033167 139847761344320 estimator.py:2039] Saving dict for global step 28000: global_step = 28000, loss = 26            .290142, masked_lm_accuracy = 0.0, masked_lm_loss = 26.290258
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 28000: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps3            0-msl50-64/model.ckpt-28000
I0411 18:20:34.242108 139847761344320 estimator.py:2099] Saving 'checkpoint_path' summary for global step 28000: ~/BERT4Re            c/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-28000
INFO:tensorflow:***** Eval results *****
I0411 18:20:34.296799 139847761344320 run.py:594] ***** Eval results *****
INFO:tensorflow:{
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

I0411 18:20:34.297267 139847761344320 run.py:595] {
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

INFO:tensorflow:  global_step = 28000
I0411 18:20:34.297884 139847761344320 run.py:598]   global_step = 28000
INFO:tensorflow:  loss = 26.290142
I0411 18:20:34.298058 139847761344320 run.py:598]   loss = 26.290142
INFO:tensorflow:  masked_lm_accuracy = 0.0
I0411 18:20:34.298231 139847761344320 run.py:598]   masked_lm_accuracy = 0.0
INFO:tensorflow:  masked_lm_loss = 26.290258
I0411 18:20:34.298338 139847761344320 run.py:598]   masked_lm_loss = 26.290258
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 61.250936
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 61.976404
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 61.856635000000004
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 62.365708
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 61.659434
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 61.304639
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 62.274547
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 62.363511
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 63.102227
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 62.702464
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 0, name: ForkPoolWorker-1, step: 2000, time: 65.722258
step: 5, name: ForkPoolWorker-6, step: 2000, time: 65.87739499999999
step: 2, name: ForkPoolWorker-3, step: 2000, time: 66.02919200000002
step: 3, name: ForkPoolWorker-4, step: 2000, time: 66.18218299999998
step: 1, name: ForkPoolWorker-2, step: 2000, time: 66.310798
step: 4, name: ForkPoolWorker-5, step: 2000, time: 67.13547299999999
step: 6, name: ForkPoolWorker-7, step: 2000, time: 66.87282400000001
step: 9, name: ForkPoolWorker-10, step: 2000, time: 66.55833299999999
step: 7, name: ForkPoolWorker-8, step: 2000, time: 66.581772
step: 8, name: ForkPoolWorker-9, step: 2000, time: 66.74319999999999
step: 0, name: ForkPoolWorker-1, step: 3000, time: 53.14270900000001
step: 5, name: ForkPoolWorker-6, step: 3000, time: 52.99831799999998
step: 2, name: ForkPoolWorker-3, step: 3000, time: 53.090970999999996
step: 1, name: ForkPoolWorker-2, step: 3000, time: 52.645808999999986
step: 3, name: ForkPoolWorker-4, step: 3000, time: 53.114521999999994
step: 4, name: ForkPoolWorker-5, step: 3000, time: 53.43499
step: 6, name: ForkPoolWorker-7, step: 3000, time: 53.44060300000001
step: 7, name: ForkPoolWorker-8, step: 3000, time: 53.31564499999999
step: 8, name: ForkPoolWorker-9, step: 3000, time: 52.97056699999999
step: 9, name: ForkPoolWorker-10, step: 3000, time: 53.37392299999999
step: 0, name: ForkPoolWorker-1, step: 4000, time: 43.187208
step: 5, name: ForkPoolWorker-6, step: 4000, time: 43.15105199999999
step: 2, name: ForkPoolWorker-3, step: 4000, time: 43.14607800000002
step: 1, name: ForkPoolWorker-2, step: 4000, time: 43.152839
step: 3, name: ForkPoolWorker-4, step: 4000, time: 43.196928000000014
step: 4, name: ForkPoolWorker-5, step: 4000, time: 43.13056900000001
step: 6, name: ForkPoolWorker-7, step: 4000, time: 43.06031999999999
step: 9, name: ForkPoolWorker-10, step: 4000, time: 42.980051
step: 8, name: ForkPoolWorker-9, step: 4000, time: 43.03954399999998
step: 7, name: ForkPoolWorker-8, step: 4000, time: 43.17604
step: 0, name: ForkPoolWorker-1, step: 5000, time: 44.10513599999999
step: 5, name: ForkPoolWorker-6, step: 5000, time: 43.327721000000025
step: 2, name: ForkPoolWorker-3, step: 5000, time: 43.45573300000001
step: 1, name: ForkPoolWorker-2, step: 5000, time: 43.79459700000001
step: 3, name: ForkPoolWorker-4, step: 5000, time: 43.46966000000003
step: 6, name: ForkPoolWorker-7, step: 5000, time: 43.47678000000002
step: 4, name: ForkPoolWorker-5, step: 5000, time: 43.884093999999976
step: 9, name: ForkPoolWorker-10, step: 5000, time: 43.34748000000002
step: 8, name: ForkPoolWorker-9, step: 5000, time: 43.404424000000034
step: 7, name: ForkPoolWorker-8, step: 5000, time: 43.51644599999997
step: 0, name: ForkPoolWorker-1, step: 6000, time: 39.18907999999999
step: 5, name: ForkPoolWorker-6, step: 6000, time: 39.357729000000006
step: 2, name: ForkPoolWorker-3, step: 6000, time: 39.40496200000001
step: 1, name: ForkPoolWorker-2, step: 6000, time: 39.19783000000001
step: 3, name: ForkPoolWorker-4, step: 6000, time: 39.400198999999986
step: 6, name: ForkPoolWorker-7, step: 6000, time: 38.80376699999999
step: 9, name: ForkPoolWorker-10, step: 6000, time: 38.79322000000002
step: 8, name: ForkPoolWorker-9, step: 6000, time: 38.72859299999999
step: 4, name: ForkPoolWorker-5, step: 6000, time: 39.25778500000001
step: 7, name: ForkPoolWorker-8, step: 6000, time: 39.346637999999984
step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.972000000000037
step: 2, name: ForkPoolWorker-3, step: 7000, time: 30.736405999999988
step: 5, name: ForkPoolWorker-6, step: 7000, time: 30.819226000000015
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.83492799999999
step: 8, name: ForkPoolWorker-9, step: 7000, time: 29.239141000000018
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.919179000000042
step: 6, name: ForkPoolWorker-7, step: 7000, time: 30.160150999999985
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.29962599999999
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.674733000000003
step: 7, name: ForkPoolWorker-8, step: 7000, time: 30.95464199999998
step: 0, name: ForkPoolWorker-1, step: 8000, time: 33.36214799999999
step: 2, name: ForkPoolWorker-3, step: 8000, time: 33.33630400000004
step: 5, name: ForkPoolWorker-6, step: 8000, time: 33.30460599999998
step: 8, name: ForkPoolWorker-9, step: 8000, time: 33.06931199999997
step: 1, name: ForkPoolWorker-2, step: 8000, time: 33.643407000000025
step: 6, name: ForkPoolWorker-7, step: 8000, time: 32.942169999999976
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.01904300000001
step: 3, name: ForkPoolWorker-4, step: 8000, time: 33.35135100000002
step: 4, name: ForkPoolWorker-5, step: 8000, time: 33.48125799999997
step: 7, name: ForkPoolWorker-8, step: 8000, time: 33.677824000000044
step: 0, name: ForkPoolWorker-1, step: 9000, time: 28.736568000000034
step: 1, name: ForkPoolWorker-2, step: 9000, time: 28.511814000000015
step: 8, name: ForkPoolWorker-9, step: 9000, time: 28.666808000000003
step: 6, name: ForkPoolWorker-7, step: 9000, time: 28.663501999999994
step: 2, name: ForkPoolWorker-3, step: 9000, time: 28.851494000000002
step: 9, name: ForkPoolWorker-10, step: 9000, time: 28.40470899999997
step: 5, name: ForkPoolWorker-6, step: 9000, time: 28.86412100000001
step: 3, name: ForkPoolWorker-4, step: 9000, time: 28.669748000000027
step: 4, name: ForkPoolWorker-5, step: 9000, time: 28.73319300000003
step: 7, name: ForkPoolWorker-8, step: 9000, time: 28.872051999999996
step: 1, name: ForkPoolWorker-2, step: 10000, time: 27.589729999999975
step: 8, name: ForkPoolWorker-9, step: 10000, time: 27.639936000000034
step: 0, name: ForkPoolWorker-1, step: 10000, time: 27.951085000000035
step: 6, name: ForkPoolWorker-7, step: 10000, time: 27.70467500000001
step: 9, name: ForkPoolWorker-10, step: 10000, time: 27.70198700000003
step: 2, name: ForkPoolWorker-3, step: 10000, time: 27.894165999999984
step: 5, name: ForkPoolWorker-6, step: 10000, time: 27.967940999999996
step: 3, name: ForkPoolWorker-4, step: 10000, time: 27.981133
step: 4, name: ForkPoolWorker-5, step: 10000, time: 27.982928000000015
step: 7, name: ForkPoolWorker-8, step: 10000, time: 27.748518999999987
step: 1, name: ForkPoolWorker-2, step: 11000, time: 20.327150999999958
step: 8, name: ForkPoolWorker-9, step: 11000, time: 20.477884000000017
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.291237999999964
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.32298400000002
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.77353499999998
step: 2, name: ForkPoolWorker-3, step: 11000, time: 20.598165999999992
step: 5, name: ForkPoolWorker-6, step: 11000, time: 20.68032199999999
step: 3, name: ForkPoolWorker-4, step: 11000, time: 20.585329
step: 4, name: ForkPoolWorker-5, step: 11000, time: 20.655924000000027
step: 7, name: ForkPoolWorker-8, step: 11000, time: 20.735630000000015
step: 1, name: ForkPoolWorker-2, step: 12000, time: 25.05654800000002
step: 8, name: ForkPoolWorker-9, step: 12000, time: 25.262108000000012
step: 6, name: ForkPoolWorker-7, step: 12000, time: 25.272279999999967
step: 9, name: ForkPoolWorker-10, step: 12000, time: 25.254674999999963
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.642522999999983
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.554328000000055
step: 5, name: ForkPoolWorker-6, step: 12000, time: 25.39770999999996
step: 3, name: ForkPoolWorker-4, step: 12000, time: 25.282517999999982
step: 4, name: ForkPoolWorker-5, step: 12000, time: 25.616573000000017
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.522954000000027
step: 1, name: ForkPoolWorker-2, step: 13000, time: 29.756001000000026
step: 6, name: ForkPoolWorker-7, step: 13000, time: 30.398010999999997
step: 8, name: ForkPoolWorker-9, step: 13000, time: 30.788982000000033
step: 9, name: ForkPoolWorker-10, step: 13000, time: 30.70607199999995
step: 0, name: ForkPoolWorker-1, step: 13000, time: 30.997562000000016
step: 2, name: ForkPoolWorker-3, step: 13000, time: 30.475434000000007
step: 5, name: ForkPoolWorker-6, step: 13000, time: 30.76853299999999
step: 3, name: ForkPoolWorker-4, step: 13000, time: 30.78601299999997
step: 4, name: ForkPoolWorker-5, step: 13000, time: 31.037667999999996
step: 7, name: ForkPoolWorker-8, step: 13000, time: 31.007802999999967
step: 1, name: ForkPoolWorker-2, step: 14000, time: 27.923174000000017
step: 6, name: ForkPoolWorker-7, step: 14000, time: 27.638367000000073
step: 8, name: ForkPoolWorker-9, step: 14000, time: 27.821311000000037
step: 9, name: ForkPoolWorker-10, step: 14000, time: 27.935866000000033
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.245516000000066
step: 2, name: ForkPoolWorker-3, step: 14000, time: 28.158335000000022
step: 5, name: ForkPoolWorker-6, step: 14000, time: 28.117658000000006
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.173160999999936
step: 4, name: ForkPoolWorker-5, step: 14000, time: 28.128510000000006
step: 7, name: ForkPoolWorker-8, step: 14000, time: 28.48360500000001
step: 1, name: ForkPoolWorker-2, step: 15000, time: 21.920328999999924
step: 6, name: ForkPoolWorker-7, step: 15000, time: 22.065483000000086
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.0608390000001
step: 9, name: ForkPoolWorker-10, step: 15000, time: 22.017769999999928
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.379635000000007
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.39435900000001
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.238328000000024
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.19868900000006
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.29319499999997
step: 7, name: ForkPoolWorker-8, step: 15000, time: 22.36286999999993
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.2360349999999
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.13206100000002
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.297504000000004
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.183846000000017
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.340233000000012
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.302028000000064
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.457637999999974
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.43145299999992
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.534344000000033
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.481907999999976
step: 1, name: ForkPoolWorker-2, step: 17000, time: 23.46383000000003
step: 6, name: ForkPoolWorker-7, step: 17000, time: 23.23030700000004
step: 9, name: ForkPoolWorker-10, step: 17000, time: 23.284731999999963
step: 8, name: ForkPoolWorker-9, step: 17000, time: 23.86566899999991
step: 0, name: ForkPoolWorker-1, step: 17000, time: 24.00215700000001
step: 2, name: ForkPoolWorker-3, step: 17000, time: 23.758599000000004
step: 5, name: ForkPoolWorker-6, step: 17000, time: 23.793446000000017
step: 3, name: ForkPoolWorker-4, step: 17000, time: 23.881276999999955
step: 4, name: ForkPoolWorker-5, step: 17000, time: 23.811841999999956
step: 1, name: ForkPoolWorker-2, step: 18000, time: 16.01070100000004
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.556303999999955
step: 6, name: ForkPoolWorker-7, step: 18000, time: 16.04994700000009
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.125642999999968
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.158847000000037
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.07558199999994
step: 0, name: ForkPoolWorker-1, step: 18000, time: 16.314915000000042
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.14977399999998
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.259636
step: 1, name: ForkPoolWorker-2, step: 19000, time: 14.902977000000078
step: 6, name: ForkPoolWorker-7, step: 19000, time: 14.966307000000029
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.18789000000004
step: 9, name: ForkPoolWorker-10, step: 19000, time: 14.92146600000001
step: 8, name: ForkPoolWorker-9, step: 19000, time: 14.893633000000023
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.313534000000004
step: 0, name: ForkPoolWorker-1, step: 19000, time: 15.045330000000035
step: 2, name: ForkPoolWorker-3, step: 19000, time: 15.24535800000001
step: 5, name: ForkPoolWorker-6, step: 19000, time: 15.041613999999981
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.032809999999927
step: 1, name: ForkPoolWorker-2, step: 20000, time: 15.375991999999997
step: 6, name: ForkPoolWorker-7, step: 20000, time: 15.418299999999931
step: 4, name: ForkPoolWorker-5, step: 19000, time: 15.17283800000007
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.404839000000038
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.449658
step: 7, name: ForkPoolWorker-8, step: 19000, time: 14.981519999999932
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.668108999999959
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.571736999999985
step: 5, name: ForkPoolWorker-6, step: 20000, time: 15.707250999999928
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.528953000000001
step: 1, name: ForkPoolWorker-2, step: 21000, time: 15.863550000000032
step: 6, name: ForkPoolWorker-7, step: 21000, time: 15.832055000000082
step: 4, name: ForkPoolWorker-5, step: 20000, time: 15.632417000000032
step: 9, name: ForkPoolWorker-10, step: 21000, time: 15.805072999999993
step: 8, name: ForkPoolWorker-9, step: 21000, time: 15.79655799999989
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.570148000000017
step: 0, name: ForkPoolWorker-1, step: 21000, time: 16.113130999999953
step: 2, name: ForkPoolWorker-3, step: 21000, time: 16.123447000000056
step: 5, name: ForkPoolWorker-6, step: 21000, time: 16.010493999999994
step: 3, name: ForkPoolWorker-4, step: 21000, time: 15.996469000000047
step: 4, name: ForkPoolWorker-5, step: 21000, time: 16.03377499999999
step: 1, name: ForkPoolWorker-2, step: 22000, time: 18.214849999999956
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.15743199999997
step: 7, name: ForkPoolWorker-8, step: 21000, time: 16.00336900000002
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.150075000000015
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.234327000000008
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.486402999999996
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.438038000000006
step: 5, name: ForkPoolWorker-6, step: 22000, time: 18.489823
step: 3, name: ForkPoolWorker-4, step: 22000, time: 18.42235900000003
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.165881000000013
step: 6, name: ForkPoolWorker-7, step: 23000, time: 14.058853
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.169860000000085
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.146561999999903
step: 4, name: ForkPoolWorker-5, step: 22000, time: 18.602959000000055
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.582835000000046
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.448922999999922
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.46420599999999
step: 6, name: ForkPoolWorker-7, step: 24000, time: 11.966377999999963
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.64541399999996
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.325491000000056
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.636676999999963
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.387609999999995
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.58153500000003
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.418561000000068
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.321438000000057
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.261328000000049
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.238958000000025
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.68001599999991
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.65163300000006
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.248532999999952
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.756265999999982
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.272289999999998
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.727991999999972
step: 4, name: ForkPoolWorker-5, step: 24000, time: 12.795203000000015
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.769472999999948
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.458113000000026
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.348674999999957
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.265543999999977
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.378052000000025
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.433678999999984
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.492113000000018
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.470598999999993
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.496290999999928
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.218132000000082
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.614801000000057
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.468984999999975
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.667101000000002
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.19097899999997
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.147501999999918
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.722457000000077
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.517497999999932
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.689204000000018
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.7170440000001
step: 6, name: ForkPoolWorker-7, step: 28000, time: 9.926166999999964
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.535490999999979
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.001009000000067
step: 1, name: ForkPoolWorker-2, step: 28000, time: 10.425820000000044
step: 8, name: ForkPoolWorker-9, step: 28000, time: 9.950384999999983
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.624012000000107
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.334212999999977
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.275022000000035
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.374536000000035
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.263665999999944
step: 6, name: ForkPoolWorker-7, step: 29000, time: 8.863218999999958
step: 9, name: ForkPoolWorker-10, step: 29000, time: 8.900704000000019
step: 1, name: ForkPoolWorker-2, step: 29000, time: 9.004878000000076
step: 8, name: ForkPoolWorker-9, step: 29000, time: 8.855286999999976
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.305623999999966
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.384794000000056
step: 2, name: ForkPoolWorker-3, step: 28000, time: 10.115627000000018
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.138063999999986
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.10399499999994
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.15703300000007
step: 6, name: ForkPoolWorker-7, step: 30000, time: 8.969623999999953
step: 1, name: ForkPoolWorker-2, step: 30000, time: 9.004113000000075
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.007079999999974
step: 8, name: ForkPoolWorker-9, step: 30000, time: 8.95435800000007
step: 4, name: ForkPoolWorker-5, step: 28000, time: 10.129985000000033
step: 7, name: ForkPoolWorker-8, step: 28000, time: 10.091664000000037
step: 2, name: ForkPoolWorker-3, step: 29000, time: 8.92344700000001
step: 0, name: ForkPoolWorker-1, step: 29000, time: 9.036269999999945
step: 5, name: ForkPoolWorker-6, step: 29000, time: 8.990898000000016
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.690318999999931
step: 3, name: ForkPoolWorker-4, step: 29000, time: 9.116178999999988
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.647448999999938
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.649281999999971
step: 8, name: ForkPoolWorker-9, step: 31000, time: 8.66612500000008
step: 4, name: ForkPoolWorker-5, step: 29000, time: 9.056407000000036
step: 7, name: ForkPoolWorker-8, step: 29000, time: 9.100483999999938
step: 2, name: ForkPoolWorker-3, step: 30000, time: 9.120107000000075
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.049469000000045
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.42240599999991
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.291842999999972
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.14924099999996
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.360749999999939
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.349940999999944
step: 8, name: ForkPoolWorker-9, step: 32000, time: 8.349153000000001
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.197451000000001
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.28585499999997
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.902106000000003
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.748362000000043
step: 6, name: ForkPoolWorker-7, step: 33000, time: 8.118921999999998
step: 9, name: ForkPoolWorker-10, step: 33000, time: 8.093281000000047
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.891528999999991
step: 1, name: ForkPoolWorker-2, step: 33000, time: 8.081719000000021
step: 8, name: ForkPoolWorker-9, step: 33000, time: 8.059352999999987
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.83096599999999
step: 6, name: ForkPoolWorker-7, step: 34000, time: 7.584602000000018
step: 4, name: ForkPoolWorker-5, step: 31000, time: 8.855012999999985
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.510049999999978
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.508010000000013
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.806535999999937
step: 9, name: ForkPoolWorker-10, step: 34000, time: 7.623780000000011
step: 1, name: ForkPoolWorker-2, step: 34000, time: 7.59870699999999
step: 8, name: ForkPoolWorker-9, step: 34000, time: 7.557280999999989
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.564942000000087
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.585381999999981
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.084705999999983
callback function result type: <class 'list'>, size: 48951
step: 0, name: ForkPoolWorker-1, step: 33000, time: 7.7646799999999985
step: 2, name: ForkPoolWorker-3, step: 33000, time: 7.867590999999948
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.007601000000022
step: 5, name: ForkPoolWorker-6, step: 33000, time: 7.232116000000019
step: 3, name: ForkPoolWorker-4, step: 33000, time: 7.150218999999993
step: 0, name: ForkPoolWorker-1, step: 34000, time: 6.419022000000041
step: 4, name: ForkPoolWorker-5, step: 33000, time: 7.017898000000059
step: 2, name: ForkPoolWorker-3, step: 34000, time: 6.704507000000035
step: 7, name: ForkPoolWorker-8, step: 33000, time: 6.530607000000032
step: 5, name: ForkPoolWorker-6, step: 34000, time: 6.493065000000001
step: 3, name: ForkPoolWorker-4, step: 34000, time: 6.494448000000034
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
step: 7, name: ForkPoolWorker-8, step: 34000, time: 6.00162499999999
step: 4, name: ForkPoolWorker-5, step: 34000, time: 6.304935
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:43.587377000000004
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38538 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:612: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 18:48:12.506778 140589507581760 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 18:48:12.506954 140589507581760 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 18:48:12.507204 140589507581760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:518: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 18:48:12.507979 140589507581760 deprecation_wrapper.py:119] From run.py:518: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:522: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 18:48:12.508163 140589507581760 deprecation_wrapper.py:119] From run.py:522: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:531: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 18:48:12.510901 140589507581760 deprecation_wrapper.py:119] From run.py:531: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 18:48:12.511047 140589507581760 run.py:531] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 18:48:12.511150 140589507581760 run.py:533]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 18:48:12.511244 140589507581760 run.py:535] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 18:48:12.511335 140589507581760 run.py:537]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_s            eed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config'            : allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fdcfa8eb7d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 18:48:12.568472 140589507581760 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp            0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_ch            eckpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': N            one, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max            _worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at             0x7fdcfa8eb7d0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master':             '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 18:48:12.570821 140589507581760 run.py:571] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 18:48:12.570928 140589507581760 run.py:572]   Batch size = 256
INFO:tensorflow:Skipping training since max_steps has already saved.
I0411 18:48:12.575238 140589507581760 estimator.py:360] Skipping training since max_steps has already saved.
INFO:tensorflow:***** Running evaluation *****
I0411 18:48:12.575389 140589507581760 run.py:582] ***** Running evaluation *****
INFO:tensorflow:  Batch size = 256
I0411 18:48:12.575543 140589507581760 run.py:583]   Batch size = 256
INFO:tensorflow:run init
I0411 18:48:12.575667 140589507581760 run.py:125] run init
WARNING:tensorflow:From run.py:447: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 18:48:12.596306 140589507581760 deprecation_wrapper.py:119] From run.py:447: The name tf.FixedLenFeature is deprecat            ed. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:493: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example             instead.

W0411 18:48:12.617193 140589507581760 deprecation_wrapper.py:119] From run.py:493: The name tf.parse_single_example is dep            recated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:500: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a             future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 18:48:12.622483 140589507581760 deprecation.py:323] From run.py:500: to_int32 (from tensorflow.python.ops.math_ops)             is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 18:48:12.647874 140589507581760 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 18:48:12.648033 140589507581760 run.py:250] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 18:48:12.648164 140589507581760 run.py:253]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 18:48:12.648282 140589507581760 run.py:253]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 18:48:12.648395 140589507581760 run.py:253]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 18:48:12.648508 140589507581760 run.py:253]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 18:48:12.648616 140589507581760 run.py:253]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 18:48:12.648725 140589507581760 run.py:253]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.            variable_scope instead.

W0411 18:48:12.657403 140589507581760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variabl            e_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.ge            t_variable instead.

W0411 18:48:12.659100 140589507581760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_var            iable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.            v1.assert_less_equal instead.

W0411 18:48:12.696226 140589507581760 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_            less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 18:48:13.252751 140589507581760 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will             be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 18:48:13.312958 140589507581760 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.pyth            on.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.355137 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd9984f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.389739 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd9984f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.423239 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd9984f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9984f10>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd993a2d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd993a2d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.488758 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd993a2d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd993a2d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.546790 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd99adf50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adc90>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adc90>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.586305 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd99adc90>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adc90>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98da1d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98da1d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.644444 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd98da1d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98da1d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e5910>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e5910>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.674357 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd94e5910>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e5910>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e7590>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e7590>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.701398 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd94e7590>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd94e7590>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98cd0d0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98cd0d0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.763279 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd98cd0d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd98cd0d0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adad0>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adad0>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.814443 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd99adad0>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adad0>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.848154 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd99adf50>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd99adf50>>: Attribut            eError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9334610>> coul            d not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the v            erbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Den            se.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9334610>>: AttributeError: module 'gast' has no attribute             'Index'
W0411 18:48:13.920003 140589507581760 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core            .Dense object at 0x7fdcd9334610>> could not be transformed and will be executed as-is. Please report this to the AutgoGrap            h team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full outpu            t. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fdcd9334610>>: Attribut            eError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 18:48:13.969090 140589507581760 run.py:304] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 18:48:13.969296 140589507581760 run.py:310]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 18:48:13.969448 140589507581760 run.py:310]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 18:48:13.969590 140589507581760 run.py:310]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.969726 140589507581760 run.py:310]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.969891 140589507581760 run.py:310]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 18:48:13.970032 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 18:48:13.970168 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 18:48:13.970311 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 18:48:13.970446 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 18:48:13.970586 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 18:48:13.970714 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 18:48:13.970839 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 18:48:13.970965 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.971082 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.971200 140589507581760 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 18:48:13.971324 140589507581760 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 18:48:13.971493 140589507581760 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 18:48:13.971637 140589507581760 run.py:310]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 18:48:13.971811 140589507581760 run.py:310]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.971955 140589507581760 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.972098 140589507581760 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 18:48:13.972238 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 18:48:13.972360 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 18:48:13.972481 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64,             64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 18:48:13.972661 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 18:48:13.972779 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64            , 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 18:48:13.972928 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 18:48:13.973050 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (            64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 18:48:13.973195 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64            ,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.973311 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape =             (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.973426 140589507581760 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape             = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 18:48:13.973543 140589507581760 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64,             256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 18:48:13.973662 140589507581760 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 18:48:13.973778 140589507581760 run.py:310]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 18:48:13.973897 140589507581760 run.py:310]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.974028 140589507581760 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.974144 140589507581760 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 18:48:13.974263 140589507581760 run.py:310]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 18:48:13.974385 140589507581760 run.py:310]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 18:48:13.974503 140589507581760 run.py:310]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 18:48:13.974619 140589507581760 run.py:310]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 18:48:13.974742 140589507581760 run.py:310]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From run.py:336: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy i            nstead.

W0411 18:48:13.981451 140589507581760 deprecation_wrapper.py:119] From run.py:336: The name tf.metrics.accuracy is depreca            ted. Please use tf.compat.v1.metrics.accuracy instead.

WARNING:tensorflow:From run.py:340: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

W0411 18:48:14.064646 140589507581760 deprecation_wrapper.py:119] From run.py:340: The name tf.metrics.mean is deprecated.             Please use tf.compat.v1.metrics.mean instead.

INFO:tensorflow:Done calling model_fn.
I0411 18:48:14.144105 140589507581760 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-04-11T18:48:14Z
I0411 18:48:14.173542 140589507581760 evaluation.py:255] Starting evaluation at 2022-04-11T18:48:14Z
load user history from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
load vocab from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch            _support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 18:48:14.658963 140589507581760 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and             will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Graph was finalized.
I0411 18:48:14.798079 140589507581760 monitored_session.py:240] Graph was finalized.
2022-04-11 18:48:14.799484: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this             TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 18:48:14.822292: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 18:48:14.824572: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563de4fd0c10 executing computa            tions on platform Host. Devices:
2022-04-11 18:48:14.824598: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <u            ndefined>
2022-04-11 18:48:14.826218: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcuda.so.1
2022-04-11 18:48:14.866631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 18:48:14.867175: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 18:48:14.870196: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
2022-04-11 18:48:14.872326: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcufft.so.10.0
2022-04-11 18:48:14.872747: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcurand.so.10.0
2022-04-11 18:48:14.875262: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusolver.so.10.0
2022-04-11 18:48:14.877216: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcusparse.so.10.0
2022-04-11 18:48:14.883230: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudnn.so.7
2022-04-11 18:48:14.884454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 18:48:14.884506: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcudart.so.10.0
2022-04-11 18:48:15.223632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor wi            th strength 1 edge matrix:
2022-04-11 18:48:15.223682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 18:48:15.223697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 18:48:15.225658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:local            host/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bu            s id: 0000:82:00.0, compute capability: 6.1)
2022-04-11 18:48:15.228904: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563de6f5b650 executing computa            tions on platform CUDA. Devices:
2022-04-11 18:48:15.228929: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): NVIDIA TITAN X             (Pascal), Compute Capability 6.1
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_            exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 18:48:15.231390 140589507581760 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/pyt            hon/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and wi            ll be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-28000
I0411 18:48:15.233086 140589507581760 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df1            0-mpps30-msl50-64/model.ckpt-28000
2022-04-11 18:48:16.254201: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA            :CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that en            vvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cach            e=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0411 18:48:16.264217 140589507581760 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 18:48:16.302976 140589507581760 session_manager.py:502] Done running local_init_op.
WARNING:tensorflow:From run.py:178: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs             instead.

W0411 18:48:16.447810 140589507581760 deprecation_wrapper.py:119] From run.py:178: The name tf.train.SessionRunArgs is dep            recated. Please use tf.estimator.SessionRunArgs instead.

2022-04-11 18:48:16.672523: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic li            brary libcublas.so.10.0
..........................................................................................................................            ..........................................................................................................................            ...................................................................................................ndcg@1:0.00754969976097            4756, hit@1:0.007549699760974756， ndcg@5:0.0421688356267015, hit@5:0.06640237859266601, ndcg@10:0.06318394082087281, hit@            10:0.13251326298606658,  ndcg@20:0.08480808111180904, hit@20:0.21908704016790065,ap:0.06488922078916759, valid_user:34306.            0
INFO:tensorflow:Finished evaluation at 2022-04-11-18:48:58
I0411 18:48:58.374409 140589507581760 evaluation.py:275] Finished evaluation at 2022-04-11-18:48:58
INFO:tensorflow:Saving dict for global step 28000: global_step = 28000, loss = 26.290142, masked_lm_accuracy = 0.0, masked            _lm_loss = 26.290258
I0411 18:48:58.375090 140589507581760 estimator.py:2039] Saving dict for global step 28000: global_step = 28000, loss = 26            .290142, masked_lm_accuracy = 0.0, masked_lm_loss = 26.290258
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 28000: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps3            0-msl50-64/model.ckpt-28000
I0411 18:48:58.571466 140589507581760 estimator.py:2099] Saving 'checkpoint_path' summary for global step 28000: ~/BERT4Re            c/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-28000
INFO:tensorflow:***** Eval results *****
I0411 18:48:58.618258 140589507581760 run.py:600] ***** Eval results *****
INFO:tensorflow:{
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

I0411 18:48:58.618747 140589507581760 run.py:601] {
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

INFO:tensorflow:  global_step = 28000
I0411 18:48:58.619529 140589507581760 run.py:604]   global_step = 28000
INFO:tensorflow:  loss = 26.290142
I0411 18:48:58.619692 140589507581760 run.py:604]   loss = 26.290142
INFO:tensorflow:  masked_lm_accuracy = 0.0
I0411 18:48:58.619823 140589507581760 run.py:604]   masked_lm_accuracy = 0.0
INFO:tensorflow:  masked_lm_loss = 26.290258
I0411 18:48:58.619942 140589507581760 run.py:604]   masked_lm_loss = 26.290258
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 20.00
max:761, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 10]
[]
[]
[11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
[]
[]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46]
[]
[]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118]
[]
[]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169, 170, 171]
[]
[]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218, 218, 219]
[]
[]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[]
[]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 60.924234999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 60.501310000000004
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 62.00692900000001
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 62.179619
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 61.258221000000006
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 62.511922000000006
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 61.755165
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 62.552613
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 62.490324
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 62.477163999999995
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 0, name: ForkPoolWorker-1, step: 2000, time: 66.226934
step: 1, name: ForkPoolWorker-2, step: 2000, time: 65.606887
step: 2, name: ForkPoolWorker-3, step: 2000, time: 65.902007
step: 9, name: ForkPoolWorker-10, step: 2000, time: 65.73286300000001
step: 3, name: ForkPoolWorker-4, step: 2000, time: 65.95799
step: 4, name: ForkPoolWorker-5, step: 2000, time: 65.70929299999999
step: 6, name: ForkPoolWorker-7, step: 2000, time: 66.01023899999998
step: 5, name: ForkPoolWorker-6, step: 2000, time: 66.01543000000001
step: 7, name: ForkPoolWorker-8, step: 2000, time: 66.00563199999999
step: 8, name: ForkPoolWorker-9, step: 2000, time: 66.308147
step: 1, name: ForkPoolWorker-2, step: 3000, time: 53.31171699999999
step: 0, name: ForkPoolWorker-1, step: 3000, time: 53.588849999999994
step: 4, name: ForkPoolWorker-5, step: 3000, time: 52.824984
step: 9, name: ForkPoolWorker-10, step: 3000, time: 53.14890299999999
step: 2, name: ForkPoolWorker-3, step: 3000, time: 53.388633
step: 3, name: ForkPoolWorker-4, step: 3000, time: 53.091962000000024
step: 6, name: ForkPoolWorker-7, step: 3000, time: 53.140679000000006
step: 5, name: ForkPoolWorker-6, step: 3000, time: 52.810914999999994
step: 7, name: ForkPoolWorker-8, step: 3000, time: 52.874600999999984
step: 8, name: ForkPoolWorker-9, step: 3000, time: 53.133759999999995
step: 1, name: ForkPoolWorker-2, step: 4000, time: 43.00810999999999
step: 0, name: ForkPoolWorker-1, step: 4000, time: 43.116365
step: 4, name: ForkPoolWorker-5, step: 4000, time: 43.04691600000001
step: 2, name: ForkPoolWorker-3, step: 4000, time: 43.14712499999999
step: 9, name: ForkPoolWorker-10, step: 4000, time: 43.192481000000015
step: 3, name: ForkPoolWorker-4, step: 4000, time: 43.064683
step: 6, name: ForkPoolWorker-7, step: 4000, time: 43.13364100000001
step: 5, name: ForkPoolWorker-6, step: 4000, time: 42.92035900000002
step: 7, name: ForkPoolWorker-8, step: 4000, time: 43.064295999999985
step: 8, name: ForkPoolWorker-9, step: 4000, time: 43.087068999999985
step: 0, name: ForkPoolWorker-1, step: 5000, time: 43.519784999999985
step: 1, name: ForkPoolWorker-2, step: 5000, time: 43.81150400000001
step: 3, name: ForkPoolWorker-4, step: 5000, time: 43.352180000000004
step: 2, name: ForkPoolWorker-3, step: 5000, time: 43.40327500000001
step: 4, name: ForkPoolWorker-5, step: 5000, time: 43.571616000000006
step: 9, name: ForkPoolWorker-10, step: 5000, time: 43.37818500000003
step: 6, name: ForkPoolWorker-7, step: 5000, time: 43.215809999999976
step: 5, name: ForkPoolWorker-6, step: 5000, time: 43.210012000000006
step: 7, name: ForkPoolWorker-8, step: 5000, time: 43.275172000000026
step: 8, name: ForkPoolWorker-9, step: 5000, time: 43.52098200000003
step: 0, name: ForkPoolWorker-1, step: 6000, time: 38.897605999999996
step: 1, name: ForkPoolWorker-2, step: 6000, time: 39.14743800000002
step: 3, name: ForkPoolWorker-4, step: 6000, time: 39.06567799999999
step: 4, name: ForkPoolWorker-5, step: 6000, time: 39.065338
step: 2, name: ForkPoolWorker-3, step: 6000, time: 39.20887899999997
step: 6, name: ForkPoolWorker-7, step: 6000, time: 38.77808500000003
step: 9, name: ForkPoolWorker-10, step: 6000, time: 39.03839499999998
step: 5, name: ForkPoolWorker-6, step: 6000, time: 39.08610300000004
step: 7, name: ForkPoolWorker-8, step: 6000, time: 39.28272700000002
step: 8, name: ForkPoolWorker-9, step: 6000, time: 39.07180600000004
step: 0, name: ForkPoolWorker-1, step: 7000, time: 30.475582999999972
step: 1, name: ForkPoolWorker-2, step: 7000, time: 30.332668000000012
step: 3, name: ForkPoolWorker-4, step: 7000, time: 30.358168999999975
step: 4, name: ForkPoolWorker-5, step: 7000, time: 30.433163000000036
step: 6, name: ForkPoolWorker-7, step: 7000, time: 30.532283000000007
step: 9, name: ForkPoolWorker-10, step: 7000, time: 30.360617999999988
step: 2, name: ForkPoolWorker-3, step: 7000, time: 30.33104800000001
step: 5, name: ForkPoolWorker-6, step: 7000, time: 30.352889000000005
step: 7, name: ForkPoolWorker-8, step: 7000, time: 30.264222000000018
step: 8, name: ForkPoolWorker-9, step: 7000, time: 30.318791000000033
step: 0, name: ForkPoolWorker-1, step: 8000, time: 33.11313799999999
step: 1, name: ForkPoolWorker-2, step: 8000, time: 32.953322000000014
step: 4, name: ForkPoolWorker-5, step: 8000, time: 32.891774999999996
step: 3, name: ForkPoolWorker-4, step: 8000, time: 33.36712699999998
step: 6, name: ForkPoolWorker-7, step: 8000, time: 33.234983
step: 9, name: ForkPoolWorker-10, step: 8000, time: 33.244470000000035
step: 2, name: ForkPoolWorker-3, step: 8000, time: 33.17804699999999
step: 5, name: ForkPoolWorker-6, step: 8000, time: 33.10807299999999
step: 7, name: ForkPoolWorker-8, step: 8000, time: 33.245881999999995
step: 8, name: ForkPoolWorker-9, step: 8000, time: 33.125107999999955
step: 1, name: ForkPoolWorker-2, step: 9000, time: 28.640355999999997
step: 0, name: ForkPoolWorker-1, step: 9000, time: 28.786294999999996
step: 4, name: ForkPoolWorker-5, step: 9000, time: 28.744223999999974
step: 3, name: ForkPoolWorker-4, step: 9000, time: 28.560359000000005
step: 6, name: ForkPoolWorker-7, step: 9000, time: 28.45921199999998
step: 9, name: ForkPoolWorker-10, step: 9000, time: 28.81160299999999
step: 5, name: ForkPoolWorker-6, step: 9000, time: 28.796048999999982
step: 2, name: ForkPoolWorker-3, step: 9000, time: 28.721854000000008
step: 7, name: ForkPoolWorker-8, step: 9000, time: 28.32189999999997
step: 8, name: ForkPoolWorker-9, step: 9000, time: 28.65186299999999
step: 1, name: ForkPoolWorker-2, step: 10000, time: 27.755454999999984
step: 0, name: ForkPoolWorker-1, step: 10000, time: 27.915384000000017
step: 4, name: ForkPoolWorker-5, step: 10000, time: 27.804865000000007
step: 3, name: ForkPoolWorker-4, step: 10000, time: 27.80218000000002
step: 6, name: ForkPoolWorker-7, step: 10000, time: 27.948577
step: 9, name: ForkPoolWorker-10, step: 10000, time: 27.821675000000027
step: 5, name: ForkPoolWorker-6, step: 10000, time: 27.78899899999999
step: 7, name: ForkPoolWorker-8, step: 10000, time: 27.695103000000017
step: 2, name: ForkPoolWorker-3, step: 10000, time: 27.72141099999999
step: 8, name: ForkPoolWorker-9, step: 10000, time: 27.787037999999995
step: 1, name: ForkPoolWorker-2, step: 11000, time: 20.47426999999999
step: 0, name: ForkPoolWorker-1, step: 11000, time: 20.638620000000003
step: 4, name: ForkPoolWorker-5, step: 11000, time: 20.46349600000002
step: 3, name: ForkPoolWorker-4, step: 11000, time: 20.492997000000003
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.527522999999974
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.411793999999986
step: 5, name: ForkPoolWorker-6, step: 11000, time: 20.401047000000005
step: 7, name: ForkPoolWorker-8, step: 11000, time: 20.576330999999982
step: 2, name: ForkPoolWorker-3, step: 11000, time: 20.544078000000013
step: 8, name: ForkPoolWorker-9, step: 11000, time: 20.525762000000043
step: 1, name: ForkPoolWorker-2, step: 12000, time: 25.528531999999984
step: 0, name: ForkPoolWorker-1, step: 12000, time: 25.556259999999952
step: 4, name: ForkPoolWorker-5, step: 12000, time: 25.17911799999996
step: 3, name: ForkPoolWorker-4, step: 12000, time: 25.440354999999954
step: 6, name: ForkPoolWorker-7, step: 12000, time: 25.416075000000035
step: 5, name: ForkPoolWorker-6, step: 12000, time: 25.365481000000045
step: 7, name: ForkPoolWorker-8, step: 12000, time: 25.432186
step: 9, name: ForkPoolWorker-10, step: 12000, time: 25.391226000000017
step: 2, name: ForkPoolWorker-3, step: 12000, time: 25.518462
step: 8, name: ForkPoolWorker-9, step: 12000, time: 25.499795000000006
step: 1, name: ForkPoolWorker-2, step: 13000, time: 30.615492999999958
step: 0, name: ForkPoolWorker-1, step: 13000, time: 30.847489999999993
step: 4, name: ForkPoolWorker-5, step: 13000, time: 30.695641999999964
step: 3, name: ForkPoolWorker-4, step: 13000, time: 30.561601999999993
step: 6, name: ForkPoolWorker-7, step: 13000, time: 30.577052999999978
step: 5, name: ForkPoolWorker-6, step: 13000, time: 30.686650000000043
step: 7, name: ForkPoolWorker-8, step: 13000, time: 30.54838699999999
step: 9, name: ForkPoolWorker-10, step: 13000, time: 30.621866999999952
step: 2, name: ForkPoolWorker-3, step: 13000, time: 30.74063799999999
step: 8, name: ForkPoolWorker-9, step: 13000, time: 30.609944999999982
step: 1, name: ForkPoolWorker-2, step: 14000, time: 28.04775699999999
step: 0, name: ForkPoolWorker-1, step: 14000, time: 28.041342999999927
step: 4, name: ForkPoolWorker-5, step: 14000, time: 27.881681000000015
step: 3, name: ForkPoolWorker-4, step: 14000, time: 28.003548000000023
step: 6, name: ForkPoolWorker-7, step: 14000, time: 28.040640999999937
step: 5, name: ForkPoolWorker-6, step: 14000, time: 27.836568
step: 7, name: ForkPoolWorker-8, step: 14000, time: 27.990751999999986
step: 9, name: ForkPoolWorker-10, step: 14000, time: 27.952354000000014
step: 2, name: ForkPoolWorker-3, step: 14000, time: 27.978297999999995
step: 8, name: ForkPoolWorker-9, step: 14000, time: 28.092508000000066
step: 1, name: ForkPoolWorker-2, step: 15000, time: 22.027044000000046
step: 0, name: ForkPoolWorker-1, step: 15000, time: 22.15696600000001
step: 4, name: ForkPoolWorker-5, step: 15000, time: 22.059096000000068
step: 3, name: ForkPoolWorker-4, step: 15000, time: 22.30448100000001
step: 6, name: ForkPoolWorker-7, step: 15000, time: 22.22662200000002
step: 5, name: ForkPoolWorker-6, step: 15000, time: 22.15483800000004
step: 7, name: ForkPoolWorker-8, step: 15000, time: 22.213877000000025
step: 9, name: ForkPoolWorker-10, step: 15000, time: 22.160573
step: 2, name: ForkPoolWorker-3, step: 15000, time: 22.15379699999994
step: 8, name: ForkPoolWorker-9, step: 15000, time: 22.14588100000003
step: 1, name: ForkPoolWorker-2, step: 16000, time: 18.187644999999975
step: 0, name: ForkPoolWorker-1, step: 16000, time: 18.337308000000007
step: 4, name: ForkPoolWorker-5, step: 16000, time: 18.193993999999975
step: 6, name: ForkPoolWorker-7, step: 16000, time: 18.229107999999997
step: 3, name: ForkPoolWorker-4, step: 16000, time: 18.32874400000003
step: 5, name: ForkPoolWorker-6, step: 16000, time: 18.285450999999966
step: 7, name: ForkPoolWorker-8, step: 16000, time: 18.44275899999991
step: 9, name: ForkPoolWorker-10, step: 16000, time: 18.283473000000072
step: 2, name: ForkPoolWorker-3, step: 16000, time: 18.38320299999998
step: 8, name: ForkPoolWorker-9, step: 16000, time: 18.359924999999976
step: 1, name: ForkPoolWorker-2, step: 17000, time: 23.654003999999986
step: 0, name: ForkPoolWorker-1, step: 17000, time: 23.70043600000008
step: 4, name: ForkPoolWorker-5, step: 17000, time: 23.51348500000006
step: 6, name: ForkPoolWorker-7, step: 17000, time: 23.64754999999991
step: 3, name: ForkPoolWorker-4, step: 17000, time: 23.55685900000003
step: 5, name: ForkPoolWorker-6, step: 17000, time: 23.608250999999996
step: 7, name: ForkPoolWorker-8, step: 17000, time: 23.61350099999993
step: 9, name: ForkPoolWorker-10, step: 17000, time: 23.66950099999997
step: 2, name: ForkPoolWorker-3, step: 17000, time: 23.566571000000067
step: 8, name: ForkPoolWorker-9, step: 17000, time: 23.639710000000036
step: 1, name: ForkPoolWorker-2, step: 18000, time: 16.1304090000001
step: 0, name: ForkPoolWorker-1, step: 18000, time: 16.181415000000015
step: 4, name: ForkPoolWorker-5, step: 18000, time: 16.137828000000013
step: 6, name: ForkPoolWorker-7, step: 18000, time: 16.184463999999934
step: 3, name: ForkPoolWorker-4, step: 18000, time: 16.21662900000001
step: 5, name: ForkPoolWorker-6, step: 18000, time: 16.17578900000001
step: 7, name: ForkPoolWorker-8, step: 18000, time: 16.262606000000005
step: 9, name: ForkPoolWorker-10, step: 18000, time: 16.221547999999984
step: 2, name: ForkPoolWorker-3, step: 18000, time: 16.124600999999984
step: 8, name: ForkPoolWorker-9, step: 18000, time: 16.189200000000028
step: 1, name: ForkPoolWorker-2, step: 19000, time: 15.060344999999984
step: 0, name: ForkPoolWorker-1, step: 19000, time: 14.951512999999977
step: 4, name: ForkPoolWorker-5, step: 19000, time: 14.959659999999985
step: 6, name: ForkPoolWorker-7, step: 19000, time: 15.07873399999994
step: 3, name: ForkPoolWorker-4, step: 19000, time: 15.029998999999975
step: 5, name: ForkPoolWorker-6, step: 19000, time: 15.092309
step: 7, name: ForkPoolWorker-8, step: 19000, time: 14.976289000000065
step: 9, name: ForkPoolWorker-10, step: 19000, time: 15.203427000000033
step: 2, name: ForkPoolWorker-3, step: 19000, time: 15.051451000000043
step: 8, name: ForkPoolWorker-9, step: 19000, time: 15.118490000000065
step: 1, name: ForkPoolWorker-2, step: 20000, time: 15.495574000000033
step: 0, name: ForkPoolWorker-1, step: 20000, time: 15.70529799999997
step: 4, name: ForkPoolWorker-5, step: 20000, time: 15.530073000000016
step: 6, name: ForkPoolWorker-7, step: 20000, time: 15.455544999999915
step: 3, name: ForkPoolWorker-4, step: 20000, time: 15.536542999999938
step: 5, name: ForkPoolWorker-6, step: 20000, time: 15.444568000000004
step: 7, name: ForkPoolWorker-8, step: 20000, time: 15.449540999999954
step: 9, name: ForkPoolWorker-10, step: 20000, time: 15.614970999999969
step: 2, name: ForkPoolWorker-3, step: 20000, time: 15.530678999999964
step: 8, name: ForkPoolWorker-9, step: 20000, time: 15.430280000000039
step: 1, name: ForkPoolWorker-2, step: 21000, time: 15.896389999999997
step: 0, name: ForkPoolWorker-1, step: 21000, time: 15.981845000000021
step: 4, name: ForkPoolWorker-5, step: 21000, time: 15.941196999999988
step: 6, name: ForkPoolWorker-7, step: 21000, time: 15.96369500000003
step: 3, name: ForkPoolWorker-4, step: 21000, time: 15.912494999999922
step: 5, name: ForkPoolWorker-6, step: 21000, time: 15.846702999999934
step: 7, name: ForkPoolWorker-8, step: 21000, time: 15.899372999999969
step: 9, name: ForkPoolWorker-10, step: 21000, time: 16.05560200000002
step: 2, name: ForkPoolWorker-3, step: 21000, time: 15.887213999999972
step: 8, name: ForkPoolWorker-9, step: 21000, time: 16.016425000000027
step: 1, name: ForkPoolWorker-2, step: 22000, time: 18.143282
step: 0, name: ForkPoolWorker-1, step: 22000, time: 18.411432999999988
step: 4, name: ForkPoolWorker-5, step: 22000, time: 18.360802000000035
step: 6, name: ForkPoolWorker-7, step: 22000, time: 18.240339999999946
step: 3, name: ForkPoolWorker-4, step: 22000, time: 18.525355999999988
step: 7, name: ForkPoolWorker-8, step: 22000, time: 18.307522000000063
step: 5, name: ForkPoolWorker-6, step: 22000, time: 18.33435200000008
step: 9, name: ForkPoolWorker-10, step: 22000, time: 18.421824000000015
step: 2, name: ForkPoolWorker-3, step: 22000, time: 18.317908999999986
step: 8, name: ForkPoolWorker-9, step: 22000, time: 18.534309000000007
step: 1, name: ForkPoolWorker-2, step: 23000, time: 14.000970000000052
step: 0, name: ForkPoolWorker-1, step: 23000, time: 14.34244000000001
step: 4, name: ForkPoolWorker-5, step: 23000, time: 14.200219999999945
step: 6, name: ForkPoolWorker-7, step: 23000, time: 13.639724999999999
step: 5, name: ForkPoolWorker-6, step: 23000, time: 14.27809000000002
step: 3, name: ForkPoolWorker-4, step: 23000, time: 14.40770400000008
step: 7, name: ForkPoolWorker-8, step: 23000, time: 14.211066999999957
step: 9, name: ForkPoolWorker-10, step: 23000, time: 14.27673100000004
step: 2, name: ForkPoolWorker-3, step: 23000, time: 14.33517299999994
step: 8, name: ForkPoolWorker-9, step: 23000, time: 14.186701999999968
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.705400999999938
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.821057999999994
step: 4, name: ForkPoolWorker-5, step: 24000, time: 12.692945000000009
step: 6, name: ForkPoolWorker-7, step: 24000, time: 12.73119500000007
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.659524000000033
step: 3, name: ForkPoolWorker-4, step: 24000, time: 12.706830999999966
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.752753999999982
step: 9, name: ForkPoolWorker-10, step: 24000, time: 12.697880000000055
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.854070999999976
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.601863000000094
step: 1, name: ForkPoolWorker-2, step: 25000, time: 12.348917000000029
step: 0, name: ForkPoolWorker-1, step: 25000, time: 12.390201999999931
step: 4, name: ForkPoolWorker-5, step: 25000, time: 12.46244999999999
step: 6, name: ForkPoolWorker-7, step: 25000, time: 12.3892239999999
step: 5, name: ForkPoolWorker-6, step: 25000, time: 12.28958
step: 7, name: ForkPoolWorker-8, step: 25000, time: 12.231345000000033
step: 3, name: ForkPoolWorker-4, step: 25000, time: 12.370973000000049
step: 9, name: ForkPoolWorker-10, step: 25000, time: 12.393072000000075
step: 2, name: ForkPoolWorker-3, step: 25000, time: 12.33872800000006
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.342657999999915
step: 8, name: ForkPoolWorker-9, step: 25000, time: 12.354003999999918
step: 0, name: ForkPoolWorker-1, step: 26000, time: 10.410034999999993
step: 4, name: ForkPoolWorker-5, step: 26000, time: 10.364799000000062
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.378056000000015
step: 5, name: ForkPoolWorker-6, step: 26000, time: 10.395891000000006
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.43837899999994
step: 3, name: ForkPoolWorker-4, step: 26000, time: 10.338026000000013
step: 9, name: ForkPoolWorker-10, step: 26000, time: 10.37842599999999
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.434657000000016
step: 1, name: ForkPoolWorker-2, step: 27000, time: 10.313469999999938
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.53280600000005
step: 0, name: ForkPoolWorker-1, step: 27000, time: 10.320220999999947
step: 4, name: ForkPoolWorker-5, step: 27000, time: 10.283355000000029
step: 6, name: ForkPoolWorker-7, step: 27000, time: 10.289406999999983
step: 5, name: ForkPoolWorker-6, step: 27000, time: 10.288201999999956
step: 7, name: ForkPoolWorker-8, step: 27000, time: 10.284025999999926
step: 3, name: ForkPoolWorker-4, step: 27000, time: 10.217008999999962
step: 9, name: ForkPoolWorker-10, step: 27000, time: 10.355380999999966
step: 2, name: ForkPoolWorker-3, step: 27000, time: 10.315657999999985
step: 1, name: ForkPoolWorker-2, step: 28000, time: 10.056170000000066
step: 8, name: ForkPoolWorker-9, step: 27000, time: 10.356157000000053
step: 0, name: ForkPoolWorker-1, step: 28000, time: 10.089526999999975
step: 4, name: ForkPoolWorker-5, step: 28000, time: 9.983266999999955
step: 6, name: ForkPoolWorker-7, step: 28000, time: 10.034660999999915
step: 5, name: ForkPoolWorker-6, step: 28000, time: 10.076865999999995
step: 3, name: ForkPoolWorker-4, step: 28000, time: 10.059056999999939
step: 7, name: ForkPoolWorker-8, step: 28000, time: 10.148662999999942
step: 9, name: ForkPoolWorker-10, step: 28000, time: 10.121665999999891
step: 1, name: ForkPoolWorker-2, step: 29000, time: 8.983398999999963
step: 2, name: ForkPoolWorker-3, step: 28000, time: 10.035265999999979
step: 8, name: ForkPoolWorker-9, step: 28000, time: 10.111615999999913
step: 0, name: ForkPoolWorker-1, step: 29000, time: 9.027718999999934
step: 4, name: ForkPoolWorker-5, step: 29000, time: 9.064240999999924
step: 6, name: ForkPoolWorker-7, step: 29000, time: 8.852465000000052
step: 5, name: ForkPoolWorker-6, step: 29000, time: 9.05578099999991
step: 7, name: ForkPoolWorker-8, step: 29000, time: 8.881744000000026
step: 3, name: ForkPoolWorker-4, step: 29000, time: 8.95010400000001
step: 1, name: ForkPoolWorker-2, step: 30000, time: 8.961424999999963
step: 9, name: ForkPoolWorker-10, step: 29000, time: 8.995229999999992
step: 2, name: ForkPoolWorker-3, step: 29000, time: 8.935169999999971
step: 8, name: ForkPoolWorker-9, step: 29000, time: 8.92960000000005
step: 0, name: ForkPoolWorker-1, step: 30000, time: 9.027503000000024
step: 4, name: ForkPoolWorker-5, step: 30000, time: 9.024393000000032
step: 6, name: ForkPoolWorker-7, step: 30000, time: 9.014951999999994
step: 5, name: ForkPoolWorker-6, step: 30000, time: 9.078233999999952
step: 7, name: ForkPoolWorker-8, step: 30000, time: 9.090660999999955
step: 3, name: ForkPoolWorker-4, step: 30000, time: 9.073877000000039
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.71741499999996
step: 9, name: ForkPoolWorker-10, step: 30000, time: 9.131892999999991
step: 2, name: ForkPoolWorker-3, step: 30000, time: 9.007468000000017
step: 8, name: ForkPoolWorker-9, step: 30000, time: 9.057039000000032
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.739492000000041
step: 4, name: ForkPoolWorker-5, step: 31000, time: 8.75451600000008
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.73555900000008
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.849702999999977
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.736925000000042
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.743441999999959
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.401959000000033
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.756734000000051
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.647090000000048
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.66778499999998
step: 8, name: ForkPoolWorker-9, step: 31000, time: 8.799089999999978
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.478183999999942
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.528513999999973
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.438537999999994
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.56769399999996
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.431236000000013
step: 1, name: ForkPoolWorker-2, step: 33000, time: 8.156592000000046
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.52372600000001
step: 2, name: ForkPoolWorker-3, step: 32000, time: 8.591657999999939
step: 0, name: ForkPoolWorker-1, step: 33000, time: 8.163406000000009
step: 8, name: ForkPoolWorker-9, step: 32000, time: 8.48569800000007
step: 4, name: ForkPoolWorker-5, step: 33000, time: 8.15650699999992
step: 6, name: ForkPoolWorker-7, step: 33000, time: 8.199852999999962
step: 7, name: ForkPoolWorker-8, step: 33000, time: 8.249053000000004
step: 5, name: ForkPoolWorker-6, step: 33000, time: 8.154221000000007
step: 3, name: ForkPoolWorker-4, step: 33000, time: 8.18471599999998
step: 1, name: ForkPoolWorker-2, step: 34000, time: 7.7100920000000315
step: 9, name: ForkPoolWorker-10, step: 33000, time: 8.280598999999938
step: 2, name: ForkPoolWorker-3, step: 33000, time: 8.288643999999977
callback function result type: <class 'list'>, size: 48951
step: 0, name: ForkPoolWorker-1, step: 34000, time: 7.616081000000008
step: 4, name: ForkPoolWorker-5, step: 34000, time: 7.671219999999948
step: 8, name: ForkPoolWorker-9, step: 33000, time: 8.244957999999997
step: 6, name: ForkPoolWorker-7, step: 34000, time: 7.719749999999976
step: 7, name: ForkPoolWorker-8, step: 34000, time: 7.657387999999969
step: 3, name: ForkPoolWorker-4, step: 34000, time: 7.427286000000095
step: 5, name: ForkPoolWorker-6, step: 34000, time: 7.671930999999972
callback function result type: <class 'list'>, size: 48951
step: 2, name: ForkPoolWorker-3, step: 34000, time: 6.933270999999991
step: 9, name: ForkPoolWorker-10, step: 34000, time: 7.121956000000068
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
step: 8, name: ForkPoolWorker-9, step: 34000, time: 6.6193909999999505
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
callback function result type: <class 'list'>, size: 48951
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:538461; time:44.646212000000006
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info             instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecord            Writer instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3840 item_39001 item_5991 item_12056 item_39002 item_5942 item_30187 item_39003 item_5582 ite            m_11623 item_13659 item_13659 item_16579 [MASK]
INFO:tensorflow:info: 7925
INFO:tensorflow:input_ids: 1507 31999 440 25633 10199 8500 19970 32000 1426 5329 8136 8136 272 38537 0 0 0 0 0 0 0 0 0 0 0             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0             0 0 0
INFO:tensorflow:masked_lm_positions: 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3410 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0             0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
Traceback (most recent call last):
  File "gen_data_fin.py", line 145, in write_instance_to_example_files
    input_ids = vocab.convert_tokens_to_ids(instance.tokens)
  File "/root/BERT4Rec/vocab.py", line 47, in convert_tokens_to_ids
    return convert_by_vocab(self.token_to_ids, tokens)
  File "/root/BERT4Rec/vocab.py", line 8, in convert_by_vocab
    output.append(vocab[item])
KeyError: 'item_31600'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 581, in main
    force_last=False)
  File "gen_data_fin.py", line 495, in gen_samples
    [output_filename])
  File "gen_data_fin.py", line 147, in write_instance_to_example_files
    print(instance)
  File "gen_data_fin.py", line 118, in __str__
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 118, in <listcomp>
    s += "info: %s\n" % (" ".join([printable_text(x) for x in self.info]))
  File "gen_data_fin.py", line 75, in printable_text
    raise ValueError("Unsupported string type: %s" % (type(text)))
ValueError: Unsupported string type: <class 'int'>
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat            .v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook             instead.

WARNING:tensorflow:From run.py:612: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_v            erbosity instead.

W0411 19:29:12.407824 140327135352640 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.set_verbosity is de            precated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 19:29:12.408075 140327135352640 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.INFO is deprecated.             Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile             instead.

W0411 19:29:12.408340 140327135352640 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GF            ile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:518: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 19:29:12.409097 140327135352640 deprecation_wrapper.py:119] From run.py:518: The name tf.gfile.MakeDirs is deprecate            d. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:522: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 19:29:12.409470 140327135352640 deprecation_wrapper.py:119] From run.py:522: The name tf.gfile.Glob is deprecated. P            lease use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:531: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 19:29:12.412509 140327135352640 deprecation_wrapper.py:119] From run.py:531: The name tf.logging.info is deprecated.             Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 19:29:12.412833 140327135352640 run.py:531] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 19:29:12.413133 140327135352640 run.py:533]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 19:29:12.413401 140327135352640 run.py:535] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 19:29:12.413658 140327135352640 run.py:537]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
Traceback (most recent call last):
  File "run.py", line 612, in <module>
    tf.app.run()
  File "/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/root/miniconda3/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "run.py", line 547, in main
    with open(FLAGS.vocab_filename, 'rb') as input_file:
FileNotFoundError: [Errno 2] No such file or directory: './data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab'
(base) root@container-855111b90c-e179f175:~/BERT4Rec# conda activate bert
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 519, in main
    dataset = data_partition(output_dir+dataset_name+'.txt')
  File "/root/BERT4Rec/util.py", line 26, in data_partition
    tstInt = np.array(pickle.load(fs))
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 1384, in load
    return Unpickler(file).load()
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 864, in load
    dispatch[key](self)
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 892, in load_proto
    raise ValueError, "unsupported pickle protocol: %d" % proto
ValueError: unsupported pickle protocol: 4
checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
INFO:tensorflow:*** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
Traceback (most recent call last):
  File "run.py", line 612, in <module>
    tf.app.run()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "run.py", line 547, in main
    with open(FLAGS.vocab_filename, 'rb') as input_file:
IOError: [Errno 2] No such file or directory: './data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab'
(bert) root@container-855111b90c-e179f175:~/BERT4Rec#
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
Traceback (most recent call last):
  File "gen_data_fin.py", line 620, in <module>
    main()
  File "gen_data_fin.py", line 519, in main
    dataset = data_partition(output_dir+dataset_name+'.txt')
  File "/root/BERT4Rec/util.py", line 26, in data_partition
    tstInt = np.array(pickle.load(fs))
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 1384, in load
    return Unpickler(file).load()
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 864, in load
    dispatch[key](self)
  File "/root/miniconda3/envs/bert/lib/python2.7/pickle.py", line 892, in load_proto
    raise ValueError, "unsupported pickle protocol: %d" % proto
ValueError: unsupported pickle protocol: 4
checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
INFO:tensorflow:*** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
Traceback (most recent call last):
  File "run.py", line 612, in <module>
    tf.app.run()
  File "/root/miniconda3/envs/bert/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "run.py", line 547, in main
    with open(FLAGS.vocab_filename, 'rb') as input_file:
IOError: [Errno 2] No such file or directory: './data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab'
(bert) root@container-855111b90c-e179f175:~/BERT4Rec# conda activate base
(base) root@container-855111b90c-e179f175:~/BERT4Rec# ./run_beauty.sh
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) o            r '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)t            ype'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (typ            e, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) /             '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logg            ing.set_verbosity instead.

WARNING:tensorflow:From gen_data_fin.py:499: The name tf.logging.DEBUG is deprecated. Please use tf.compat.v1.logging.DEBU            G instead.

-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50
average sequence length: 18.58
max:759, min:3
len_train:34306, len_valid:34306, len_test:34306, usernum:34306, itemnum:46069
[1, 2, 3, 4, 5, 6, 7, 8, 9]
[9]
[10]
[11, 12, 13, 14, 15, 16, 17, 18, 19]
[20]
[21]
[22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44]
[45]
[46]
[47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 34, 74, 75, 7            6, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104            , 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116]
[117]
[118]
[119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 1            42, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166            , 167, 168, 169]
[170]
[171]
[172, 173, 174, 175, 176, 30, 177, 178, 179, 180, 181, 182, 183]
[184]
[185]
[186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209]
[210]
[211]
[212, 213, 214, 215, 216, 217, 218]
[218]
[219]
[220, 221, 222, 223, 224, 225, 226]
[227]
[228]
[229, 230, 231, 232, 233, 234, 235, 236, 237]
[238]
[239]
begin to generate train
gen_data_fin.py:266: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
document num: 34306
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:299: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 0, name: ForkPoolWorker-1, step: 1000, time: 36.941238999999996
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 1, name: ForkPoolWorker-2, step: 1000, time: 37.008244000000005
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 2, name: ForkPoolWorker-3, step: 1000, time: 37.632628000000004
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 3, name: ForkPoolWorker-4, step: 1000, time: 37.35738
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 4, name: ForkPoolWorker-5, step: 1000, time: 37.189889
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 5, name: ForkPoolWorker-6, step: 1000, time: 37.383717
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 6, name: ForkPoolWorker-7, step: 1000, time: 37.537359
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 7, name: ForkPoolWorker-8, step: 1000, time: 37.731316
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 8, name: ForkPoolWorker-9, step: 1000, time: 38.167744
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
gen_data_fin.py:304: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  print("step: {}, name: {}, step: {}, time: {}".format(step, multiprocessing.current_process().name, cnt, time.clock()-st            art_time))
step: 9, name: ForkPoolWorker-10, step: 1000, time: 37.733982
gen_data_fin.py:305: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8:             use time.perf_counter or time.process_time instead
  start_time = time.clock()
step: 1, name: ForkPoolWorker-2, step: 2000, time: 57.188537000000004
step: 0, name: ForkPoolWorker-1, step: 2000, time: 57.796115
step: 2, name: ForkPoolWorker-3, step: 2000, time: 56.99186400000001
step: 3, name: ForkPoolWorker-4, step: 2000, time: 57.03271099999999
step: 4, name: ForkPoolWorker-5, step: 2000, time: 57.168988000000006
step: 5, name: ForkPoolWorker-6, step: 2000, time: 56.940286
step: 6, name: ForkPoolWorker-7, step: 2000, time: 57.267275000000005
step: 7, name: ForkPoolWorker-8, step: 2000, time: 57.50605300000001
step: 9, name: ForkPoolWorker-10, step: 2000, time: 57.199526999999996
step: 8, name: ForkPoolWorker-9, step: 2000, time: 57.377077
step: 1, name: ForkPoolWorker-2, step: 3000, time: 51.673407999999995
step: 3, name: ForkPoolWorker-4, step: 3000, time: 51.41142799999999
step: 0, name: ForkPoolWorker-1, step: 3000, time: 52.189085000000006
step: 4, name: ForkPoolWorker-5, step: 3000, time: 51.30740499999999
step: 2, name: ForkPoolWorker-3, step: 3000, time: 51.625269
step: 5, name: ForkPoolWorker-6, step: 3000, time: 51.692330999999996
step: 6, name: ForkPoolWorker-7, step: 3000, time: 51.604939
step: 9, name: ForkPoolWorker-10, step: 3000, time: 51.277411
step: 7, name: ForkPoolWorker-8, step: 3000, time: 51.64784300000001
step: 8, name: ForkPoolWorker-9, step: 3000, time: 52.114919
step: 3, name: ForkPoolWorker-4, step: 4000, time: 41.505944
step: 4, name: ForkPoolWorker-5, step: 4000, time: 41.64852300000001
step: 0, name: ForkPoolWorker-1, step: 4000, time: 41.942417000000006
step: 1, name: ForkPoolWorker-2, step: 4000, time: 41.94745500000002
step: 2, name: ForkPoolWorker-3, step: 4000, time: 41.924352
step: 5, name: ForkPoolWorker-6, step: 4000, time: 42.24181999999999
step: 9, name: ForkPoolWorker-10, step: 4000, time: 41.524766
step: 6, name: ForkPoolWorker-7, step: 4000, time: 41.794224000000014
step: 7, name: ForkPoolWorker-8, step: 4000, time: 42.287712
step: 8, name: ForkPoolWorker-9, step: 4000, time: 41.87660100000002
step: 3, name: ForkPoolWorker-4, step: 5000, time: 40.655899000000005
step: 4, name: ForkPoolWorker-5, step: 5000, time: 40.45997400000002
step: 1, name: ForkPoolWorker-2, step: 5000, time: 41.144577
step: 0, name: ForkPoolWorker-1, step: 5000, time: 41.408113000000014
step: 2, name: ForkPoolWorker-3, step: 5000, time: 41.02701099999999
step: 9, name: ForkPoolWorker-10, step: 5000, time: 40.455882
step: 5, name: ForkPoolWorker-6, step: 5000, time: 41.297202999999996
step: 6, name: ForkPoolWorker-7, step: 5000, time: 40.959948
step: 7, name: ForkPoolWorker-8, step: 5000, time: 40.724276
step: 8, name: ForkPoolWorker-9, step: 5000, time: 41.04459
step: 3, name: ForkPoolWorker-4, step: 6000, time: 37.49896599999997
step: 4, name: ForkPoolWorker-5, step: 6000, time: 37.399899000000005
step: 0, name: ForkPoolWorker-1, step: 6000, time: 37.782859
step: 9, name: ForkPoolWorker-10, step: 6000, time: 37.62578100000002
step: 1, name: ForkPoolWorker-2, step: 6000, time: 38.039287
step: 2, name: ForkPoolWorker-3, step: 6000, time: 37.98039
step: 7, name: ForkPoolWorker-8, step: 6000, time: 37.43934900000002
step: 5, name: ForkPoolWorker-6, step: 6000, time: 37.935056
step: 6, name: ForkPoolWorker-7, step: 6000, time: 38.027660999999966
step: 8, name: ForkPoolWorker-9, step: 6000, time: 38.31453299999998
step: 3, name: ForkPoolWorker-4, step: 7000, time: 29.321407000000022
step: 4, name: ForkPoolWorker-5, step: 7000, time: 29.469407999999987
step: 0, name: ForkPoolWorker-1, step: 7000, time: 29.346806000000015
step: 9, name: ForkPoolWorker-10, step: 7000, time: 29.43860699999999
step: 1, name: ForkPoolWorker-2, step: 7000, time: 29.631163000000015
step: 2, name: ForkPoolWorker-3, step: 7000, time: 29.535679999999957
step: 7, name: ForkPoolWorker-8, step: 7000, time: 29.46873499999998
step: 5, name: ForkPoolWorker-6, step: 7000, time: 29.911743
step: 6, name: ForkPoolWorker-7, step: 7000, time: 29.50315800000004
step: 8, name: ForkPoolWorker-9, step: 7000, time: 29.509834999999953
step: 3, name: ForkPoolWorker-4, step: 8000, time: 31.964121999999975
step: 4, name: ForkPoolWorker-5, step: 8000, time: 32.153681000000006
step: 0, name: ForkPoolWorker-1, step: 8000, time: 31.93401
step: 9, name: ForkPoolWorker-10, step: 8000, time: 31.893772999999953
step: 1, name: ForkPoolWorker-2, step: 8000, time: 31.840122000000008
step: 7, name: ForkPoolWorker-8, step: 8000, time: 31.454682000000048
step: 2, name: ForkPoolWorker-3, step: 8000, time: 32.143619
step: 5, name: ForkPoolWorker-6, step: 8000, time: 32.107573
step: 6, name: ForkPoolWorker-7, step: 8000, time: 32.12223899999998
step: 8, name: ForkPoolWorker-9, step: 8000, time: 31.955849
step: 3, name: ForkPoolWorker-4, step: 9000, time: 27.276206000000002
step: 4, name: ForkPoolWorker-5, step: 9000, time: 27.313098000000025
step: 9, name: ForkPoolWorker-10, step: 9000, time: 27.12664699999999
step: 0, name: ForkPoolWorker-1, step: 9000, time: 27.42646400000001
step: 1, name: ForkPoolWorker-2, step: 9000, time: 27.442516999999953
step: 7, name: ForkPoolWorker-8, step: 9000, time: 27.334562000000005
step: 2, name: ForkPoolWorker-3, step: 9000, time: 27.437735000000032
step: 5, name: ForkPoolWorker-6, step: 9000, time: 27.38959
step: 6, name: ForkPoolWorker-7, step: 9000, time: 27.33872100000002
step: 8, name: ForkPoolWorker-9, step: 9000, time: 27.403746000000012
step: 3, name: ForkPoolWorker-4, step: 10000, time: 26.80931099999998
step: 4, name: ForkPoolWorker-5, step: 10000, time: 26.70304699999997
step: 9, name: ForkPoolWorker-10, step: 10000, time: 26.85621299999997
step: 0, name: ForkPoolWorker-1, step: 10000, time: 26.96429599999999
step: 7, name: ForkPoolWorker-8, step: 10000, time: 26.819909999999993
step: 1, name: ForkPoolWorker-2, step: 10000, time: 26.928260999999964
step: 2, name: ForkPoolWorker-3, step: 10000, time: 27.057268000000022
step: 5, name: ForkPoolWorker-6, step: 10000, time: 26.875374999999963
step: 6, name: ForkPoolWorker-7, step: 10000, time: 26.755097000000035
step: 8, name: ForkPoolWorker-9, step: 10000, time: 27.107477000000017
step: 3, name: ForkPoolWorker-4, step: 11000, time: 19.772801000000015
step: 4, name: ForkPoolWorker-5, step: 11000, time: 19.936267999999984
step: 9, name: ForkPoolWorker-10, step: 11000, time: 20.062730999999985
step: 7, name: ForkPoolWorker-8, step: 11000, time: 19.710217999999998
step: 0, name: ForkPoolWorker-1, step: 11000, time: 19.926558999999997
step: 1, name: ForkPoolWorker-2, step: 11000, time: 19.661629000000005
step: 2, name: ForkPoolWorker-3, step: 11000, time: 19.887646000000018
step: 5, name: ForkPoolWorker-6, step: 11000, time: 19.76986099999999
step: 6, name: ForkPoolWorker-7, step: 11000, time: 20.067549000000042
step: 8, name: ForkPoolWorker-9, step: 11000, time: 19.874570000000006
step: 3, name: ForkPoolWorker-4, step: 12000, time: 24.64389399999999
step: 4, name: ForkPoolWorker-5, step: 12000, time: 24.570609999999988
step: 9, name: ForkPoolWorker-10, step: 12000, time: 24.59299900000002
step: 7, name: ForkPoolWorker-8, step: 12000, time: 24.51956199999995
step: 0, name: ForkPoolWorker-1, step: 12000, time: 24.618040000000008
step: 1, name: ForkPoolWorker-2, step: 12000, time: 24.525991000000033
step: 5, name: ForkPoolWorker-6, step: 12000, time: 24.525760000000048
step: 2, name: ForkPoolWorker-3, step: 12000, time: 24.663298999999995
step: 6, name: ForkPoolWorker-7, step: 12000, time: 24.544961999999998
step: 8, name: ForkPoolWorker-9, step: 12000, time: 24.503108999999995
step: 3, name: ForkPoolWorker-4, step: 13000, time: 29.129520000000014
step: 4, name: ForkPoolWorker-5, step: 13000, time: 29.224036999999953
step: 9, name: ForkPoolWorker-10, step: 13000, time: 29.139382000000012
step: 7, name: ForkPoolWorker-8, step: 13000, time: 29.520696999999984
step: 1, name: ForkPoolWorker-2, step: 13000, time: 29.114735999999994
step: 0, name: ForkPoolWorker-1, step: 13000, time: 29.21700800000002
step: 5, name: ForkPoolWorker-6, step: 13000, time: 29.313652999999988
step: 2, name: ForkPoolWorker-3, step: 13000, time: 29.46662900000001
step: 6, name: ForkPoolWorker-7, step: 13000, time: 29.270884999999964
step: 8, name: ForkPoolWorker-9, step: 13000, time: 29.238293999999996
step: 3, name: ForkPoolWorker-4, step: 14000, time: 26.128881000000035
step: 4, name: ForkPoolWorker-5, step: 14000, time: 26.20429999999999
step: 9, name: ForkPoolWorker-10, step: 14000, time: 26.336554000000035
step: 7, name: ForkPoolWorker-8, step: 14000, time: 26.113027999999986
step: 1, name: ForkPoolWorker-2, step: 14000, time: 26.34166300000004
step: 0, name: ForkPoolWorker-1, step: 14000, time: 26.286129000000017
step: 5, name: ForkPoolWorker-6, step: 14000, time: 26.137096000000042
step: 2, name: ForkPoolWorker-3, step: 14000, time: 26.12974300000002
step: 6, name: ForkPoolWorker-7, step: 14000, time: 26.49438600000002
step: 8, name: ForkPoolWorker-9, step: 14000, time: 26.239036
step: 3, name: ForkPoolWorker-4, step: 15000, time: 21.010648000000003
step: 4, name: ForkPoolWorker-5, step: 15000, time: 21.014527999999984
step: 7, name: ForkPoolWorker-8, step: 15000, time: 20.94622099999998
step: 9, name: ForkPoolWorker-10, step: 15000, time: 21.14060699999999
step: 1, name: ForkPoolWorker-2, step: 15000, time: 21.175921000000017
step: 0, name: ForkPoolWorker-1, step: 15000, time: 21.180733999999973
step: 5, name: ForkPoolWorker-6, step: 15000, time: 21.056988000000047
step: 2, name: ForkPoolWorker-3, step: 15000, time: 21.160612000000015
step: 6, name: ForkPoolWorker-7, step: 15000, time: 21.103214999999977
step: 8, name: ForkPoolWorker-9, step: 15000, time: 21.243866999999966
step: 3, name: ForkPoolWorker-4, step: 16000, time: 17.461885999999993
step: 4, name: ForkPoolWorker-5, step: 16000, time: 17.437790999999947
step: 7, name: ForkPoolWorker-8, step: 16000, time: 17.42418200000003
step: 9, name: ForkPoolWorker-10, step: 16000, time: 17.37446
step: 1, name: ForkPoolWorker-2, step: 16000, time: 17.400070000000028
step: 0, name: ForkPoolWorker-1, step: 16000, time: 17.41756399999997
step: 5, name: ForkPoolWorker-6, step: 16000, time: 17.378535000000056
step: 2, name: ForkPoolWorker-3, step: 16000, time: 17.423958999999968
step: 6, name: ForkPoolWorker-7, step: 16000, time: 17.482387000000017
step: 8, name: ForkPoolWorker-9, step: 16000, time: 17.43395300000003
step: 3, name: ForkPoolWorker-4, step: 17000, time: 22.406765999999948
step: 4, name: ForkPoolWorker-5, step: 17000, time: 22.334570999999983
step: 7, name: ForkPoolWorker-8, step: 17000, time: 22.371561000000042
step: 9, name: ForkPoolWorker-10, step: 17000, time: 22.412373000000002
step: 1, name: ForkPoolWorker-2, step: 17000, time: 22.368786999999998
step: 0, name: ForkPoolWorker-1, step: 17000, time: 22.43002899999999
step: 5, name: ForkPoolWorker-6, step: 17000, time: 22.53941199999997
step: 2, name: ForkPoolWorker-3, step: 17000, time: 22.244842999999946
step: 6, name: ForkPoolWorker-7, step: 17000, time: 22.33524
step: 8, name: ForkPoolWorker-9, step: 17000, time: 22.244061999999985
step: 3, name: ForkPoolWorker-4, step: 18000, time: 15.332975000000033
step: 4, name: ForkPoolWorker-5, step: 18000, time: 15.376447999999982
step: 7, name: ForkPoolWorker-8, step: 18000, time: 15.334088000000065
step: 9, name: ForkPoolWorker-10, step: 18000, time: 15.357229000000075
step: 1, name: ForkPoolWorker-2, step: 18000, time: 15.306137999999919
step: 0, name: ForkPoolWorker-1, step: 18000, time: 15.460690999999997
step: 5, name: ForkPoolWorker-6, step: 18000, time: 15.437054999999987
step: 2, name: ForkPoolWorker-3, step: 18000, time: 15.393519999999967
step: 6, name: ForkPoolWorker-7, step: 18000, time: 15.572408999999993
step: 8, name: ForkPoolWorker-9, step: 18000, time: 15.38765699999999
step: 3, name: ForkPoolWorker-4, step: 19000, time: 14.306555000000003
step: 4, name: ForkPoolWorker-5, step: 19000, time: 14.334877000000006
step: 7, name: ForkPoolWorker-8, step: 19000, time: 14.605306000000041
step: 9, name: ForkPoolWorker-10, step: 19000, time: 14.374638000000004
step: 1, name: ForkPoolWorker-2, step: 19000, time: 14.190722999999934
step: 0, name: ForkPoolWorker-1, step: 19000, time: 14.326379000000088
step: 2, name: ForkPoolWorker-3, step: 19000, time: 14.248519999999985
step: 5, name: ForkPoolWorker-6, step: 19000, time: 14.345385000000078
step: 6, name: ForkPoolWorker-7, step: 19000, time: 14.751430000000028
step: 8, name: ForkPoolWorker-9, step: 19000, time: 14.289323000000081
step: 3, name: ForkPoolWorker-4, step: 20000, time: 14.792079999999942
step: 4, name: ForkPoolWorker-5, step: 20000, time: 14.557427999999959
step: 7, name: ForkPoolWorker-8, step: 20000, time: 14.738540000000057
step: 9, name: ForkPoolWorker-10, step: 20000, time: 14.612709999999993
step: 1, name: ForkPoolWorker-2, step: 20000, time: 14.864540000000034
step: 0, name: ForkPoolWorker-1, step: 20000, time: 14.721924000000058
step: 2, name: ForkPoolWorker-3, step: 20000, time: 14.606671000000006
step: 5, name: ForkPoolWorker-6, step: 20000, time: 14.603748999999993
step: 6, name: ForkPoolWorker-7, step: 20000, time: 14.631118000000015
step: 8, name: ForkPoolWorker-9, step: 20000, time: 14.545495999999957
step: 3, name: ForkPoolWorker-4, step: 21000, time: 15.207005000000095
step: 4, name: ForkPoolWorker-5, step: 21000, time: 15.189284999999927
step: 9, name: ForkPoolWorker-10, step: 21000, time: 15.226679999999988
step: 7, name: ForkPoolWorker-8, step: 21000, time: 15.272534000000064
step: 1, name: ForkPoolWorker-2, step: 21000, time: 15.376891999999998
step: 5, name: ForkPoolWorker-6, step: 21000, time: 15.178774999999973
step: 2, name: ForkPoolWorker-3, step: 21000, time: 15.315021999999999
step: 0, name: ForkPoolWorker-1, step: 21000, time: 15.241053999999963
step: 6, name: ForkPoolWorker-7, step: 21000, time: 15.210878999999977
step: 8, name: ForkPoolWorker-9, step: 21000, time: 15.348224999999957
step: 3, name: ForkPoolWorker-4, step: 22000, time: 17.421250999999984
step: 4, name: ForkPoolWorker-5, step: 22000, time: 17.463235999999938
step: 9, name: ForkPoolWorker-10, step: 22000, time: 17.483828000000017
step: 7, name: ForkPoolWorker-8, step: 22000, time: 17.55386199999998
step: 5, name: ForkPoolWorker-6, step: 22000, time: 17.425095000000056
step: 1, name: ForkPoolWorker-2, step: 22000, time: 17.582951999999977
step: 2, name: ForkPoolWorker-3, step: 22000, time: 17.543926000000056
step: 0, name: ForkPoolWorker-1, step: 22000, time: 17.47446500000001
step: 6, name: ForkPoolWorker-7, step: 22000, time: 17.553301000000033
step: 8, name: ForkPoolWorker-9, step: 22000, time: 17.59951699999999
step: 3, name: ForkPoolWorker-4, step: 23000, time: 13.382221999999956
step: 4, name: ForkPoolWorker-5, step: 23000, time: 13.478883999999994
step: 9, name: ForkPoolWorker-10, step: 23000, time: 13.322457999999983
step: 7, name: ForkPoolWorker-8, step: 23000, time: 13.39376100000004
step: 5, name: ForkPoolWorker-6, step: 23000, time: 13.433576000000016
step: 2, name: ForkPoolWorker-3, step: 23000, time: 13.40852300000006
step: 1, name: ForkPoolWorker-2, step: 23000, time: 13.555766000000062
step: 0, name: ForkPoolWorker-1, step: 23000, time: 13.390145999999959
step: 6, name: ForkPoolWorker-7, step: 23000, time: 13.397596000000021
step: 3, name: ForkPoolWorker-4, step: 24000, time: 11.841998999999987
step: 8, name: ForkPoolWorker-9, step: 23000, time: 13.4133700000001
step: 4, name: ForkPoolWorker-5, step: 24000, time: 11.853596000000039
step: 9, name: ForkPoolWorker-10, step: 24000, time: 11.994368000000009
step: 7, name: ForkPoolWorker-8, step: 24000, time: 12.05229200000008
step: 5, name: ForkPoolWorker-6, step: 24000, time: 12.008148000000006
step: 2, name: ForkPoolWorker-3, step: 24000, time: 12.048391000000038
step: 1, name: ForkPoolWorker-2, step: 24000, time: 12.045758999999975
step: 0, name: ForkPoolWorker-1, step: 24000, time: 12.098860999999943
step: 6, name: ForkPoolWorker-7, step: 24000, time: 11.968997999999942
step: 3, name: ForkPoolWorker-4, step: 25000, time: 11.776299999999992
step: 8, name: ForkPoolWorker-9, step: 24000, time: 12.013169999999946
step: 4, name: ForkPoolWorker-5, step: 25000, time: 11.71913799999993
step: 9, name: ForkPoolWorker-10, step: 25000, time: 11.817320999999993
step: 7, name: ForkPoolWorker-8, step: 25000, time: 11.827010000000087
step: 5, name: ForkPoolWorker-6, step: 25000, time: 11.760254000000032
step: 2, name: ForkPoolWorker-3, step: 25000, time: 11.66858000000002
step: 1, name: ForkPoolWorker-2, step: 25000, time: 11.850202000000081
step: 0, name: ForkPoolWorker-1, step: 25000, time: 11.897853999999938
step: 3, name: ForkPoolWorker-4, step: 26000, time: 9.911150999999904
step: 6, name: ForkPoolWorker-7, step: 25000, time: 11.805532000000085
step: 4, name: ForkPoolWorker-5, step: 26000, time: 9.983511999999905
step: 8, name: ForkPoolWorker-9, step: 25000, time: 11.890247999999929
step: 9, name: ForkPoolWorker-10, step: 26000, time: 9.877124000000094
step: 7, name: ForkPoolWorker-8, step: 26000, time: 10.170654999999897
step: 5, name: ForkPoolWorker-6, step: 26000, time: 9.838183999999956
step: 2, name: ForkPoolWorker-3, step: 26000, time: 10.033644999999979
step: 1, name: ForkPoolWorker-2, step: 26000, time: 10.19019400000002
step: 0, name: ForkPoolWorker-1, step: 26000, time: 9.992181000000073
step: 3, name: ForkPoolWorker-4, step: 27000, time: 9.595680000000016
step: 4, name: ForkPoolWorker-5, step: 27000, time: 9.62587899999994
step: 6, name: ForkPoolWorker-7, step: 26000, time: 10.043192999999974
step: 8, name: ForkPoolWorker-9, step: 26000, time: 10.027284000000009
step: 9, name: ForkPoolWorker-10, step: 27000, time: 9.560068000000001
step: 5, name: ForkPoolWorker-6, step: 27000, time: 9.611152000000061
step: 7, name: ForkPoolWorker-8, step: 27000, time: 9.836551999999983
step: 2, name: ForkPoolWorker-3, step: 27000, time: 9.804885000000013
step: 1, name: ForkPoolWorker-2, step: 27000, time: 9.711815999999999
step: 0, name: ForkPoolWorker-1, step: 27000, time: 9.731955000000085
step: 3, name: ForkPoolWorker-4, step: 28000, time: 9.158221000000026
step: 4, name: ForkPoolWorker-5, step: 28000, time: 9.294043999999985
step: 6, name: ForkPoolWorker-7, step: 27000, time: 9.728392999999983
step: 8, name: ForkPoolWorker-9, step: 27000, time: 9.855514000000085
step: 9, name: ForkPoolWorker-10, step: 28000, time: 9.468604000000028
step: 5, name: ForkPoolWorker-6, step: 28000, time: 9.32228699999996
step: 7, name: ForkPoolWorker-8, step: 28000, time: 9.427378999999974
step: 2, name: ForkPoolWorker-3, step: 28000, time: 9.288589000000002
step: 1, name: ForkPoolWorker-2, step: 28000, time: 9.268734999999992
step: 3, name: ForkPoolWorker-4, step: 29000, time: 8.613626000000068
step: 0, name: ForkPoolWorker-1, step: 28000, time: 9.30721600000004
step: 4, name: ForkPoolWorker-5, step: 29000, time: 8.577483999999913
step: 6, name: ForkPoolWorker-7, step: 28000, time: 9.256419999999935
step: 9, name: ForkPoolWorker-10, step: 29000, time: 8.54887599999995
step: 8, name: ForkPoolWorker-9, step: 28000, time: 9.325418000000013
step: 5, name: ForkPoolWorker-6, step: 29000, time: 8.561778000000004
step: 7, name: ForkPoolWorker-8, step: 29000, time: 8.505089999999996
step: 2, name: ForkPoolWorker-3, step: 29000, time: 8.543226000000004
step: 1, name: ForkPoolWorker-2, step: 29000, time: 8.463092999999958
step: 3, name: ForkPoolWorker-4, step: 30000, time: 8.48133400000006
step: 0, name: ForkPoolWorker-1, step: 29000, time: 8.513270000000034
step: 4, name: ForkPoolWorker-5, step: 30000, time: 8.483463999999913
step: 6, name: ForkPoolWorker-7, step: 29000, time: 8.544485000000009
step: 8, name: ForkPoolWorker-9, step: 29000, time: 8.48120700000004
step: 9, name: ForkPoolWorker-10, step: 30000, time: 8.674560000000042
step: 5, name: ForkPoolWorker-6, step: 30000, time: 8.510227999999984
step: 7, name: ForkPoolWorker-8, step: 30000, time: 8.64201300000002
step: 2, name: ForkPoolWorker-3, step: 30000, time: 8.533505999999988
step: 1, name: ForkPoolWorker-2, step: 30000, time: 8.491259000000014
step: 3, name: ForkPoolWorker-4, step: 31000, time: 8.438539999999989
step: 0, name: ForkPoolWorker-1, step: 30000, time: 8.48789099999999
step: 4, name: ForkPoolWorker-5, step: 31000, time: 8.457846000000018
step: 6, name: ForkPoolWorker-7, step: 30000, time: 8.39851699999997
step: 9, name: ForkPoolWorker-10, step: 31000, time: 8.348253999999997
step: 8, name: ForkPoolWorker-9, step: 30000, time: 8.48947499999997
step: 5, name: ForkPoolWorker-6, step: 31000, time: 8.32400000000007
step: 7, name: ForkPoolWorker-8, step: 31000, time: 8.372751000000108
step: 2, name: ForkPoolWorker-3, step: 31000, time: 8.256273999999962
step: 3, name: ForkPoolWorker-4, step: 32000, time: 8.065698999999995
step: 1, name: ForkPoolWorker-2, step: 31000, time: 8.359049999999911
step: 0, name: ForkPoolWorker-1, step: 31000, time: 8.340595000000008
step: 4, name: ForkPoolWorker-5, step: 32000, time: 8.04283200000009
step: 6, name: ForkPoolWorker-7, step: 31000, time: 8.270024000000035
step: 9, name: ForkPoolWorker-10, step: 32000, time: 8.02836400000001
step: 8, name: ForkPoolWorker-9, step: 31000, time: 8.354293999999982
step: 5, name: ForkPoolWorker-6, step: 32000, time: 8.017102000000023
step: 7, name: ForkPoolWorker-8, step: 32000, time: 8.052466999999979
step: 2, name: ForkPoolWorker-3, step: 32000, time: 7.963388999999893
step: 3, name: ForkPoolWorker-4, step: 33000, time: 7.8540610000000015
step: 1, name: ForkPoolWorker-2, step: 32000, time: 8.050847999999974
step: 0, name: ForkPoolWorker-1, step: 32000, time: 8.02805699999999
step: 4, name: ForkPoolWorker-5, step: 33000, time: 8.220894000000044
step: 6, name: ForkPoolWorker-7, step: 32000, time: 8.034310000000005
step: 9, name: ForkPoolWorker-10, step: 33000, time: 8.267391000000089
step: 8, name: ForkPoolWorker-9, step: 32000, time: 7.951468999999975
step: 5, name: ForkPoolWorker-6, step: 33000, time: 8.175937999999974
step: 7, name: ForkPoolWorker-8, step: 33000, time: 8.181429999999978
step: 2, name: ForkPoolWorker-3, step: 33000, time: 7.793300000000045
step: 3, name: ForkPoolWorker-4, step: 34000, time: 7.385221000000001
step: 1, name: ForkPoolWorker-2, step: 33000, time: 7.77351699999997
step: 0, name: ForkPoolWorker-1, step: 33000, time: 7.7271310000000994
step: 4, name: ForkPoolWorker-5, step: 34000, time: 7.329237000000035
callback function result type: <class 'list'>, size: 48663
step: 6, name: ForkPoolWorker-7, step: 33000, time: 8.19223199999999
step: 9, name: ForkPoolWorker-10, step: 34000, time: 7.288720000000012
step: 5, name: ForkPoolWorker-6, step: 34000, time: 7.260420999999951
callback function result type: <class 'list'>, size: 48663
step: 8, name: ForkPoolWorker-9, step: 33000, time: 8.261430999999902
step: 7, name: ForkPoolWorker-8, step: 34000, time: 7.14067
step: 2, name: ForkPoolWorker-3, step: 34000, time: 7.179147000000057
step: 1, name: ForkPoolWorker-2, step: 34000, time: 7.123677999999927
step: 0, name: ForkPoolWorker-1, step: 34000, time: 7.038905999999997
callback function result type: <class 'list'>, size: 48663
callback function result type: <class 'list'>, size: 48663
callback function result type: <class 'list'>, size: 48663
step: 6, name: ForkPoolWorker-7, step: 34000, time: 6.186972999999966
callback function result type: <class 'list'>, size: 48663
step: 8, name: ForkPoolWorker-9, step: 34000, time: 5.91410099999996
callback function result type: <class 'list'>, size: 48663
callback function result type: <class 'list'>, size: 48663
callback function result type: <class 'list'>, size: 48663
callback function result type: <class 'list'>, size: 48663
gen_data_fin.py:290: DeprecationWarning: time.clock has been deprecated in Python 3.3 and will be removed from Python 3.8: use time.perf_counter or time.process_time instead
  print("num of instance:{}; time:{}".format(len(instances), time.clock() - start_time))
num of instance:535293; time:49.023418
WARNING:tensorflow:From gen_data_fin.py:490: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
WARNING:tensorflow:From gen_data_fin.py:138: The name tf.python_io.TFRecordWriter is deprecated. Please use tf.io.TFRecordWriter instead.

INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_28029 [MASK] [MASK] item_32493 [MASK] item_41644 [MASK] [MASK] item_5788 [MASK] [MASK] [MASK] item_14345 item_4932
INFO:tensorflow:info: 21077
INFO:tensorflow:input_ids: 28069 46071 46071 25699 46071 36216 46071 46071 2719 46071 46071 46071 6494 2048 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 4 6 7 9 10 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 11662 28453 30590 27783 27393 2719 2344 26372 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3290 item_2092 item_10063 item_10064 item_10065 item_10066 item_1336 item_1336 item_10067 item_1055 item_10068 item_7596 item_10069 item_10069 item_7975 item_5872 item_6085 item_10070 item_10071 item_10072 item_8501 item_4381 item_10073 item_8510 item_10074 item_10075 item_3788 item_10076 item_1154 item_473 item_10077 item_10078 item_377 item_1353 item_10079 item_9391 item_9391 item_10080 item_9498 item_10081 item_6812 item_3544 item_9159 item_3231 item_3229 item_258 item_10082 item_10083 item_10084 [MASK]
INFO:tensorflow:info: 401
INFO:tensorflow:input_ids: 2613 4879 24125 15310 4039 26829 2450 2450 3354 5 16593 3007 12314 12314 3714 419 1 3735 13210 16594 9133 14046 12315 13166 7458 14201 8146 4040 10727 80 26830 21778 292 4871 21779 8244 8244 19822 24092 18116 638 5341 2401 1974 1973 191 15311 12316 7093 46071
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
INFO:tensorflow:masked_lm_positions: 49 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 955 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_696 [MASK] item_697 [MASK] [MASK] item_700 item_701 [MASK] [MASK] [MASK] [MASK] item_705 item_706 [MASK] [MASK] item_709 [MASK]
INFO:tensorflow:info: 22
INFO:tensorflow:input_ids: 8990 46071 7698 46071 46071 6317 6318 46071 46071 46071 46071 6319 8107 46071 46071 5787 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 1 3 4 7 8 9 10 13 14 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 8990 17805 8527 13958 6958 36695 4117 23755 40340 6320 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] item_16519 [MASK] item_16523 item_13644 [MASK] item_18386 [MASK] [MASK]
INFO:tensorflow:info: 19995
INFO:tensorflow:input_ids: 46071 46071 46071 15563 46071 6805 1664 46071 9857 46071 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 2 4 7 9 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 9974 2808 111 5668 2504 21382 4044 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_233 [MASK] item_7956 item_459 [MASK] [MASK] [MASK] [MASK] [MASK] item_17067 item_4663
INFO:tensorflow:info: 29857
INFO:tensorflow:input_ids: 46071 22 46071 2395 3 46071 46071 46071 46071 46071 4085 59 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 5 6 7 8 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 16 753 16478 1 766 32 62 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_15611 [MASK] item_45757 item_45757 [MASK] [MASK] item_35193 [MASK]
INFO:tensorflow:info: 29494
INFO:tensorflow:input_ids: 46071 9818 46071 43572 43572 46071 46071 35190 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 5 6 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 23670 2087 441 4044 1453 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_36021 item_34304 [MASK] [MASK] [MASK] item_25333 [MASK] [MASK] item_7614
INFO:tensorflow:info: 26096
INFO:tensorflow:input_ids: 38582 28760 46071 46071 46071 1957 46071 46071 5884 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 2 3 4 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 23738 29327 33321 2486 36 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_19446 [MASK] item_42431 item_16764 item_16764 [MASK] [MASK]
INFO:tensorflow:info: 14090
INFO:tensorflow:input_ids: 46071 46071 10489 46071 36339 24471 24471 46071 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 3 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 7721 13848 36775 30834 35640 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11414 item_52 item_23721 item_43343 item_44211 item_43086 item_1206 [MASK]
INFO:tensorflow:info: 18943
INFO:tensorflow:input_ids: 1395 2 11926 26444 40094 29515 4865 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 341 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3524 [MASK] [MASK] item_17245 [MASK] item_14534 [MASK] [MASK] [MASK] [MASK] item_43805 [MASK] item_14118 item_19785
INFO:tensorflow:info: 16946
INFO:tensorflow:input_ids: 987 46071 46071 13435 46071 7157 46071 46071 46071 46071 44983 46071 1883 974 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 1 2 4 6 7 8 9 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6529 957 1054 33990 4040 8 3511 10059 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] [MASK] item_3493 [MASK] item_23130 item_1210 item_241 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_3151 item_4764 item_13563 [MASK] item_532 [MASK] item_12434 [MASK] [MASK] [MASK] [MASK] item_7822 item_1356 [MASK] item_264 [MASK] [MASK] item_12144 [MASK] item_266 [MASK] item_20971
INFO:tensorflow:info: 7773
INFO:tensorflow:input_ids: 46071 46071 46071 231 46071 4110 137 810 46071 46071 46071 46071 46071 46071 46071 46071 664 85 829 46071 265 46071 956 46071 46071 46071 46071 364 1839 46071 548 46071 46071 2271 46071 167 46071 11153 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 2 4 8 9 10 11 12 13 14 15 19 21 23 24 25 26 29 31 32 34 36 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 904 157 231 2961 2 546 67 3305 16407 5059 799 1052 301 23340 233 221 2761 2313 242 8229 39036 9342 5053 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_514 [MASK] [MASK] item_11980 [MASK] item_3770 item_12554 [MASK] item_29433 [MASK] [MASK] [MASK] [MASK] item_78 [MASK] item_4764 item_2094 [MASK] item_29434 [MASK] [MASK] [MASK] item_7635 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_7255 item_476 item_3012 [MASK] [MASK] item_3298 [MASK] item_7084 [MASK] item_39 [MASK] [MASK] item_259 item_16841 [MASK] [MASK] item_5853 [MASK] [MASK] item_9001 [MASK]
INFO:tensorflow:info: 2772
INFO:tensorflow:input_ids: 2147 46071 46071 5432 46071 437 1045 46071 41064 46071 46071 46071 46071 1629 46071 85 3962 46071 34508 46071 46071 46071 233 46071 46071 46071 46071 46071 46071 29787 503 2981 46071 46071 7338 46071 1220 46071 12103 46071 46071 97 1725 46071 46071 17972 46071 46071 893 46071
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
INFO:tensorflow:masked_lm_positions: 1 2 4 7 9 10 11 12 14 17 19 20 21 23 24 25 26 27 28 32 33 35 37 39 40 43 44 46 47 49
INFO:tensorflow:masked_lm_ids: 14018 20457 28198 175 3472 3329 285 1835 1779 1060 25250 1970 7 740 516 41 4113 30 31242 2963 11120 9826 12103 7366 652 220 1653 17264 2740 2271
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_20751 item_24608 item_2752 item_25626 item_19558 item_41805 item_33639 item_4629 item_2765 item_2764 item_33640 item_20761 item_2766 item_34441 item_23969 item_4601 item_41420 item_23981 [MASK]
INFO:tensorflow:info: 24782
INFO:tensorflow:input_ids: 33839 11944 2464 27857 9889 36245 25812 4 19550 10752 25813 15723 23821 25897 20539 354 32743 20541 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 18339 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_15803 [MASK] [MASK] item_31427 [MASK] [MASK] item_258 item_3798 [MASK]
INFO:tensorflow:info: 33471
INFO:tensorflow:input_ids: 46071 22070 46071 46071 16114 46071 46071 191 598 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 2 3 5 6 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 892 39486 3388 341 3304 12 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_6267 item_18091 [MASK] item_7591 [MASK] item_8349 item_1121 [MASK] item_448 [MASK] [MASK] item_5340 [MASK] [MASK] [MASK] item_3998 item_3080 [MASK] item_44926 item_7967 [MASK] [MASK] item_461 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_3090 item_14452 item_654 item_7542 [MASK] [MASK] [MASK] item_6241 [MASK] [MASK] item_9353 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_33932 item_18930
INFO:tensorflow:info: 24454
INFO:tensorflow:input_ids: 2818 1361 46071 8216 46071 673 2788 46071 200 46071 46071 574 46071 46071 46071 8151 1151 46071 40237 2396 46071 46071 877 46071 46071 46071 46071 46071 46071 516 16745 2448 554 46071 46071 46071 1037 46071 46071 381 46071 46071 46071 46071 46071 46071 46071 46071 23306 14494
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
INFO:tensorflow:masked_lm_positions: 2 4 7 9 10 12 13 14 17 20 21 23 24 25 26 27 28 33 34 35 37 38 40 41 42 43 44 45 46 47
INFO:tensorflow:masked_lm_ids: 10678 27349 5097 17428 2446 14784 23876 285 31291 25528 2954 728 109 83 6044 7276 20204 4222 498 301 41 2963 1780 9416 2599 34474 97 2401 3544 371
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_3530 [MASK] [MASK] item_454 item_21584 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_11842 item_11842 item_4945 [MASK] [MASK] item_535 item_6808 [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] [MASK] item_18931 [MASK] [MASK] item_21767 item_21767 [MASK] item_1265 [MASK] item_3233 item_6103 [MASK] [MASK] item_1224 item_11973 [MASK] [MASK] item_8589 item_5809 [MASK] item_4908 [MASK] item_10764
INFO:tensorflow:info: 1363
INFO:tensorflow:input_ids: 46071 46071 452 46071 46071 13 12633 46071 46071 46071 46071 46071 46071 46071 500 500 745 46071 46071 302 3567 46071 46071 46071 46071 46071 46071 46071 6530 46071 46071 17085 17085 46071 21 46071 1596 726 46071 46071 36 755 46071 46071 2321 1806 46071 279 46071 1353
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
INFO:tensorflow:masked_lm_positions: 0 1 3 4 7 8 9 10 11 12 13 17 18 21 22 23 24 25 26 27 29 30 33 35 38 39 42 43 46 48
INFO:tensorflow:masked_lm_ids: 3572 1123 3505 94 1310 6817 1079 38 4472 664 20399 10 740 7702 33902 319 2474 1812 3088 72 97 15311 2243 1596 1368 17086 3784 1169 167 237
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_2120 item_12865 [MASK] [MASK] [MASK] item_12525 [MASK] item_8088 [MASK]
INFO:tensorflow:info: 33078
INFO:tensorflow:input_ids: 46071 6339 40500 46071 46071 46071 6465 46071 6691 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 3 4 5 7 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 31465 22920 22920 5400 21673 1842 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_2058 [MASK] item_20012 [MASK] [MASK] [MASK] item_4819 [MASK] item_4639 [MASK] item_13161 [MASK] [MASK] [MASK] item_6887 [MASK] item_29371 [MASK] [MASK] item_4658 [MASK] [MASK] item_4824 [MASK] [MASK] [MASK] [MASK] item_5247 item_3671 item_19804 [MASK] item_24772 [MASK] [MASK] item_20225 item_4541 [MASK] [MASK] item_1657 item_7346 item_20920 [MASK] [MASK] item_4673 [MASK] [MASK] item_27886 [MASK]
INFO:tensorflow:info: 2748
INFO:tensorflow:input_ids: 46071 46071 1501 46071 9355 46071 46071 46071 5100 46071 14058 46071 1227 46071 46071 46071 705 46071 28193 46071 46071 3691 46071 46071 5587 46071 46071 46071 46071 1920 11443 10494 46071 20588 46071 46071 4435 34 46071 46071 13980 54 9376 46071 46071 2247 46071 46071 25294 46071
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
INFO:tensorflow:masked_lm_positions: 0 1 3 5 6 7 9 11 13 14 15 17 19 20 22 23 25 26 27 28 32 34 35 38 39 43 44 46 47 49
INFO:tensorflow:masked_lm_ids: 16682 3334 10015 11772 25438 531 18076 16910 1706 13810 18793 11305 3353 10231 4560 30017 5289 28194 173 13296 9233 34504 1680 1303 7109 8029 4709 18146 4166 9217
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] item_37256 item_1917 item_33798 [MASK] item_39015 [MASK] [MASK] [MASK] [MASK] [MASK]
INFO:tensorflow:info: 21749
INFO:tensorflow:input_ids: 46071 35491 15 19261 46071 32443 46071 46071 46071 46071 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 4 6 7 8 9 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 17052 4842 29211 210 24497 4024 20160 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: [MASK] [MASK] item_5327 item_1344 [MASK] [MASK] item_9342 [MASK] item_1361
INFO:tensorflow:info: 29661
INFO:tensorflow:input_ids: 46071 46071 1251 2026 46071 46071 71 46071 682 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 0 1 4 5 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 256 22 21248 118 39 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 535293 total instances
train:./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
begin to generate test
num of instance:34306
INFO:tensorflow:*** Writing to output files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_9518 item_9272 item_994 item_9289 item_8751 item_8751 item_22740 item_3884 item_3980 item_24933 [MASK]
INFO:tensorflow:info: 29137
INFO:tensorflow:input_ids: 3586 543 1290 1656 1315 1315 24881 5091 1908 9982 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 23607 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_36286 item_36693 item_3434 item_8353 item_6715 item_32332 item_31336 item_3237 item_9164 item_15168 [MASK]
INFO:tensorflow:info: 26174
INFO:tensorflow:input_ids: 21240 21264 183 4176 7400 10048 23113 3971 5899 6792 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 21661 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_16442 item_4608 item_3586 item_1461 item_39320 item_23180 item_14404 item_24847 item_12590 item_23937 item_11099 item_4631 item_21043 item_16457 item_14408 item_429 item_1571 item_1563 item_30151 item_13163 item_6454 item_4642 item_16025 item_24618 item_3674 item_1607 item_5101 item_31249 item_7800 item_5630 item_24501 item_6432 item_17105 item_7348 item_16901 item_2083 item_12624 item_4677 item_34292 item_5145 [MASK]
INFO:tensorflow:info: 19495
INFO:tensorflow:input_ids: 16849 10793 1129 2607 32475 12687 2939 27791 14295 17182 7112 4906 18608 7189 1021 141 158 901 17497 5190 2117 5099 5475 22624 3418 1593 402 9506 3573 5593 3393 4165 4602 752 4415 1502 3606 951 25879 14069 46071 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 40 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 214 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_34761 item_25625 item_24531 item_24531 item_33570 item_18831 item_29951 item_2419 item_10611 item_23136 item_25333 item_25956 item_16707 item_6812 item_2398 item_20815 [MASK]
INFO:tensorflow:info: 19256
INFO:tensorflow:input_ids: 28811 25109 22620 22620 28661 18494 12034 9016 1084 33990 1957 18865 7939 638 1005 2870 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 20892 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_2823 item_2824 item_2825 item_2826 item_2827 item_2828 item_2829 item_2830 item_2831 item_2832 item_2833 item_2834 item_2835 item_2836 item_2837 item_2837 item_2838 item_2839 item_2840 item_2841 item_2842 item_2843 item_2844 item_1891 [MASK]
INFO:tensorflow:info: 84
INFO:tensorflow:input_ids: 1745 8569 33086 9584 12160 17874 14008 36728 33087 9026 2800 14009 23825 40356 17875 17875 19553 2369 369 29648 4137 742 6986 6616 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 24 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 21477 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_23424 item_12208 item_2425 item_5950 item_41690 [MASK]
INFO:tensorflow:info: 11684
INFO:tensorflow:input_ids: 10560 5674 8127 29752 32772 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 34923 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_11038 item_232 item_41960 item_17720 item_40216 item_32281 item_35107 item_8460 item_253 item_35533 item_13082 item_1144 item_33887 item_2517 item_21843 item_6812 item_7547 item_6717 item_7741 item_20210 item_11867 item_3104 item_5528 [MASK]
INFO:tensorflow:info: 14652
INFO:tensorflow:input_ids: 1872 7300 36275 1726 32599 31583 16207 562 23 16216 854 10726 19263 249 4259 638 4008 616 5620 3632 3602 223 17 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 23 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 455 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_8394 item_8394 item_43654 item_3456 item_14012 item_14774 item_526 item_9341 item_42268 item_17929 item_43018 item_14542 item_43331 item_43331 item_43331 item_43331 item_43331 item_5869 [MASK]
INFO:tensorflow:info: 28757
INFO:tensorflow:input_ids: 14152 14152 29537 12168 4996 5698 941 2644 39681 14453 32891 14351 16279 16279 16279 16279 16279 523 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 291 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_24787 item_3145 item_1042 item_39270 item_448 item_512 item_3151 item_31479 item_1341 item_12447 item_10085 item_24433 item_104 item_4775 item_1225 item_39271 item_3168 [MASK]
INFO:tensorflow:info: 8183
INFO:tensorflow:input_ids: 17230 571 126 26270 200 24 664 14897 3658 5436 955 4636 7296 761 5308 35829 117 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 17 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3366 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_30643 item_11895 item_14727 item_14727 item_29416 item_20670 item_7547 item_25376 item_4526 item_27073 [MASK]
INFO:tensorflow:info: 25556
INFO:tensorflow:input_ids: 17521 1397 2131 2131 9495 2772 4008 15904 1983 6576 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 6870 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_818 item_4401 item_36881 item_22710 item_33386 item_36621 item_19209 item_38506 item_23100 item_1245 item_31217 item_19212 item_14237 item_9845 item_19213 item_23107 item_19215 item_4427 item_4430 item_19217 [MASK]
INFO:tensorflow:info: 18066
INFO:tensorflow:input_ids: 1632 12185 10697 11191 8976 23481 7220 23596 14657 2528 12867 3273 2510 14195 5023 13625 2585 2898 5096 6258 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 4121 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_10466 item_6236 item_4121 item_6713 item_9752 item_3007 item_3007 item_6093 item_27054 item_7232 item_11872 [MASK]
INFO:tensorflow:info: 24877
INFO:tensorflow:input_ids: 3593 892 5837 3336 405 8 8 315 10624 2634 10302 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 10302 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_9023 item_16729 item_12515 item_13140 item_31021 item_8931 item_5615 item_864 item_15905 item_6421 item_1509 item_1483 item_26298 item_33106 item_3672 item_34898 item_1656 item_16740 item_1706 item_1735 item_5634 [MASK]
INFO:tensorflow:info: 12846
INFO:tensorflow:input_ids: 11559 10417 3605 709 19138 1528 1646 646 6232 3097 12131 12981 17295 21095 445 16201 2881 12499 3960 3188 1307 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 21 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1307 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_14925 item_9048 item_6421 item_16456 item_16456 item_4795 item_16018 item_21351 item_1591 item_14883 item_11996 item_1609 item_1609 item_1635 item_1733 item_1660 item_1660 item_1659 item_5910 item_16029 item_17843 item_23325 item_13905 item_1725 item_1696 [MASK]
INFO:tensorflow:info: 20454
INFO:tensorflow:input_ids: 18313 10881 3097 15561 15561 16408 7184 8867 7713 16768 7879 758 758 3295 5068 246 246 3185 465 6506 7956 9962 10348 321 2028 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3718 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_12530 item_1812 item_5319 item_5330 item_13405 item_5354 item_6067 item_5385 item_5830 item_21438 item_12542 item_43524 item_9353 item_1349 item_5430 item_5449 item_5452 item_5445 item_199 item_5516 item_3240 item_5508 item_38706 item_1982 item_5541 item_5528 [MASK]
INFO:tensorflow:info: 16052
INFO:tensorflow:input_ids: 1400 1333 256 478 7499 93 9088 337 2112 2019 789 44922 381 4870 210 2170 373 1034 12951 198 4486 633 39008 412 489 17 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 26 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 407 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_1318 item_1326 item_5356 item_3188 item_16590 item_15952 item_7596 item_16228 item_3161 item_7608 [MASK]
INFO:tensorflow:info: 27054
INFO:tensorflow:input_ids: 539 450 4332 572 7936 1885 3007 4800 72 16500 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5886 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_20421 item_4128 item_8625 item_14979 item_399 item_40181 item_13653 item_2307 item_42474 [MASK]
INFO:tensorflow:info: 13226
INFO:tensorflow:input_ids: 24714 1032 5633 24360 2087 23673 4221 2885 32843 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 5280 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_7169 item_2635 item_2632 item_8715 item_12943 item_10198 item_14334 item_5997 item_4961 item_9558 item_19701 item_34910 item_612 item_39748 item_1797 [MASK]
INFO:tensorflow:info: 15810
INFO:tensorflow:input_ids: 1348 6630 2533 4746 1167 4042 7154 3844 329 2647 6854 12920 62 26299 2360 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 3275 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_8780 item_31461 item_12252 item_8282 item_17454 item_28985 item_6925 item_15295 item_340 item_36614 item_755 item_8330 item_6941 item_12918 [MASK]
INFO:tensorflow:info: 26090
INFO:tensorflow:input_ids: 26780 14895 6462 4358 13446 16053 19694 5210 857 23478 6321 13159 1571 9771 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 14 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 1266 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:*** Example ***
INFO:tensorflow:tokens: item_3814 item_774 item_16040 item_9765 item_9771 item_33585 [MASK]
INFO:tensorflow:info: 33643
INFO:tensorflow:input_ids: 11446 33035 18365 1064 5406 25809 46071 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:input_mask: 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_positions: 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_ids: 592 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
INFO:tensorflow:masked_lm_weights: 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
INFO:tensorflow:Wrote 34306 total instances
test:./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.test.tfrecord
vocab_size:46073, user_size:34306, item_size:46069, item_with_other_size:46072
vocab pickle file: ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
test data pickle file: ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
done.
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/root/miniconda3/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:85: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From run.py:123: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From run.py:612: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

W0411 20:50:07.209462 140495910045504 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From run.py:507: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

W0411 20:50:07.209633 140495910045504 deprecation_wrapper.py:119] From run.py:507: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

checkpointDir: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

W0411 20:50:07.209987 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:80: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From run.py:518: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

W0411 20:50:07.210798 140495910045504 deprecation_wrapper.py:119] From run.py:518: The name tf.gfile.MakeDirs is deprecated. Please use tf.io.gfile.makedirs instead.

WARNING:tensorflow:From run.py:522: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0411 20:50:07.211004 140495910045504 deprecation_wrapper.py:119] From run.py:522: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

WARNING:tensorflow:From run.py:531: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0411 20:50:07.213730 140495910045504 deprecation_wrapper.py:119] From run.py:531: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:*** train Input Files ***
I0411 20:50:07.213862 140495910045504 run.py:531] *** train Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 20:50:07.214038 140495910045504 run.py:533]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:*** test Input Files ***
I0411 20:50:07.214256 140495910045504 run.py:535] *** test Input Files ***
INFO:tensorflow:  ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
I0411 20:50:07.214426 140495910045504 run.py:537]   ./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.train.tfrecord
INFO:tensorflow:Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc73038c810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
I0411 20:50:07.264024 140495910045504 estimator.py:209] Using config: {'_model_dir': '~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc73038c810>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
INFO:tensorflow:***** Running training *****
I0411 20:50:07.266265 140495910045504 run.py:571] ***** Running training *****
INFO:tensorflow:  Batch size = 256
I0411 20:50:07.266368 140495910045504 run.py:572]   Batch size = 256
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0411 20:50:07.282550 140495910045504 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
WARNING:tensorflow:From run.py:447: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0411 20:50:07.295627 140495910045504 deprecation_wrapper.py:119] From run.py:447: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From run.py:493: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example instead.

W0411 20:50:07.314011 140495910045504 deprecation_wrapper.py:119] From run.py:493: The name tf.parse_single_example is deprecated. Please use tf.io.parse_single_example instead.

WARNING:tensorflow:From run.py:500: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0411 20:50:07.319076 140495910045504 deprecation.py:323] From run.py:500: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0411 20:50:07.340747 140495910045504 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 20:50:07.340899 140495910045504 run.py:250] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 20:50:07.341102 140495910045504 run.py:253]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 20:50:07.341253 140495910045504 run.py:253]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 20:50:07.341467 140495910045504 run.py:253]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 20:50:07.341642 140495910045504 run.py:253]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 20:50:07.341771 140495910045504 run.py:253]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 20:50:07.341937 140495910045504 run.py:253]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0411 20:50:07.350833 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:160: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0411 20:50:07.352745 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:406: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

W0411 20:50:07.385804 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/modeling.py:488: The name tf.assert_less_equal is deprecated. Please use tf.compat.v1.assert_less_equal instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

W0411 20:50:07.820927 140495910045504 lazy_loader.py:50]
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0411 20:50:07.839547 140495910045504 deprecation.py:506] From /root/BERT4Rec/modeling.py:351: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0411 20:50:07.879685 140495910045504 deprecation.py:323] From /root/BERT4Rec/modeling.py:670: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:07.913701 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:07.942167 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:07.970254 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c4ced0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c797d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c797d0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.035999 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c797d0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c797d0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f90>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.097601 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f90>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d4410>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d4410>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.139091 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d4410>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d4410>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712741b90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712741b90>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.217975 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712741b90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712741b90>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127edb90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127edb90>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.253733 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127edb90>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127edb90>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712736390>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712736390>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.286698 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712736390>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712736390>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712644f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712644f10>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.352341 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712644f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712644f10>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d6bd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d6bd0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.407109 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d6bd0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7127d6bd0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f50>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f50>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.440492 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f50>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712c69f50>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712474f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712474f10>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 20:50:08.522024 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712474f10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc712474f10>>: AttributeError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 20:50:08.565838 140495910045504 run.py:304] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 20:50:08.565984 140495910045504 run.py:310]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 20:50:08.566175 140495910045504 run.py:310]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 20:50:08.566462 140495910045504 run.py:310]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.566710 140495910045504 run.py:310]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.566928 140495910045504 run.py:310]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 20:50:08.567104 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 20:50:08.567315 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 20:50:08.567486 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 20:50:08.567703 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 20:50:08.567880 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 20:50:08.568085 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 20:50:08.568255 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 20:50:08.568462 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.568630 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.568829 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 20:50:08.569022 140495910045504 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 20:50:08.569187 140495910045504 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 20:50:08.569370 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 20:50:08.569545 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.569691 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.569879 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 20:50:08.570089 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 20:50:08.570287 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 20:50:08.570467 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 20:50:08.570670 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 20:50:08.570950 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 20:50:08.571134 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 20:50:08.571330 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 20:50:08.571552 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.571744 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.571922 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 20:50:08.572098 140495910045504 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 20:50:08.572272 140495910045504 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 20:50:08.572476 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 20:50:08.572657 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.572836 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.573009 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 20:50:08.573191 140495910045504 run.py:310]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 20:50:08.573372 140495910045504 run.py:310]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 20:50:08.573544 140495910045504 run.py:310]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 20:50:08.573712 140495910045504 run.py:310]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 20:50:08.573864 140495910045504 run.py:310]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0411 20:50:08.574112 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:28: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

W0411 20:50:08.575029 140495910045504 deprecation_wrapper.py:119] From /root/BERT4Rec/optimization.py:33: The name tf.train.polynomial_decay is deprecated. Please use tf.compat.v1.train.polynomial_decay instead.

WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0411 20:50:08.579698 140495910045504 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/optimizer_v2/learning_rate_schedule.py:409: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0411 20:50:09.719675 140495910045504 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/ops/clip_ops.py:286: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
INFO:tensorflow:Done calling model_fn.
I0411 20:50:10.851703 140495910045504 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0411 20:50:10.853578 140495910045504 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0411 20:50:11.596673 140495910045504 monitored_session.py:240] Graph was finalized.
2022-04-11 20:50:11.597271: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2022-04-11 20:50:11.611546: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2022-04-11 20:50:11.613620: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556a33059e00 executing computations on platform Host. Devices:
2022-04-11 20:50:11.613664: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2022-04-11 20:50:11.615657: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2022-04-11 20:50:11.647968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 20:50:11.648361: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2022-04-11 20:50:11.650731: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2022-04-11 20:50:11.652361: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2022-04-11 20:50:11.652817: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2022-04-11 20:50:11.654921: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2022-04-11 20:50:11.656461: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2022-04-11 20:50:11.660773: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2022-04-11 20:50:11.661750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 20:50:11.661840: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2022-04-11 20:50:11.891529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-11 20:50:11.891578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 20:50:11.891585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 20:50:11.893143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:82:00.0, compute capability: 6.1)
2022-04-11 20:50:11.895329: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556a34af9f80 executing computations on platform CUDA. Devices:
2022-04-11 20:50:11.895347: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): NVIDIA TITAN X (Pascal), Compute Capability 6.1
2022-04-11 20:50:13.170863: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0411 20:50:13.189376 140495910045504 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 20:50:13.236372 140495910045504 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 20:50:15.385813 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
2022-04-11 20:50:17.015118: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
INFO:tensorflow:loss = 10.916463, step = 0
I0411 20:50:17.440282 140495910045504 basic_session_run_hooks.py:262] loss = 10.916463, step = 0
INFO:tensorflow:global_step/sec: 4.74333
I0411 20:50:38.521118 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 4.74333
INFO:tensorflow:loss = 10.402872, step = 100 (21.082 sec)
I0411 20:50:38.521972 140495910045504 basic_session_run_hooks.py:260] loss = 10.402872, step = 100 (21.082 sec)
INFO:tensorflow:global_step/sec: 5.62698
I0411 20:50:56.292610 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.62698
INFO:tensorflow:loss = 10.09612, step = 200 (17.772 sec)
I0411 20:50:56.293857 140495910045504 basic_session_run_hooks.py:260] loss = 10.09612, step = 200 (17.772 sec)
INFO:tensorflow:global_step/sec: 5.62396
I0411 20:51:14.073744 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.62396
INFO:tensorflow:loss = 10.059885, step = 300 (17.781 sec)
I0411 20:51:14.075033 140495910045504 basic_session_run_hooks.py:260] loss = 10.059885, step = 300 (17.781 sec)
INFO:tensorflow:global_step/sec: 5.61096
I0411 20:51:31.896008 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.61096
INFO:tensorflow:loss = 10.065355, step = 400 (17.822 sec)
I0411 20:51:31.897370 140495910045504 basic_session_run_hooks.py:260] loss = 10.065355, step = 400 (17.822 sec)
INFO:tensorflow:global_step/sec: 5.60468
I0411 20:51:49.737989 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.60468
INFO:tensorflow:loss = 9.993544, step = 500 (17.841 sec)
I0411 20:51:49.738556 140495910045504 basic_session_run_hooks.py:260] loss = 9.993544, step = 500 (17.841 sec)
INFO:tensorflow:global_step/sec: 5.59791
I0411 20:52:07.602039 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59791
INFO:tensorflow:loss = 10.033197, step = 600 (17.865 sec)
I0411 20:52:07.603248 140495910045504 basic_session_run_hooks.py:260] loss = 10.033197, step = 600 (17.865 sec)
INFO:tensorflow:global_step/sec: 5.60091
I0411 20:52:25.456321 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.60091
INFO:tensorflow:loss = 9.976978, step = 700 (17.854 sec)
I0411 20:52:25.457510 140495910045504 basic_session_run_hooks.py:260] loss = 9.976978, step = 700 (17.854 sec)
INFO:tensorflow:global_step/sec: 5.60095
I0411 20:52:43.310415 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.60095
INFO:tensorflow:loss = 9.999065, step = 800 (17.854 sec)
I0411 20:52:43.311618 140495910045504 basic_session_run_hooks.py:260] loss = 9.999065, step = 800 (17.854 sec)
INFO:tensorflow:global_step/sec: 5.59492
I0411 20:53:01.184059 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59492
INFO:tensorflow:loss = 10.028738, step = 900 (17.874 sec)
I0411 20:53:01.185579 140495910045504 basic_session_run_hooks.py:260] loss = 10.028738, step = 900 (17.874 sec)
INFO:tensorflow:Saving checkpoints for 1000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 20:53:18.884042 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 1000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47173
I0411 20:53:19.459350 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.47173
INFO:tensorflow:loss = 10.030552, step = 1000 (18.275 sec)
I0411 20:53:19.460127 140495910045504 basic_session_run_hooks.py:260] loss = 10.030552, step = 1000 (18.275 sec)
INFO:tensorflow:global_step/sec: 5.59831
I0411 20:53:37.322054 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59831
INFO:tensorflow:loss = 9.917374, step = 1100 (17.863 sec)
I0411 20:53:37.323184 140495910045504 basic_session_run_hooks.py:260] loss = 9.917374, step = 1100 (17.863 sec)
INFO:tensorflow:global_step/sec: 5.59928
I0411 20:53:55.181520 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59928
INFO:tensorflow:loss = 9.846374, step = 1200 (17.860 sec)
I0411 20:53:55.182722 140495910045504 basic_session_run_hooks.py:260] loss = 9.846374, step = 1200 (17.860 sec)
INFO:tensorflow:global_step/sec: 5.59426
I0411 20:54:13.056767 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59426
INFO:tensorflow:loss = 9.842293, step = 1300 (17.875 sec)
I0411 20:54:13.057408 140495910045504 basic_session_run_hooks.py:260] loss = 9.842293, step = 1300 (17.875 sec)
INFO:tensorflow:global_step/sec: 5.59266
I0411 20:54:30.937277 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59266
INFO:tensorflow:loss = 9.798556, step = 1400 (17.880 sec)
I0411 20:54:30.937827 140495910045504 basic_session_run_hooks.py:260] loss = 9.798556, step = 1400 (17.880 sec)
INFO:tensorflow:global_step/sec: 5.59058
I0411 20:54:48.824786 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59058
INFO:tensorflow:loss = 9.69006, step = 1500 (17.888 sec)
I0411 20:54:48.825963 140495910045504 basic_session_run_hooks.py:260] loss = 9.69006, step = 1500 (17.888 sec)
INFO:tensorflow:global_step/sec: 5.58601
I0411 20:55:06.726387 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58601
INFO:tensorflow:loss = 9.702361, step = 1600 (17.901 sec)
I0411 20:55:06.726966 140495910045504 basic_session_run_hooks.py:260] loss = 9.702361, step = 1600 (17.901 sec)
INFO:tensorflow:global_step/sec: 5.59398
I0411 20:55:24.603163 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59398
INFO:tensorflow:loss = 9.573791, step = 1700 (17.878 sec)
I0411 20:55:24.604592 140495910045504 basic_session_run_hooks.py:260] loss = 9.573791, step = 1700 (17.878 sec)
INFO:tensorflow:global_step/sec: 5.58687
I0411 20:55:42.501890 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58687
INFO:tensorflow:loss = 9.570667, step = 1800 (17.898 sec)
I0411 20:55:42.502373 140495910045504 basic_session_run_hooks.py:260] loss = 9.570667, step = 1800 (17.898 sec)
INFO:tensorflow:global_step/sec: 5.5974
I0411 20:56:00.367546 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5974
INFO:tensorflow:loss = 9.582421, step = 1900 (17.866 sec)
I0411 20:56:00.368641 140495910045504 basic_session_run_hooks.py:260] loss = 9.582421, step = 1900 (17.866 sec)
INFO:tensorflow:Saving checkpoints for 2000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 20:56:18.075140 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 2000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.46701
I0411 20:56:18.658868 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.46701
INFO:tensorflow:loss = 9.337387, step = 2000 (18.291 sec)
I0411 20:56:18.659616 140495910045504 basic_session_run_hooks.py:260] loss = 9.337387, step = 2000 (18.291 sec)
INFO:tensorflow:global_step/sec: 5.59231
I0411 20:56:36.540537 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59231
INFO:tensorflow:loss = 9.364701, step = 2100 (17.882 sec)
I0411 20:56:36.541157 140495910045504 basic_session_run_hooks.py:260] loss = 9.364701, step = 2100 (17.882 sec)
INFO:tensorflow:global_step/sec: 5.60429
I0411 20:56:54.384400 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.60429
INFO:tensorflow:loss = 9.210265, step = 2200 (17.845 sec)
I0411 20:56:54.385904 140495910045504 basic_session_run_hooks.py:260] loss = 9.210265, step = 2200 (17.845 sec)
INFO:tensorflow:global_step/sec: 5.59467
I0411 20:57:12.258157 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59467
INFO:tensorflow:loss = 9.1896305, step = 2300 (17.873 sec)
I0411 20:57:12.258714 140495910045504 basic_session_run_hooks.py:260] loss = 9.1896305, step = 2300 (17.873 sec)
INFO:tensorflow:global_step/sec: 5.59571
I0411 20:57:30.129344 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59571
INFO:tensorflow:loss = 9.152391, step = 2400 (17.872 sec)
I0411 20:57:30.130630 140495910045504 basic_session_run_hooks.py:260] loss = 9.152391, step = 2400 (17.872 sec)
INFO:tensorflow:global_step/sec: 5.59516
I0411 20:57:48.001598 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59516
INFO:tensorflow:loss = 9.1131, step = 2500 (17.872 sec)
I0411 20:57:48.002273 140495910045504 basic_session_run_hooks.py:260] loss = 9.1131, step = 2500 (17.872 sec)
INFO:tensorflow:global_step/sec: 5.59897
I0411 20:58:05.862050 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59897
INFO:tensorflow:loss = 9.094882, step = 2600 (17.860 sec)
I0411 20:58:05.862732 140495910045504 basic_session_run_hooks.py:260] loss = 9.094882, step = 2600 (17.860 sec)
INFO:tensorflow:global_step/sec: 5.58826
I0411 20:58:23.756855 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58826
INFO:tensorflow:loss = 9.060211, step = 2700 (17.895 sec)
I0411 20:58:23.757990 140495910045504 basic_session_run_hooks.py:260] loss = 9.060211, step = 2700 (17.895 sec)
INFO:tensorflow:global_step/sec: 5.58929
I0411 20:58:41.647987 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58929
INFO:tensorflow:loss = 8.987808, step = 2800 (17.891 sec)
I0411 20:58:41.648565 140495910045504 basic_session_run_hooks.py:260] loss = 8.987808, step = 2800 (17.891 sec)
INFO:tensorflow:global_step/sec: 5.58765
I0411 20:58:59.544873 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58765
INFO:tensorflow:loss = 8.91537, step = 2900 (17.898 sec)
I0411 20:58:59.546303 140495910045504 basic_session_run_hooks.py:260] loss = 8.91537, step = 2900 (17.898 sec)
INFO:tensorflow:Saving checkpoints for 3000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 20:59:17.238579 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 3000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47106
I0411 20:59:17.822625 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.47106
INFO:tensorflow:loss = 8.850094, step = 3000 (18.277 sec)
I0411 20:59:17.823239 140495910045504 basic_session_run_hooks.py:260] loss = 8.850094, step = 3000 (18.277 sec)
INFO:tensorflow:global_step/sec: 5.59289
I0411 20:59:35.702828 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59289
INFO:tensorflow:loss = 8.85494, step = 3100 (17.881 sec)
I0411 20:59:35.704073 140495910045504 basic_session_run_hooks.py:260] loss = 8.85494, step = 3100 (17.881 sec)
INFO:tensorflow:global_step/sec: 5.58947
I0411 20:59:53.593707 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58947
INFO:tensorflow:loss = 8.831832, step = 3200 (17.891 sec)
I0411 20:59:53.594920 140495910045504 basic_session_run_hooks.py:260] loss = 8.831832, step = 3200 (17.891 sec)
INFO:tensorflow:global_step/sec: 5.58793
I0411 21:00:11.489130 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58793
INFO:tensorflow:loss = 8.825472, step = 3300 (17.895 sec)
I0411 21:00:11.490101 140495910045504 basic_session_run_hooks.py:260] loss = 8.825472, step = 3300 (17.895 sec)
INFO:tensorflow:global_step/sec: 5.59379
I0411 21:00:29.366184 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59379
INFO:tensorflow:loss = 8.850482, step = 3400 (17.877 sec)
I0411 21:00:29.367295 140495910045504 basic_session_run_hooks.py:260] loss = 8.850482, step = 3400 (17.877 sec)
INFO:tensorflow:global_step/sec: 5.59085
I0411 21:00:47.252638 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59085
INFO:tensorflow:loss = 8.8198, step = 3500 (17.887 sec)
I0411 21:00:47.253852 140495910045504 basic_session_run_hooks.py:260] loss = 8.8198, step = 3500 (17.887 sec)
INFO:tensorflow:global_step/sec: 5.59213
I0411 21:01:05.134779 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59213
INFO:tensorflow:loss = 8.77386, step = 3600 (17.882 sec)
I0411 21:01:05.136099 140495910045504 basic_session_run_hooks.py:260] loss = 8.77386, step = 3600 (17.882 sec)
INFO:tensorflow:global_step/sec: 5.59734
I0411 21:01:23.000337 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59734
INFO:tensorflow:loss = 8.7340145, step = 3700 (17.865 sec)
I0411 21:01:23.001108 140495910045504 basic_session_run_hooks.py:260] loss = 8.7340145, step = 3700 (17.865 sec)
INFO:tensorflow:global_step/sec: 5.59199
I0411 21:01:40.883437 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59199
INFO:tensorflow:loss = 8.716773, step = 3800 (17.884 sec)
I0411 21:01:40.884659 140495910045504 basic_session_run_hooks.py:260] loss = 8.716773, step = 3800 (17.884 sec)
INFO:tensorflow:global_step/sec: 5.58913
I0411 21:01:58.774754 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58913
INFO:tensorflow:loss = 8.716569, step = 3900 (17.891 sec)
I0411 21:01:58.775263 140495910045504 basic_session_run_hooks.py:260] loss = 8.716569, step = 3900 (17.891 sec)
INFO:tensorflow:Saving checkpoints for 4000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:02:16.470241 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 4000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47141
I0411 21:02:17.051955 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.47141
INFO:tensorflow:loss = 8.562471, step = 4000 (18.278 sec)
I0411 21:02:17.053016 140495910045504 basic_session_run_hooks.py:260] loss = 8.562471, step = 4000 (18.278 sec)
INFO:tensorflow:global_step/sec: 5.59709
I0411 21:02:34.918080 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59709
INFO:tensorflow:loss = 8.704312, step = 4100 (17.866 sec)
I0411 21:02:34.918889 140495910045504 basic_session_run_hooks.py:260] loss = 8.704312, step = 4100 (17.866 sec)
INFO:tensorflow:global_step/sec: 5.5916
I0411 21:02:52.802247 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5916
INFO:tensorflow:loss = 8.682805, step = 4200 (17.885 sec)
I0411 21:02:52.803577 140495910045504 basic_session_run_hooks.py:260] loss = 8.682805, step = 4200 (17.885 sec)
INFO:tensorflow:global_step/sec: 5.5938
I0411 21:03:10.678987 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5938
INFO:tensorflow:loss = 8.627771, step = 4300 (17.876 sec)
I0411 21:03:10.679844 140495910045504 basic_session_run_hooks.py:260] loss = 8.627771, step = 4300 (17.876 sec)
INFO:tensorflow:global_step/sec: 5.59668
I0411 21:03:28.546837 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59668
INFO:tensorflow:loss = 8.496793, step = 4400 (17.868 sec)
I0411 21:03:28.547907 140495910045504 basic_session_run_hooks.py:260] loss = 8.496793, step = 4400 (17.868 sec)
INFO:tensorflow:global_step/sec: 5.59157
I0411 21:03:46.431043 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59157
INFO:tensorflow:loss = 8.633585, step = 4500 (17.885 sec)
I0411 21:03:46.432453 140495910045504 basic_session_run_hooks.py:260] loss = 8.633585, step = 4500 (17.885 sec)
INFO:tensorflow:global_step/sec: 5.58912
I0411 21:04:04.322749 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58912
INFO:tensorflow:loss = 8.428849, step = 4600 (17.891 sec)
I0411 21:04:04.323530 140495910045504 basic_session_run_hooks.py:260] loss = 8.428849, step = 4600 (17.891 sec)
INFO:tensorflow:global_step/sec: 5.5869
I0411 21:04:22.221947 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5869
INFO:tensorflow:loss = 8.443708, step = 4700 (17.900 sec)
I0411 21:04:22.223278 140495910045504 basic_session_run_hooks.py:260] loss = 8.443708, step = 4700 (17.900 sec)
INFO:tensorflow:global_step/sec: 5.58793
I0411 21:04:40.117452 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58793
INFO:tensorflow:loss = 8.544346, step = 4800 (17.895 sec)
I0411 21:04:40.118231 140495910045504 basic_session_run_hooks.py:260] loss = 8.544346, step = 4800 (17.895 sec)
INFO:tensorflow:global_step/sec: 5.58461
I0411 21:04:58.024151 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58461
INFO:tensorflow:loss = 8.543187, step = 4900 (17.907 sec)
I0411 21:04:58.025569 140495910045504 basic_session_run_hooks.py:260] loss = 8.543187, step = 4900 (17.907 sec)
INFO:tensorflow:Saving checkpoints for 5000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:05:15.744840 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 5000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:960: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
W0411 21:05:15.805741 140495910045504 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:960: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
INFO:tensorflow:global_step/sec: 5.46391
I0411 21:05:16.325660 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.46391
INFO:tensorflow:loss = 8.477056, step = 5000 (18.301 sec)
I0411 21:05:16.326427 140495910045504 basic_session_run_hooks.py:260] loss = 8.477056, step = 5000 (18.301 sec)
INFO:tensorflow:global_step/sec: 5.58951
I0411 21:05:34.216510 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58951
INFO:tensorflow:loss = 8.4195175, step = 5100 (17.891 sec)
I0411 21:05:34.217813 140495910045504 basic_session_run_hooks.py:260] loss = 8.4195175, step = 5100 (17.891 sec)
INFO:tensorflow:global_step/sec: 5.58798
I0411 21:05:52.111889 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58798
INFO:tensorflow:loss = 8.44407, step = 5200 (17.895 sec)
I0411 21:05:52.112691 140495910045504 basic_session_run_hooks.py:260] loss = 8.44407, step = 5200 (17.895 sec)
INFO:tensorflow:global_step/sec: 5.59108
I0411 21:06:09.997853 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59108
INFO:tensorflow:loss = 8.409157, step = 5300 (17.887 sec)
I0411 21:06:09.999334 140495910045504 basic_session_run_hooks.py:260] loss = 8.409157, step = 5300 (17.887 sec)
INFO:tensorflow:global_step/sec: 5.5855
I0411 21:06:27.901460 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5855
INFO:tensorflow:loss = 8.451701, step = 5400 (17.904 sec)
I0411 21:06:27.903011 140495910045504 basic_session_run_hooks.py:260] loss = 8.451701, step = 5400 (17.904 sec)
INFO:tensorflow:global_step/sec: 5.58539
I0411 21:06:45.805210 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58539
INFO:tensorflow:loss = 8.453432, step = 5500 (17.904 sec)
I0411 21:06:45.806610 140495910045504 basic_session_run_hooks.py:260] loss = 8.453432, step = 5500 (17.904 sec)
INFO:tensorflow:global_step/sec: 5.58512
I0411 21:07:03.709743 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58512
INFO:tensorflow:loss = 8.402158, step = 5600 (17.904 sec)
I0411 21:07:03.710489 140495910045504 basic_session_run_hooks.py:260] loss = 8.402158, step = 5600 (17.904 sec)
INFO:tensorflow:global_step/sec: 5.58348
I0411 21:07:21.619611 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58348
INFO:tensorflow:loss = 8.321221, step = 5700 (17.910 sec)
I0411 21:07:21.620344 140495910045504 basic_session_run_hooks.py:260] loss = 8.321221, step = 5700 (17.910 sec)
INFO:tensorflow:global_step/sec: 5.58743
I0411 21:07:39.516869 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58743
INFO:tensorflow:loss = 8.429732, step = 5800 (17.897 sec)
I0411 21:07:39.517544 140495910045504 basic_session_run_hooks.py:260] loss = 8.429732, step = 5800 (17.897 sec)
INFO:tensorflow:global_step/sec: 5.58787
I0411 21:07:57.412732 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58787
INFO:tensorflow:loss = 8.32268, step = 5900 (17.896 sec)
I0411 21:07:57.413529 140495910045504 basic_session_run_hooks.py:260] loss = 8.32268, step = 5900 (17.896 sec)
INFO:tensorflow:Saving checkpoints for 6000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:08:15.122824 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 6000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.46429
I0411 21:08:15.713382 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.46429
INFO:tensorflow:loss = 8.439063, step = 6000 (18.300 sec)
I0411 21:08:15.713941 140495910045504 basic_session_run_hooks.py:260] loss = 8.439063, step = 6000 (18.300 sec)
INFO:tensorflow:global_step/sec: 5.5905
I0411 21:08:33.600953 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.5905
INFO:tensorflow:loss = 8.414362, step = 6100 (17.888 sec)
I0411 21:08:33.601732 140495910045504 basic_session_run_hooks.py:260] loss = 8.414362, step = 6100 (17.888 sec)
INFO:tensorflow:global_step/sec: 5.59273
I0411 21:08:51.481687 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59273
INFO:tensorflow:loss = 8.271111, step = 6200 (17.881 sec)
I0411 21:08:51.483088 140495910045504 basic_session_run_hooks.py:260] loss = 8.271111, step = 6200 (17.881 sec)
INFO:tensorflow:global_step/sec: 5.58242
I0411 21:09:09.394771 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58242
INFO:tensorflow:loss = 8.298481, step = 6300 (17.912 sec)
I0411 21:09:09.395528 140495910045504 basic_session_run_hooks.py:260] loss = 8.298481, step = 6300 (17.912 sec)
INFO:tensorflow:global_step/sec: 5.58794
I0411 21:09:27.290453 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58794
INFO:tensorflow:loss = 8.280493, step = 6400 (17.896 sec)
I0411 21:09:27.291308 140495910045504 basic_session_run_hooks.py:260] loss = 8.280493, step = 6400 (17.896 sec)
INFO:tensorflow:global_step/sec: 5.59015
I0411 21:09:45.179171 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59015
INFO:tensorflow:loss = 8.255913, step = 6500 (17.889 sec)
I0411 21:09:45.180416 140495910045504 basic_session_run_hooks.py:260] loss = 8.255913, step = 6500 (17.889 sec)
INFO:tensorflow:global_step/sec: 5.58693
I0411 21:10:03.077949 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58693
INFO:tensorflow:loss = 8.253923, step = 6600 (17.898 sec)
I0411 21:10:03.078792 140495910045504 basic_session_run_hooks.py:260] loss = 8.253923, step = 6600 (17.898 sec)
INFO:tensorflow:global_step/sec: 5.58617
I0411 21:10:20.979759 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58617
INFO:tensorflow:loss = 8.197716, step = 6700 (17.903 sec)
I0411 21:10:20.981418 140495910045504 basic_session_run_hooks.py:260] loss = 8.197716, step = 6700 (17.903 sec)
INFO:tensorflow:global_step/sec: 5.59129
I0411 21:10:38.864177 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59129
INFO:tensorflow:loss = 8.304108, step = 6800 (17.883 sec)
I0411 21:10:38.864845 140495910045504 basic_session_run_hooks.py:260] loss = 8.304108, step = 6800 (17.883 sec)
INFO:tensorflow:global_step/sec: 5.58953
I0411 21:10:56.755072 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58953
INFO:tensorflow:loss = 8.260163, step = 6900 (17.891 sec)
I0411 21:10:56.756361 140495910045504 basic_session_run_hooks.py:260] loss = 8.260163, step = 6900 (17.891 sec)
INFO:tensorflow:Saving checkpoints for 7000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:11:14.454374 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 7000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47112
I0411 21:11:15.032570 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.47112
INFO:tensorflow:loss = 8.305423, step = 7000 (18.277 sec)
I0411 21:11:15.033285 140495910045504 basic_session_run_hooks.py:260] loss = 8.305423, step = 7000 (18.277 sec)
INFO:tensorflow:global_step/sec: 5.60411
I0411 21:11:32.876924 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.60411
INFO:tensorflow:loss = 8.216425, step = 7100 (17.845 sec)
I0411 21:11:32.878015 140495910045504 basic_session_run_hooks.py:260] loss = 8.216425, step = 7100 (17.845 sec)
INFO:tensorflow:global_step/sec: 5.59428
I0411 21:11:50.752187 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59428
INFO:tensorflow:loss = 8.201561, step = 7200 (17.875 sec)
I0411 21:11:50.753163 140495910045504 basic_session_run_hooks.py:260] loss = 8.201561, step = 7200 (17.875 sec)
INFO:tensorflow:global_step/sec: 5.59019
I0411 21:12:08.640682 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59019
INFO:tensorflow:loss = 8.23715, step = 7300 (17.888 sec)
I0411 21:12:08.641602 140495910045504 basic_session_run_hooks.py:260] loss = 8.23715, step = 7300 (17.888 sec)
INFO:tensorflow:global_step/sec: 5.59107
I0411 21:12:26.526307 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59107
INFO:tensorflow:loss = 8.226116, step = 7400 (17.886 sec)
I0411 21:12:26.527210 140495910045504 basic_session_run_hooks.py:260] loss = 8.226116, step = 7400 (17.886 sec)
INFO:tensorflow:global_step/sec: 5.59847
I0411 21:12:44.388381 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59847
INFO:tensorflow:loss = 8.235629, step = 7500 (17.862 sec)
I0411 21:12:44.389520 140495910045504 basic_session_run_hooks.py:260] loss = 8.235629, step = 7500 (17.862 sec)
INFO:tensorflow:global_step/sec: 5.58906
I0411 21:13:02.280329 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58906
INFO:tensorflow:loss = 8.210181, step = 7600 (17.892 sec)
I0411 21:13:02.281281 140495910045504 basic_session_run_hooks.py:260] loss = 8.210181, step = 7600 (17.892 sec)
INFO:tensorflow:global_step/sec: 5.59135
I0411 21:13:20.165102 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59135
INFO:tensorflow:loss = 8.150083, step = 7700 (17.885 sec)
I0411 21:13:20.165903 140495910045504 basic_session_run_hooks.py:260] loss = 8.150083, step = 7700 (17.885 sec)
INFO:tensorflow:global_step/sec: 5.58608
I0411 21:13:38.067097 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58608
INFO:tensorflow:loss = 8.202637, step = 7800 (17.902 sec)
I0411 21:13:38.068404 140495910045504 basic_session_run_hooks.py:260] loss = 8.202637, step = 7800 (17.902 sec)
INFO:tensorflow:global_step/sec: 5.59138
I0411 21:13:55.951359 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59138
INFO:tensorflow:loss = 8.113524, step = 7900 (17.884 sec)
I0411 21:13:55.952132 140495910045504 basic_session_run_hooks.py:260] loss = 8.113524, step = 7900 (17.884 sec)
INFO:tensorflow:Saving checkpoints for 8000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:14:13.666215 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 8000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.4525
I0411 21:14:14.291913 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.4525
INFO:tensorflow:loss = 8.135977, step = 8000 (18.341 sec)
I0411 21:14:14.292895 140495910045504 basic_session_run_hooks.py:260] loss = 8.135977, step = 8000 (18.341 sec)
INFO:tensorflow:global_step/sec: 5.59261
I0411 21:14:32.172502 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59261
INFO:tensorflow:loss = 8.154927, step = 8100 (17.880 sec)
I0411 21:14:32.173189 140495910045504 basic_session_run_hooks.py:260] loss = 8.154927, step = 8100 (17.880 sec)
INFO:tensorflow:global_step/sec: 5.59267
I0411 21:14:50.052902 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59267
INFO:tensorflow:loss = 8.218509, step = 8200 (17.881 sec)
I0411 21:14:50.053704 140495910045504 basic_session_run_hooks.py:260] loss = 8.218509, step = 8200 (17.881 sec)
INFO:tensorflow:global_step/sec: 5.58915
I0411 21:15:07.945001 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58915
INFO:tensorflow:loss = 8.148724, step = 8300 (17.892 sec)
I0411 21:15:07.946050 140495910045504 basic_session_run_hooks.py:260] loss = 8.148724, step = 8300 (17.892 sec)
INFO:tensorflow:global_step/sec: 5.59114
I0411 21:15:25.830645 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59114
INFO:tensorflow:loss = 8.15624, step = 8400 (17.886 sec)
I0411 21:15:25.832334 140495910045504 basic_session_run_hooks.py:260] loss = 8.15624, step = 8400 (17.886 sec)
INFO:tensorflow:global_step/sec: 5.59363
I0411 21:15:43.707608 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59363
INFO:tensorflow:loss = 8.149684, step = 8500 (17.876 sec)
I0411 21:15:43.708176 140495910045504 basic_session_run_hooks.py:260] loss = 8.149684, step = 8500 (17.876 sec)
INFO:tensorflow:global_step/sec: 5.58537
I0411 21:16:01.611944 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58537
INFO:tensorflow:loss = 8.189445, step = 8600 (17.905 sec)
I0411 21:16:01.613141 140495910045504 basic_session_run_hooks.py:260] loss = 8.189445, step = 8600 (17.905 sec)
INFO:tensorflow:global_step/sec: 5.58428
I0411 21:16:19.518961 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58428
INFO:tensorflow:loss = 8.151112, step = 8700 (17.907 sec)
I0411 21:16:19.519686 140495910045504 basic_session_run_hooks.py:260] loss = 8.151112, step = 8700 (17.907 sec)
INFO:tensorflow:global_step/sec: 5.58764
I0411 21:16:37.415646 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58764
INFO:tensorflow:loss = 8.172057, step = 8800 (17.897 sec)
I0411 21:16:37.416265 140495910045504 basic_session_run_hooks.py:260] loss = 8.172057, step = 8800 (17.897 sec)
INFO:tensorflow:global_step/sec: 5.59129
I0411 21:16:55.300795 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59129
INFO:tensorflow:loss = 8.157258, step = 8900 (17.886 sec)
I0411 21:16:55.302091 140495910045504 basic_session_run_hooks.py:260] loss = 8.157258, step = 8900 (17.886 sec)
INFO:tensorflow:Saving checkpoints for 9000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:17:12.997093 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 9000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:global_step/sec: 5.47107
I0411 21:17:13.578458 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.47107
INFO:tensorflow:loss = 8.183971, step = 9000 (18.277 sec)
I0411 21:17:13.579084 140495910045504 basic_session_run_hooks.py:260] loss = 8.183971, step = 9000 (18.277 sec)
INFO:tensorflow:global_step/sec: 5.59896
I0411 21:17:31.439281 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59896
INFO:tensorflow:loss = 8.206263, step = 9100 (17.861 sec)
I0411 21:17:31.440582 140495910045504 basic_session_run_hooks.py:260] loss = 8.206263, step = 9100 (17.861 sec)
INFO:tensorflow:global_step/sec: 5.59328
I0411 21:17:49.317589 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59328
INFO:tensorflow:loss = 8.086711, step = 9200 (17.878 sec)
I0411 21:17:49.318470 140495910045504 basic_session_run_hooks.py:260] loss = 8.086711, step = 9200 (17.878 sec)
INFO:tensorflow:global_step/sec: 5.58939
I0411 21:18:07.208989 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58939
INFO:tensorflow:loss = 8.071563, step = 9300 (17.892 sec)
I0411 21:18:07.210236 140495910045504 basic_session_run_hooks.py:260] loss = 8.071563, step = 9300 (17.892 sec)
INFO:tensorflow:global_step/sec: 5.58881
I0411 21:18:25.101946 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58881
INFO:tensorflow:loss = 8.114385, step = 9400 (17.893 sec)
I0411 21:18:25.103636 140495910045504 basic_session_run_hooks.py:260] loss = 8.114385, step = 9400 (17.893 sec)
INFO:tensorflow:global_step/sec: 5.58557
I0411 21:18:43.004797 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.58557
INFO:tensorflow:loss = 8.163616, step = 9500 (17.902 sec)
I0411 21:18:43.005268 140495910045504 basic_session_run_hooks.py:260] loss = 8.163616, step = 9500 (17.902 sec)
INFO:tensorflow:global_step/sec: 5.59782
I0411 21:19:00.868940 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59782
INFO:tensorflow:loss = 8.200719, step = 9600 (17.865 sec)
I0411 21:19:00.869911 140495910045504 basic_session_run_hooks.py:260] loss = 8.200719, step = 9600 (17.865 sec)
INFO:tensorflow:global_step/sec: 5.59394
I0411 21:19:18.745871 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59394
INFO:tensorflow:loss = 8.122188, step = 9700 (17.878 sec)
I0411 21:19:18.747552 140495910045504 basic_session_run_hooks.py:260] loss = 8.122188, step = 9700 (17.878 sec)
INFO:tensorflow:global_step/sec: 5.59542
I0411 21:19:36.617171 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59542
INFO:tensorflow:loss = 8.085372, step = 9800 (17.870 sec)
I0411 21:19:36.617813 140495910045504 basic_session_run_hooks.py:260] loss = 8.085372, step = 9800 (17.870 sec)
INFO:tensorflow:global_step/sec: 5.59294
I0411 21:19:54.497104 140495910045504 basic_session_run_hooks.py:692] global_step/sec: 5.59294
INFO:tensorflow:loss = 8.144992, step = 9900 (17.881 sec)
I0411 21:19:54.499025 140495910045504 basic_session_run_hooks.py:260] loss = 8.144992, step = 9900 (17.881 sec)
INFO:tensorflow:Saving checkpoints for 10000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
I0411 21:20:12.184303 140495910045504 basic_session_run_hooks.py:606] Saving checkpoints for 10000 into ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt.
INFO:tensorflow:Loss for final step: 8.138358.
I0411 21:20:12.652270 140495910045504 estimator.py:368] Loss for final step: 8.138358.
INFO:tensorflow:***** Running evaluation *****
I0411 21:20:12.653042 140495910045504 run.py:582] ***** Running evaluation *****
INFO:tensorflow:  Batch size = 256
I0411 21:20:12.653145 140495910045504 run.py:583]   Batch size = 256
INFO:tensorflow:run init
I0411 21:20:12.653289 140495910045504 run.py:125] run init
INFO:tensorflow:Calling model_fn.
I0411 21:20:12.706952 140495910045504 estimator.py:1145] Calling model_fn.
INFO:tensorflow:*** Features ***
I0411 21:20:12.707201 140495910045504 run.py:250] *** Features ***
INFO:tensorflow:  name = info, shape = (?, 1)
I0411 21:20:12.707356 140495910045504 run.py:253]   name = info, shape = (?, 1)
INFO:tensorflow:  name = input_ids, shape = (?, 50)
I0411 21:20:12.707531 140495910045504 run.py:253]   name = input_ids, shape = (?, 50)
INFO:tensorflow:  name = input_mask, shape = (?, 50)
I0411 21:20:12.707662 140495910045504 run.py:253]   name = input_mask, shape = (?, 50)
INFO:tensorflow:  name = masked_lm_ids, shape = (?, 30)
I0411 21:20:12.707828 140495910045504 run.py:253]   name = masked_lm_ids, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_positions, shape = (?, 30)
I0411 21:20:12.707944 140495910045504 run.py:253]   name = masked_lm_positions, shape = (?, 30)
INFO:tensorflow:  name = masked_lm_weights, shape = (?, 30)
I0411 21:20:12.708055 140495910045504 run.py:253]   name = masked_lm_weights, shape = (?, 30)
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:12.863772 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:12.904987 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a450>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a350>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a350>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:12.939008 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a350>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a350>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a290>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a290>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.004066 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a290>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71007a290>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006ac50>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006ac50>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.064807 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006ac50>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006ac50>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006af10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006af10>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.115437 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006af10>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006af10>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.195079 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.236088 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.275816 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc710086990>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc70869a910>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc70869a910>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.352053 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc70869a910>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc70869a910>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006aed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006aed0>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.416001 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006aed0>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006aed0>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006a990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006a990>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.463974 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006a990>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc71006a990>>: AttributeError: module 'gast' has no attribute 'Index'
WARNING:tensorflow:Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7085c8950>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7085c8950>>: AttributeError: module 'gast' has no attribute 'Index'
W0411 21:20:13.550701 140495910045504 ag_logging.py:145] Entity <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7085c8950>> could not be transformed and will be executed as-is. Please report this to the AutgoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: converting <bound method Dense.call of <tensorflow.python.layers.core.Dense object at 0x7fc7085c8950>>: AttributeError: module 'gast' has no attribute 'Index'
INFO:tensorflow:**** Trainable Variables ****
I0411 21:20:13.598741 140495910045504 run.py:304] **** Trainable Variables ****
INFO:tensorflow:  name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
I0411 21:20:13.598906 140495910045504 run.py:310]   name = bert/embeddings/word_embeddings:0, shape = (54546, 64)
INFO:tensorflow:  name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
I0411 21:20:13.599059 140495910045504 run.py:310]   name = bert/embeddings/token_type_embeddings:0, shape = (2, 64)
INFO:tensorflow:  name = bert/embeddings/position_embeddings:0, shape = (50, 64)
I0411 21:20:13.599230 140495910045504 run.py:310]   name = bert/embeddings/position_embeddings:0, shape = (50, 64)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.599383 140495910045504 run.py:310]   name = bert/embeddings/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.599530 140495910045504 run.py:310]   name = bert/embeddings/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
I0411 21:20:13.599681 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
I0411 21:20:13.599817 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
I0411 21:20:13.599963 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
I0411 21:20:13.600093 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
I0411 21:20:13.600218 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
I0411 21:20:13.600348 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
I0411 21:20:13.600474 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
I0411 21:20:13.600644 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.600777 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.600908 140495910045504 run.py:310]   name = bert/encoder/layer_0/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
I0411 21:20:13.601080 140495910045504 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
I0411 21:20:13.601211 140495910045504 run.py:310]   name = bert/encoder/layer_0/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
I0411 21:20:13.601338 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
I0411 21:20:13.601472 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.601596 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.601719 140495910045504 run.py:310]   name = bert/encoder/layer_0/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
I0411 21:20:13.601844 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/query/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
I0411 21:20:13.601978 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/query/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
I0411 21:20:13.602105 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/key/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
I0411 21:20:13.602294 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/key/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
I0411 21:20:13.602440 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/value/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
I0411 21:20:13.602573 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/self/value/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
I0411 21:20:13.602716 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
I0411 21:20:13.602845 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.602968 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.603108 140495910045504 run.py:310]   name = bert/encoder/layer_1/attention/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
I0411 21:20:13.603236 140495910045504 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/kernel:0, shape = (64, 256)
INFO:tensorflow:  name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
I0411 21:20:13.603368 140495910045504 run.py:310]   name = bert/encoder/layer_1/intermediate/dense/bias:0, shape = (256,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
I0411 21:20:13.603518 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/dense/kernel:0, shape = (256, 64)
INFO:tensorflow:  name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
I0411 21:20:13.603650 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.603791 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.603938 140495910045504 run.py:310]   name = bert/encoder/layer_1/output/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
I0411 21:20:13.604116 140495910045504 run.py:310]   name = cls/predictions/transform/dense/kernel:0, shape = (64, 64)
INFO:tensorflow:  name = cls/predictions/transform/dense/bias:0, shape = (64,)
I0411 21:20:13.604315 140495910045504 run.py:310]   name = cls/predictions/transform/dense/bias:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
I0411 21:20:13.604459 140495910045504 run.py:310]   name = cls/predictions/transform/LayerNorm/beta:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
I0411 21:20:13.604608 140495910045504 run.py:310]   name = cls/predictions/transform/LayerNorm/gamma:0, shape = (64,)
INFO:tensorflow:  name = cls/predictions/output_bias:0, shape = (54546,)
I0411 21:20:13.604764 140495910045504 run.py:310]   name = cls/predictions/output_bias:0, shape = (54546,)
WARNING:tensorflow:From run.py:336: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy instead.

W0411 21:20:13.611935 140495910045504 deprecation_wrapper.py:119] From run.py:336: The name tf.metrics.accuracy is deprecated. Please use tf.compat.v1.metrics.accuracy instead.

WARNING:tensorflow:From run.py:340: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

W0411 21:20:13.679057 140495910045504 deprecation_wrapper.py:119] From run.py:340: The name tf.metrics.mean is deprecated. Please use tf.compat.v1.metrics.mean instead.

INFO:tensorflow:Done calling model_fn.
I0411 21:20:13.908270 140495910045504 estimator.py:1147] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-04-11T21:20:13Z
I0411 21:20:13.930145 140495910045504 evaluation.py:255] Starting evaluation at 2022-04-11T21:20:13Z
load user history from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.his
load vocab from :./data/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50.vocab
INFO:tensorflow:Graph was finalized.
I0411 21:20:14.313312 140495910045504 monitored_session.py:240] Graph was finalized.
2022-04-11 21:20:14.315182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: NVIDIA TITAN X (Pascal) major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:82:00.0
2022-04-11 21:20:14.315312: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2022-04-11 21:20:14.315351: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2022-04-11 21:20:14.315370: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2022-04-11 21:20:14.315393: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2022-04-11 21:20:14.315460: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2022-04-11 21:20:14.315493: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2022-04-11 21:20:14.315517: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2022-04-11 21:20:14.316362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-04-11 21:20:14.316427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-11 21:20:14.316454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-04-11 21:20:14.316462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-04-11 21:20:14.317270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11445 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:82:00.0, compute capability: 6.1)
WARNING:tensorflow:From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0411 21:20:14.317491 140495910045504 deprecation.py:323] From /root/miniconda3/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-10000
I0411 21:20:14.318992 140495910045504 saver.py:1280] Restoring parameters from ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-10000
INFO:tensorflow:Running local_init_op.
I0411 21:20:14.489583 140495910045504 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0411 21:20:14.509224 140495910045504 session_manager.py:502] Done running local_init_op.
WARNING:tensorflow:From run.py:178: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs instead.

W0411 21:20:14.616687 140495910045504 deprecation_wrapper.py:119] From run.py:178: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs instead.

.......................................................................................................................................................................................................................................................................................................................................................ndcg@1:0.029586661225441614, hit@1:0.029586661225441614， ndcg@5:0.11028038400681929, hit@5:0.1961755961056375, ndcg@10:0.14983419088103705, hit@10:0.31936104471521015,  ndcg@20:0.2149345106644776, hit@20:0.5750306068909229,ap:0.1298842686559804, valid_user:34306.0
INFO:tensorflow:Finished evaluation at 2022-04-11-21:20:56
I0411 21:20:56.342285 140495910045504 evaluation.py:275] Finished evaluation at 2022-04-11-21:20:56
INFO:tensorflow:Saving dict for global step 10000: global_step = 10000, loss = 9.095084, masked_lm_accuracy = 0.003410482, masked_lm_loss = 9.093663
I0411 21:20:56.342880 140495910045504 estimator.py:2039] Saving dict for global step 10000: global_step = 10000, loss = 9.095084, masked_lm_accuracy = 0.003410482, masked_lm_loss = 9.093663
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 10000: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-10000
I0411 21:20:56.542904 140495910045504 estimator.py:2099] Saving 'checkpoint_path' summary for global step 10000: ~/BERT4Rec/yelp_bert-mp1.0-sw0.1-mlp0.6-df10-mpps30-msl50-64/model.ckpt-10000
INFO:tensorflow:***** Eval results *****
I0411 21:20:56.588337 140495910045504 run.py:600] ***** Eval results *****
INFO:tensorflow:{
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

I0411 21:20:56.588872 140495910045504 run.py:601] {
  "attention_probs_dropout_prob": 0.2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.5,
  "hidden_size": 64,
  "initializer_range": 0.02,
  "intermediate_size": 256,
  "max_position_embeddings": 50,
  "num_attention_heads": 2,
  "num_hidden_layers": 2,
  "type_vocab_size": 2,
  "vocab_size": 54546
}

INFO:tensorflow:  global_step = 10000
I0411 21:20:56.589564 140495910045504 run.py:604]   global_step = 10000
INFO:tensorflow:  loss = 9.095084
I0411 21:20:56.589718 140495910045504 run.py:604]   loss = 9.095084
INFO:tensorflow:  masked_lm_accuracy = 0.003410482
I0411 21:20:56.589841 140495910045504 run.py:604]   masked_lm_accuracy = 0.003410482
INFO:tensorflow:  masked_lm_loss = 9.093663
I0411 21:20:56.589960 140495910045504 run.py:604]   masked_lm_loss = 9.093663
(base) root@container-855111b90c-e179f175:~/BERT4Rec#
